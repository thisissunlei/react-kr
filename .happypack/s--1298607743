'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _Redux = require('kr/Redux');

var _reactBinding = require('react-binding');

var _dateformat = require('dateformat');

var _dateformat2 = _interopRequireDefault(_dateformat);

var _reduxForm = require('redux-form');

var _krUi = require('kr-ui');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var SelectStationForm = function (_Component) {
	_inherits(SelectStationForm, _Component);

	function SelectStationForm(props, context) {
		_classCallCheck(this, SelectStationForm);

		var _this2 = _possibleConstructorReturn(this, (SelectStationForm.__proto__ || Object.getPrototypeOf(SelectStationForm)).call(this, props, context));

		_this2.onSubmit = _this2.onSubmit.bind(_this2);
		_this2.onCancel = _this2.onCancel.bind(_this2);
		_this2.onSelect = _this2.onSelect.bind(_this2);
		_this2.getLoadData = _this2.getLoadData.bind(_this2);
		_this2.onChangeRentBeginDate = _this2.onChangeRentBeginDate.bind(_this2);

		_this2.state = {
			stationVos: [],
			selected: []
		};

		return _this2;
	}

	_createClass(SelectStationForm, [{
		key: 'componentDidMount',
		value: function componentDidMount() {
			this.getLoadData();
		}
	}, {
		key: 'onChangeRentBeginDate',
		value: function onChangeRentBeginDate(value) {
			var _state = this.state,
			    stationVos = _state.stationVos,
			    selected = _state.selected;


			if (!selected.length) {
				_krUi.Notify.show([{
					message: '请先选择工位!',
					type: 'danger'
				}]);
				return;
			}

			value = (0, _dateformat2.default)(value, 'yyyy-mm-dd');

			if (!selected.length) {
				_krUi.Notify.show([{
					message: '未选择减租工位',
					type: 'danger'
				}]);
				return;
			}
			stationVos = [].concat(stationVos);
			stationVos.map(function (item, index) {
				if (selected.indexOf(index) !== -1) {
					item.rentBeginDate = value;
				} else {
					item.rentBeginDate = '';
				}
				return item;
			});

			this.setState({
				stationVos: stationVos
			});
		}
	}, {
		key: 'getLoadData',
		value: function getLoadData() {
			var _this = this;
			var params = this.context.params;

			_Redux.Store.dispatch(_Redux.Actions.callAPI('getStationOrSettingList', {
				mainBillid: params.orderId,
				page: 1,
				pagesize: 100
			})).then(function (response) {
				console.log('response', response);

				_this.setState({
					stationVos: response.items
				});
			}).catch(function (err) {
				_krUi.Notify.show([{
					message: '后台出错请联系管理员',
					type: 'danger'
				}]);
			});
		}
	}, {
		key: 'onSelect',
		value: function onSelect(selected) {
			this.setState({
				selected: selected
			}, function () {});
		}
	}, {
		key: 'onSubmit',
		value: function onSubmit() {
			console.log('1223');
			var _state2 = this.state,
			    stationVos = _state2.stationVos,
			    selected = _state2.selected;

			var selectedStationVos = [];

			selectedStationVos = stationVos.filter(function (item, index) {
				if (selected.indexOf(index) !== -1) {
					return true;
				}
				return false;
			});

			if (!selectedStationVos.length) {
				_krUi.Notify.show([{
					message: '请选择工位',
					type: 'danger'
				}]);

				return;
			}

			//选中的必须要有租赁结束日期
			var someStartDate = true;

			selectedStationVos.forEach(function (item, index) {
				if (!item.rentBeginDate) {
					someStartDate = false;
				}
			});

			if (!someStartDate) {
				_krUi.Notify.show([{
					message: '选择的工位必须要有减租开始时间',
					type: 'danger'
				}]);
				return;
			}

			//工位结束时间相同
			var some = true;
			selectedStationVos.sort(function (pre, next) {
				var preDate = (0, _dateformat2.default)(pre.leaseEndDate, 'yyyy-mm-dd');
				var nextDate = (0, _dateformat2.default)(next.leaseEndDate, 'yyyy-mm-dd');
				if (preDate != nextDate) {
					some = false;
				}
				return -1;
			});

			if (!some) {
				_krUi.Notify.show([{
					message: '请选择相同日期',
					type: 'danger'
				}]);
				return false;
			}

			//修改日期
			var resultStationVos = [];
			selectedStationVos.forEach(function (item, index) {
				var obj = {};
				obj.id = item.id;
				obj.stationId = item.stationId;
				obj.stationName = item.stationName;
				obj.unitprice = item.unitprice;
				obj.whereFloor = item.whereFloor;
				obj.stationType = item.stationType;

				obj.stationBeginDate = (0, _dateformat2.default)(item.leaseBeginDate, 'yyyy-mm-dd');
				obj.stationEndDate = (0, _dateformat2.default)(item.leaseEndDate, 'yyyy-mm-dd');

				obj.leaseBeginDate = (0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd');
				obj.leaseEndDate = (0, _dateformat2.default)(item.leaseEndDate, 'yyyy-mm-dd');
				obj.rentBeginDate = (0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd');

				resultStationVos.push(obj);
			});

			selectedStationVos = resultStationVos;

			//选择的减租开始日期必须要在工位的起始日期和结束日期范围内
			var isOK = 1;
			selectedStationVos.map(function (item, index) {
				var stationBeginDate = Date.parse((0, _dateformat2.default)(item.stationBeginDate, 'yyyy-mm-dd') + ' 00:00:00');
				var stationEndDate = Date.parse((0, _dateformat2.default)(item.stationEndDate, 'yyyy-mm-dd') + ' 00:00:00');
				var rentBeginDate = Date.parse((0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd') + ' 00:00:00');

				if (stationBeginDate >= rentBeginDate || rentBeginDate >= stationEndDate) {
					isOK = 0;
				}
			});

			if (!isOK) {
				_krUi.Notify.show([{
					message: '减租开始时间必须要在选择工位的租赁开始日期和结束日期之内',
					type: 'danger'
				}]);
				return false;
			}
			console.log('---->>>>', selectedStationVos);

			_Redux.Store.dispatch((0, _reduxForm.change)('reduceCreateForm', 'leaseBegindate', selectedStationVos[0].leaseEndDate));

			var onSubmit = this.props.onSubmit;

			onSubmit && onSubmit(selectedStationVos);
		}
	}, {
		key: 'onCancel',
		value: function onCancel() {
			var onCancel = this.props.onCancel;

			onCancel && onCancel();
		}
	}, {
		key: 'render',
		value: function render() {
			var _props = this.props,
			    error = _props.error,
			    handleSubmit = _props.handleSubmit,
			    pristine = _props.pristine,
			    reset = _props.reset,
			    submitting = _props.submitting;
			var stationVos = this.state.stationVos;

			var overfolw = {
				'overflow': 'hidden',
				maxHeight: 510
			};
			var height = {
				height: stationVos.length * 45,
				maxHeight: 667
			};
			return _react2.default.createElement(
				'div',
				{ style: { height: 667, marginTop: 20 } },
				_react2.default.createElement(
					'form',
					{ onSubmit: handleSubmit(this.onSubmit) },
					_react2.default.createElement(_krUi.KrField, { grid: 1 / 1, name: 'rentBeginDate', component: 'date', label: '\u51CF\u79DF\u5F00\u59CB\u65F6\u95F4\uFF1A', onChange: this.onChangeRentBeginDate, inline: true }),
					_react2.default.createElement(
						_krUi.Table,
						{ onSelect: this.onSelect, style: overfolw },
						_react2.default.createElement(
							_krUi.TableHeader,
							null,
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7C7B\u522B'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7F16\u53F7\uFF0F\u540D\u79F0'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u5355\u4EF7\uFF08\u5143\uFF0F\u6708\uFF09'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u8D77\u59CB\u65E5\u671F'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7ED3\u675F\u65E5\u671F'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u51CF\u79DF\u5F00\u59CB\u65E5\u671F'
							)
						),
						_react2.default.createElement(
							_krUi.TableBody,
							null,
							stationVos && stationVos.map(function (item, index) {
								return _react2.default.createElement(
									_krUi.TableRow,
									{ key: index },
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.stationType == 1 ? '工位' : '会议室'
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.stationName
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.unitprice
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										_react2.default.createElement(_krUi.KrDate, { value: item.leaseBeginDate })
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										_react2.default.createElement(_krUi.KrDate, { value: item.leaseEndDate })
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.rentBeginDate && (0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd')
									)
								);
							})
						)
					),
					_react2.default.createElement(
						_krUi.Grid,
						null,
						_react2.default.createElement(
							_krUi.Row,
							{ style: { marginTop: 30, paddingBottom: 24 } },
							_react2.default.createElement(_krUi.Col, { md: 4 }),
							_react2.default.createElement(
								_krUi.Col,
								{ md: 2, align: 'center' },
								' ',
								_react2.default.createElement(_krUi.Button, { label: '\u786E\u5B9A', type: 'button', onClick: this.onSubmit }),
								' '
							),
							_react2.default.createElement(
								_krUi.Col,
								{ md: 2, align: 'center' },
								' ',
								_react2.default.createElement(_krUi.Button, { label: '\u53D6\u6D88', type: 'button', cancle: true, onClick: this.onCancel }),
								' '
							),
							_react2.default.createElement(_krUi.Col, { md: 4 })
						)
					)
				)
			);
		}
	}]);

	return SelectStationForm;
}(_react.Component);

SelectStationForm.PropTypes = {
	searchParams: _react2.default.PropTypes.object,
	onSubmit: _react2.default.PropTypes.func,
	onCancel: _react2.default.PropTypes.func
};
SelectStationForm.contextTypes = {
	params: _react2.default.PropTypes.object.isRequired
};

var _default = (0, _reduxForm.reduxForm)({
	form: 'selectStationForm',
	enableReinitialize: true,
	keepDirtyOnReinitialize: true
})(SelectStationForm);

exports.default = _default;
;

var _temp = function () {
	if (typeof __REACT_HOT_LOADER__ === 'undefined') {
		return;
	}

	__REACT_HOT_LOADER__.register(SelectStationForm, 'SelectStationForm', '/Users/liuyihao/Code/kr-admin/src/Containers/Operation/CustomerManage/AgreementList/Reduce/Create/AllStation.js');

	__REACT_HOT_LOADER__.register(_default, 'default', '/Users/liuyihao/Code/kr-admin/src/Containers/Operation/CustomerManage/AgreementList/Reduce/Create/AllStation.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db250YWluZXJzL09wZXJhdGlvbi9DdXN0b21lck1hbmFnZS9BZ3JlZW1lbnRMaXN0L1JlZHVjZS9DcmVhdGUvQWxsU3RhdGlvbi5qcyJdLCJuYW1lcyI6WyJTZWxlY3RTdGF0aW9uRm9ybSIsInByb3BzIiwiY29udGV4dCIsIm9uU3VibWl0IiwiYmluZCIsIm9uQ2FuY2VsIiwib25TZWxlY3QiLCJnZXRMb2FkRGF0YSIsIm9uQ2hhbmdlUmVudEJlZ2luRGF0ZSIsInN0YXRlIiwic3RhdGlvblZvcyIsInNlbGVjdGVkIiwidmFsdWUiLCJsZW5ndGgiLCJzaG93IiwibWVzc2FnZSIsInR5cGUiLCJjb25jYXQiLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJpbmRleE9mIiwicmVudEJlZ2luRGF0ZSIsInNldFN0YXRlIiwiX3RoaXMiLCJwYXJhbXMiLCJkaXNwYXRjaCIsImNhbGxBUEkiLCJtYWluQmlsbGlkIiwib3JkZXJJZCIsInBhZ2UiLCJwYWdlc2l6ZSIsInRoZW4iLCJyZXNwb25zZSIsImNvbnNvbGUiLCJsb2ciLCJpdGVtcyIsImNhdGNoIiwiZXJyIiwic2VsZWN0ZWRTdGF0aW9uVm9zIiwiZmlsdGVyIiwic29tZVN0YXJ0RGF0ZSIsImZvckVhY2giLCJzb21lIiwic29ydCIsInByZSIsIm5leHQiLCJwcmVEYXRlIiwibGVhc2VFbmREYXRlIiwibmV4dERhdGUiLCJyZXN1bHRTdGF0aW9uVm9zIiwib2JqIiwiaWQiLCJzdGF0aW9uSWQiLCJzdGF0aW9uTmFtZSIsInVuaXRwcmljZSIsIndoZXJlRmxvb3IiLCJzdGF0aW9uVHlwZSIsInN0YXRpb25CZWdpbkRhdGUiLCJsZWFzZUJlZ2luRGF0ZSIsInN0YXRpb25FbmREYXRlIiwicHVzaCIsImlzT0siLCJEYXRlIiwicGFyc2UiLCJlcnJvciIsImhhbmRsZVN1Ym1pdCIsInByaXN0aW5lIiwicmVzZXQiLCJzdWJtaXR0aW5nIiwib3ZlcmZvbHciLCJtYXhIZWlnaHQiLCJoZWlnaHQiLCJtYXJnaW5Ub3AiLCJwYWRkaW5nQm90dG9tIiwiUHJvcFR5cGVzIiwic2VhcmNoUGFyYW1zIiwib2JqZWN0IiwiZnVuYyIsImNvbnRleHRUeXBlcyIsImlzUmVxdWlyZWQiLCJmb3JtIiwiZW5hYmxlUmVpbml0aWFsaXplIiwia2VlcERpcnR5T25SZWluaXRpYWxpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7QUFJQTs7QUFHQTs7QUFHQTs7OztBQUNBOztBQWVBOzs7Ozs7Ozs7O0lBa0JNQSxpQjs7O0FBVUwsNEJBQVlDLEtBQVosRUFBbUJDLE9BQW5CLEVBQTRCO0FBQUE7O0FBQUEscUlBQ3JCRCxLQURxQixFQUNkQyxPQURjOztBQUkzQixTQUFLQyxRQUFMLEdBQWdCLE9BQUtBLFFBQUwsQ0FBY0MsSUFBZCxRQUFoQjtBQUNBLFNBQUtDLFFBQUwsR0FBZ0IsT0FBS0EsUUFBTCxDQUFjRCxJQUFkLFFBQWhCO0FBQ0EsU0FBS0UsUUFBTCxHQUFnQixPQUFLQSxRQUFMLENBQWNGLElBQWQsUUFBaEI7QUFDQSxTQUFLRyxXQUFMLEdBQW1CLE9BQUtBLFdBQUwsQ0FBaUJILElBQWpCLFFBQW5CO0FBQ0EsU0FBS0kscUJBQUwsR0FBNkIsT0FBS0EscUJBQUwsQ0FBMkJKLElBQTNCLFFBQTdCOztBQUVBLFNBQUtLLEtBQUwsR0FBYTtBQUNaQyxlQUFZLEVBREE7QUFFWkMsYUFBVTtBQUZFLEdBQWI7O0FBVjJCO0FBZTNCOzs7O3NDQUVtQjtBQUNuQixRQUFLSixXQUFMO0FBQ0E7Ozt3Q0FHcUJLLEssRUFBTztBQUFBLGdCQUt4QixLQUFLSCxLQUxtQjtBQUFBLE9BRzNCQyxVQUgyQixVQUczQkEsVUFIMkI7QUFBQSxPQUkzQkMsUUFKMkIsVUFJM0JBLFFBSjJCOzs7QUFPNUIsT0FBSSxDQUFDQSxTQUFTRSxNQUFkLEVBQXNCO0FBQ3JCLGlCQUFPQyxJQUFQLENBQVksQ0FBQztBQUNaQyxjQUFTLFNBREc7QUFFWkMsV0FBTTtBQUZNLEtBQUQsQ0FBWjtBQUlBO0FBQ0E7O0FBRURKLFdBQVEsMEJBQVdBLEtB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QixDQUVFMkUsUyxHQUFZO0FBQ2xCQyxlQUFjLGdCQUFNRCxTQUFOLENBQWdCRSxNQURaO0FBRWxCMUUsV0FBVSxnQkFBTXdFLFNBQU4sQ0FBZ0JHLElBRlI7QUFHbEJ6RSxXQUFVLGdCQUFNc0UsU0FBTixDQUFnQkc7QUFIUixDO0FBRmQ5RSxpQixDQU9FK0UsWSxHQUFlO0FBQ3JCdEQsU0FBUSxnQkFBTWtELFNBQU4sQ0FBZ0JFLE1BQWhCLENBQXVCRztBQURWLEM7O2VBNFJSLDBCQUFVO0FBQ3hCQyxPQUFNLG1CQURrQjtBQUV4QkMscUJBQW9CLElBRkk7QUFHeEJDLDBCQUF5QjtBQUhELENBQVYsRUFJWm5GLGlCQUpZLEM7Ozs7Ozs7Ozs7K0JBblNUQSxpQiIsImZpbGUiOiJBbGxTdGF0aW9uLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9saXV5aWhhby9Db2RlL2tyLWFkbWluIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7XG5cdENvbXBvbmVudCxcblx0UHJvcFR5cGVzXG59IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG5cdGNvbm5lY3Rcbn0gZnJvbSAna3IvUmVkdXgnO1xuaW1wb3J0IHtcblx0QmluZGVyXG59IGZyb20gJ3JlYWN0LWJpbmRpbmcnO1xuaW1wb3J0IGRhdGVGb3JtYXQgZnJvbSAnZGF0ZWZvcm1hdCc7XG5pbXBvcnQge1xuXHRyZWR1eEZvcm0sXG5cdGZvcm1WYWx1ZVNlbGVjdG9yLFxuXHRjaGFuZ2UsXG5cdGluaXRpYWxpemUsXG5cdGFycmF5UHVzaCxcblx0YXJyYXlJbnNlcnQsXG5cdEZpZWxkQXJyYXlcbn0gZnJvbSAncmVkdXgtZm9ybSc7XG5cbmltcG9ydCB7XG5cdEFjdGlvbnMsXG5cdFN0b3JlXG59IGZyb20gJ2tyL1JlZHV4JztcblxuaW1wb3J0IHtcblx0Rm9ybSxcblx0VGFibGUsXG5cdFRhYmxlQm9keSxcblx0VGFibGVIZWFkZXIsXG5cdFRhYmxlSGVhZGVyQ29sdW1uLFxuXHRUYWJsZVJvdyxcblx0VGFibGVSb3dDb2x1bW4sXG5cdFRhYmxlRm9vdGVyLFxuXHRLckZpZWxkLFxuXHRHcmlkLFxuXHRSb3csXG5cdENvbCxcblx0QnV0dG9uLFxuXHROb3RpZnksXG5cdEtyRGF0ZSxcbn0gZnJvbSAna3ItdWknO1xuXG5jbGFzcyBTZWxlY3RTdGF0aW9uRm9ybSBleHRlbmRzIENvbXBvbmVudCB7XG5cblx0c3RhdGljIFByb3BUeXBlcyA9IHtcblx0XHRzZWFyY2hQYXJhbXM6IFJlYWN0LlByb3BUeXBlcy5vYmplY3QsXG5cdFx0b25TdWJtaXQ6IFJlYWN0LlByb3BUeXBlcy5mdW5jLFxuXHRcdG9uQ2FuY2VsOiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcblx0fVxuXHRzdGF0aWMgY29udGV4dFR5cGVzID0ge1xuXHRcdHBhcmFtczogUmVhY3QuUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG5cdH1cblx0Y29uc3RydWN0b3IocHJvcHMsIGNvbnRleHQpIHtcblx0XHRzdXBlcihwcm9wcywgY29udGV4dCk7XG5cblxuXHRcdHRoaXMub25TdWJtaXQgPSB0aGlzLm9uU3VibWl0LmJpbmQodGhpcyk7XG5cdFx0dGhpcy5vbkNhbmNlbCA9IHRoaXMub25DYW5jZWwuYmluZCh0aGlzKTtcblx0XHR0aGlzLm9uU2VsZWN0ID0gdGhpcy5vblNlbGVjdC5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuZ2V0TG9hZERhdGEgPSB0aGlzLmdldExvYWREYXRhLmJpbmQodGhpcyk7XG5cdFx0dGhpcy5vbkNoYW5nZVJlbnRCZWdpbkRhdGUgPSB0aGlzLm9uQ2hhbmdlUmVudEJlZ2luRGF0ZS5iaW5kKHRoaXMpO1xuXG5cdFx0dGhpcy5zdGF0ZSA9IHtcblx0XHRcdHN0YXRpb25Wb3M6IFtdLFxuXHRcdFx0c2VsZWN0ZWQ6IFtdLFxuXHRcdH1cblxuXHR9XG5cblx0Y29tcG9uZW50RGlkTW91bnQoKSB7XG5cdFx0dGhpcy5nZXRMb2FkRGF0YSgpO1xuXHR9XG5cblxuXHRvbkNoYW5nZVJlbnRCZWdpbkRhdGUodmFsdWUpIHtcblxuXHRcdGxldCB7XG5cdFx0XHRzdGF0aW9uVm9zLFxuXHRcdFx0c2VsZWN0ZWRcblx0XHR9ID0gdGhpcy5zdGF0ZTtcblxuXHRcdGlmICghc2VsZWN0ZWQubGVuZ3RoKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiAn6K+35YWI6YCJ5oup5bel5L2NIScsXG5cdFx0XHRcdHR5cGU6ICdkYW5nZXInLFxuXHRcdFx0fV0pO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhbHVlID0gZGF0ZUZvcm1hdCh2YWx1ZSwgJ3l5eXktbW0tZGQnKTtcblxuXHRcdGlmICghc2VsZWN0ZWQubGVuZ3RoKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiAn5pyq6YCJ5oup5YeP56ef5bel5L2NJyxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHN0YXRpb25Wb3MgPSBbXS5jb25jYXQoc3RhdGlvblZvcyk7XG5cdFx0c3RhdGlvblZvcy5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdGlmIChzZWxlY3RlZC5pbmRleE9mKGluZGV4KSAhPT0gLTEpIHtcblx0XHRcdFx0aXRlbS5yZW50QmVnaW5EYXRlID0gdmFsdWU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtLnJlbnRCZWdpbkRhdGUgPSAnJztcblx0XHRcdH1cblx0XHRcdHJldHVybiBpdGVtO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZXRTdGF0ZSh7XG5cdFx0XHRzdGF0aW9uVm9zXG5cdFx0fSk7XG5cblx0fVxuXG5cblx0Z2V0TG9hZERhdGEoKSB7XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRsZXQge1xuXHRcdFx0cGFyYW1zXG5cdFx0fSA9IHRoaXMuY29udGV4dDtcblx0XHRTdG9yZS5kaXNwYXRjaChBY3Rpb25zLmNhbGxBUEkoJ2dldFN0YXRpb25PclNldHRpbmdMaXN0Jywge1xuXHRcdFx0bWFpbkJpbGxpZDogcGFyYW1zLm9yZGVySWQsXG5cdFx0XHRwYWdlOiAxLFxuXHRcdFx0cGFnZXNpemU6IDEwMFxuXHRcdH0pKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRjb25zb2xlLmxvZygncmVzcG9uc2UnLCByZXNwb25zZSlcblxuXHRcdFx0X3RoaXMuc2V0U3RhdGUoe1xuXHRcdFx0XHRzdGF0aW9uVm9zOiByZXNwb25zZS5pdGVtc1xuXHRcdFx0fSk7XG5cdFx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiAn5ZCO5Y+w5Ye66ZSZ6K+36IGU57O7566h55CG5ZGYJyxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cdFx0fSk7XG5cdH1cblxuXHRvblNlbGVjdChzZWxlY3RlZCkge1xuXHRcdHRoaXMuc2V0U3RhdGUoe1xuXHRcdFx0c2VsZWN0ZWRcblx0XHR9LCBmdW5jdGlvbigpIHtcblxuXHRcdH0pO1xuXHR9XG5cblx0b25TdWJtaXQoKSB7XG5cdFx0Y29uc29sZS5sb2coJzEyMjMnKVxuXHRcdGxldCB7XG5cdFx0XHRzdGF0aW9uVm9zLFxuXHRcdFx0c2VsZWN0ZWRcblx0XHR9ID0gdGhpcy5zdGF0ZTtcblx0XHRsZXQgc2VsZWN0ZWRTdGF0aW9uVm9zID0gW107XG5cblx0XHRzZWxlY3RlZFN0YXRpb25Wb3MgPSBzdGF0aW9uVm9zLmZpbHRlcihmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHRcdFx0aWYgKHNlbGVjdGVkLmluZGV4T2YoaW5kZXgpICE9PSAtMSkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9KTtcblxuXG5cdFx0aWYgKCFzZWxlY3RlZFN0YXRpb25Wb3MubGVuZ3RoKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiAn6K+36YCJ5oup5bel5L2NJyxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvL+mAieS4reeahOW/hemhu+imgeacieenn+i1gee7k+adn+aXpeacn1xuXHRcdHZhciBzb21lU3RhcnREYXRlID0gdHJ1ZTtcblxuXHRcdHNlbGVjdGVkU3RhdGlvblZvcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0XHRpZiAoIWl0ZW0ucmVudEJlZ2luRGF0ZSkge1xuXHRcdFx0XHRzb21lU3RhcnREYXRlID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAoIXNvbWVTdGFydERhdGUpIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICfpgInmi6nnmoTlt6XkvY3lv4XpobvopoHmnInlh4/np5/lvIDlp4vml7bpl7QnLFxuXHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdH1dKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvL+W3peS9jee7k+adn+aXtumXtOebuOWQjFxuXHRcdHZhciBzb21lID0gdHJ1ZTtcblx0XHRzZWxlY3RlZFN0YXRpb25Wb3Muc29ydChmdW5jdGlvbihwcmUsIG5leHQpIHtcblx0XHRcdHZhciBwcmVEYXRlID0gZGF0ZUZvcm1hdChwcmUubGVhc2VFbmREYXRlLCAneXl5eS1tbS1kZCcpO1xuXHRcdFx0dmFyIG5leHREYXRlID0gZGF0ZUZvcm1hdChuZXh0LmxlYXNlRW5kRGF0ZSwgJ3l5eXktbW0tZGQnKTtcblx0XHRcdGlmIChwcmVEYXRlICE9IG5leHREYXRlKSB7XG5cdFx0XHRcdHNvbWUgPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiAtMTtcblx0XHR9KTtcblxuXHRcdGlmICghc29tZSkge1xuXHRcdFx0Tm90aWZ5LnNob3coW3tcblx0XHRcdFx0bWVzc2FnZTogJ+ivt+mAieaLqeebuOWQjOaXpeacnycsXG5cdFx0XHRcdHR5cGU6ICdkYW5nZXInLFxuXHRcdFx0fV0pO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdC8v5L+u5pS55pel5pyfXG5cdFx0dmFyIHJlc3VsdFN0YXRpb25Wb3MgPSBbXTtcblx0XHRzZWxlY3RlZFN0YXRpb25Wb3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHRcdFx0dmFyIG9iaiA9IHt9O1xuXHRcdFx0b2JqLmlkID0gaXRlbS5pZDtcblx0XHRcdG9iai5zdGF0aW9uSWQgPSBpdGVtLnN0YXRpb25JZDtcblx0XHRcdG9iai5zdGF0aW9uTmFtZSA9IGl0ZW0uc3RhdGlvbk5hbWU7XG5cdFx0XHRvYmoudW5pdHByaWNlID0gaXRlbS51bml0cHJpY2U7XG5cdFx0XHRvYmoud2hlcmVGbG9vciA9IGl0ZW0ud2hlcmVGbG9vcjtcblx0XHRcdG9iai5zdGF0aW9uVHlwZSA9IGl0ZW0uc3RhdGlvblR5cGU7XG5cblx0XHRcdG9iai5zdGF0aW9uQmVnaW5EYXRlID0gZGF0ZUZvcm1hdChpdGVtLmxlYXNlQmVnaW5EYXRlLCAneXl5eS1tbS1kZCcpO1xuXHRcdFx0b2JqLnN0YXRpb25FbmREYXRlID0gZGF0ZUZvcm1hdChpdGVtLmxlYXNlRW5kRGF0ZSwgJ3l5eXktbW0tZGQnKTtcblxuXHRcdFx0b2JqLmxlYXNlQmVnaW5EYXRlID0gZGF0ZUZvcm1hdChpdGVtLnJlbnRCZWdpbkRhdGUsICd5eXl5LW1tLWRkJyk7XG5cdFx0XHRvYmoubGVhc2VFbmREYXRlID0gZGF0ZUZvcm1hdChpdGVtLmxlYXNlRW5kRGF0ZSwgJ3l5eXktbW0tZGQnKTtcblx0XHRcdG9iai5yZW50QmVnaW5EYXRlID0gZGF0ZUZvcm1hdChpdGVtLnJlbnRCZWdpbkRhdGUsICd5eXl5LW1tLWRkJyk7XG5cblxuXG5cdFx0XHRyZXN1bHRTdGF0aW9uVm9zLnB1c2gob2JqKTtcblx0XHR9KTtcblxuXHRcdHNlbGVjdGVkU3RhdGlvblZvcyA9IHJlc3VsdFN0YXRpb25Wb3M7XG5cblxuXHRcdC8v6YCJ5oup55qE5YeP56ef5byA5aeL5pel5pyf5b+F6aG76KaB5Zyo5bel5L2N55qE6LW35aeL5pel5pyf5ZKM57uT5p2f5pel5pyf6IyD5Zu05YaFXG5cdFx0dmFyIGlzT0sgPSAxO1xuXHRcdHNlbGVjdGVkU3RhdGlvblZvcy5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdHZhciBzdGF0aW9uQmVnaW5EYXRlID0gRGF0ZS5wYXJzZShkYXRlRm9ybWF0KGl0ZW0uc3RhdGlvbkJlZ2luRGF0ZSwgJ3l5eXktbW0tZGQnKSArICcgMDA6MDA6MDAnKTtcblx0XHRcdHZhciBzdGF0aW9uRW5kRGF0ZSA9IERhdGUucGFyc2UoZGF0ZUZvcm1hdChpdGVtLnN0YXRpb25FbmREYXRlLCAneXl5eS1tbS1kZCcpICsgJyAwMDowMDowMCcpO1xuXHRcdFx0dmFyIHJlbnRCZWdpbkRhdGUgPSBEYXRlLnBhcnNlKGRhdGVGb3JtYXQoaXRlbS5yZW50QmVnaW5EYXRlLCAneXl5eS1tbS1kZCcpICsgJyAwMDowMDowMCcpO1xuXG5cdFx0XHRpZiAoc3RhdGlvbkJlZ2luRGF0ZSA+PSByZW50QmVnaW5EYXRlIHx8IHJlbnRCZWdpbkRhdGUgPj0gc3RhdGlvbkVuZERhdGUpIHtcblx0XHRcdFx0aXNPSyA9IDA7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAoIWlzT0spIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICflh4/np5/lvIDlp4vml7bpl7Tlv4XpobvopoHlnKjpgInmi6nlt6XkvY3nmoTnp5/otYHlvIDlp4vml6XmnJ/lkoznu5PmnZ/ml6XmnJ/kuYvlhoUnLFxuXHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdH1dKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0Y29uc29sZS5sb2coJy0tLS0+Pj4+Jywgc2VsZWN0ZWRTdGF0aW9uVm9zKVxuXG5cdFx0U3RvcmUuZGlzcGF0Y2goY2hhbmdlKCdyZWR1Y2VDcmVhdGVGb3JtJywgJ2xlYXNlQmVnaW5kYXRlJywgc2VsZWN0ZWRTdGF0aW9uVm9zWzBdLmxlYXNlRW5kRGF0ZSkpO1xuXG5cdFx0Y29uc3Qge1xuXHRcdFx0b25TdWJtaXRcblx0XHR9ID0gdGhpcy5wcm9wcztcblx0XHRvblN1Ym1pdCAmJiBvblN1Ym1pdChzZWxlY3RlZFN0YXRpb25Wb3MpO1xuXHR9XG5cblxuXHRvbkNhbmNlbCgpIHtcblx0XHRjb25zdCB7XG5cdFx0XHRvbkNhbmNlbFxuXHRcdH0gPSB0aGlzLnByb3BzO1xuXHRcdG9uQ2FuY2VsICYmIG9uQ2FuY2VsKCk7XG5cdH1cblxuXHRyZW5kZXIoKSB7XG5cblx0XHRsZXQge1xuXHRcdFx0ZXJyb3IsXG5cdFx0XHRoYW5kbGVTdWJtaXQsXG5cdFx0XHRwcmlzdGluZSxcblx0XHRcdHJlc2V0LFxuXHRcdFx0c3VibWl0dGluZ1xuXHRcdH0gPSB0aGlzLnByb3BzO1xuXHRcdGxldCB7XG5cdFx0XHRzdGF0aW9uVm9zXG5cdFx0fSA9IHRoaXMuc3RhdGU7XG5cdFx0Y29uc3Qgb3ZlcmZvbHcgPSB7XG5cdFx0XHQnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcblx0XHRcdG1heEhlaWdodDogNTEwLFxuXHRcdH1cblx0XHRjb25zdCBoZWlnaHQgPSB7XG5cdFx0XHRoZWlnaHQ6IHN0YXRpb25Wb3MubGVuZ3RoICogNDUsXG5cdFx0XHRtYXhIZWlnaHQ6IDY2Nyxcblx0XHR9XG5cdFx0cmV0dXJuIChcblx0XHRcdDxkaXYgc3R5bGU9e3toZWlnaHQ6NjY3LG1hcmdpblRvcDoyMH19PlxuPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdCh0aGlzLm9uU3VibWl0KX0+XG5cdFx0XHQ8S3JGaWVsZCBncmlkPXsxLzF9ICBuYW1lPVwicmVudEJlZ2luRGF0ZVwiIGNvbXBvbmVudD1cImRhdGVcIiBsYWJlbD1cIuWHj+enn+W8gOWni+aXtumXtO+8mlwiIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlUmVudEJlZ2luRGF0ZX0gaW5saW5lPXt0cnVlfS8+XG4gICAgICA8VGFibGUgb25TZWxlY3Q9e3RoaXMub25TZWxlY3R9IHN0eWxlPXtvdmVyZm9sd30+XG4gICAgICAgIDxUYWJsZUhlYWRlcj5cbiAgICAgICAgICA8VGFibGVIZWFkZXJDb2x1bW4+57G75YirPC9UYWJsZUhlYWRlckNvbHVtbj5cbiAgICAgICAgICA8VGFibGVIZWFkZXJDb2x1bW4+57yW5Y+377yP5ZCN56ewPC9UYWJsZUhlYWRlckNvbHVtbj5cbiAgICAgICAgICA8VGFibGVIZWFkZXJDb2x1bW4+5Y2V5Lu377yI5YWD77yP5pyI77yJPC9UYWJsZUhlYWRlckNvbHVtbj5cbiAgICAgICAgICA8VGFibGVIZWFkZXJDb2x1bW4+6LW35aeL5pel5pyfPC9UYWJsZUhlYWRlckNvbHVtbj5cbiAgICAgICAgICA8VGFibGVIZWFkZXJDb2x1bW4+57uT5p2f5pel5pyfPC9UYWJsZUhlYWRlckNvbHVtbj5cbiAgICAgICAgICA8VGFibGVIZWFkZXJDb2x1bW4+5YeP56ef5byA5aeL5pel5pyfPC9UYWJsZUhlYWRlckNvbHVtbj5cbiAgICAgIDwvVGFibGVIZWFkZXI+XG4gICAgICA8VGFibGVCb2R5PlxuICAgICAge3N0YXRpb25Wb3MgJiYgc3RhdGlvblZvcy5tYXAoKGl0ZW0saW5kZXgpPT57XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPFRhYmxlUm93IGtleT17aW5kZXh9PlxuXHQgICAgICAgICAgPFRhYmxlUm93Q29sdW1uID57KGl0ZW0uc3RhdGlvblR5cGUgPT0gMSkgPyflt6XkvY0nOifkvJrorq7lrqQnfTwvVGFibGVSb3dDb2x1bW4+XG5cdCAgICAgICAgICA8VGFibGVSb3dDb2x1bW4gPntpdGVtLnN0YXRpb25OYW1lfTwvVGFibGVSb3dDb2x1bW4+XG5cdCAgICAgICAgICA8VGFibGVSb3dDb2x1bW4gPntpdGVtLnVuaXRwcmljZX08L1RhYmxlUm93Q29sdW1uPlxuXHQgICAgICAgICAgPFRhYmxlUm93Q29sdW1uID48S3JEYXRlIHZhbHVlPXtpdGVtLmxlYXNlQmVnaW5EYXRlfS8+PC9UYWJsZVJvd0NvbHVtbj5cblx0ICAgICAgICAgIDxUYWJsZVJvd0NvbHVtbiA+PEtyRGF0ZSB2YWx1ZT17aXRlbS5sZWFzZUVuZERhdGV9Lz48L1RhYmxlUm93Q29sdW1uPlxuXHQgICAgICAgICAgPFRhYmxlUm93Q29sdW1uPlxuXHRcdFx0XHRcdHtpdGVtLnJlbnRCZWdpbkRhdGUmJiBkYXRlRm9ybWF0KGl0ZW0ucmVudEJlZ2luRGF0ZSwneXl5eS1tbS1kZCcpfVxuXHQgICAgICAgICAgPC9UYWJsZVJvd0NvbHVtbj5cbiAgICAgICAgIDwvVGFibGVSb3c+XG4gICAgICAgICk7XG4gICAgICB9KX1cbiAgICAgIDwvVGFibGVCb2R5PlxuICAgICAgPC9UYWJsZT5cbiAgICAgIDxHcmlkPlxuICAgICAgPFJvdyBzdHlsZT17e21hcmdpblRvcDozMCxwYWRkaW5nQm90dG9tOjI0fX0+XG4gICAgICA8Q29sIG1kPXs0fT48L0NvbD5cbiAgICAgIDxDb2wgbWQ9ezJ9IGFsaWduPVwiY2VudGVyXCI+IDxCdXR0b24gIGxhYmVsPVwi56Gu5a6aXCIgdHlwZT1cImJ1dHRvblwiIG9uQ2xpY2s9e3RoaXMub25TdWJtaXR9ICAvPiA8L0NvbD5cbiAgICAgIDxDb2wgbWQ9ezJ9IGFsaWduPVwiY2VudGVyXCI+IDxCdXR0b24gIGxhYmVsPVwi5Y+W5raIXCIgdHlwZT1cImJ1dHRvblwiIGNhbmNsZT17dHJ1ZX0gb25DbGljaz17dGhpcy5vbkNhbmNlbH0vPiA8L0NvbD5cbiAgICAgIDxDb2wgbWQ9ezR9PjwvQ29sPlxuICAgICAgIDwvUm93PlxuICAgICAgPC9HcmlkPlxuPC9mb3JtPlxuXHRcdFx0PC9kaXY+KTtcblx0fVxufVxuXG5leHBvcnQgZGVmYXVsdCByZWR1eEZvcm0oe1xuXHRmb3JtOiAnc2VsZWN0U3RhdGlvbkZvcm0nLFxuXHRlbmFibGVSZWluaXRpYWxpemU6IHRydWUsXG5cdGtlZXBEaXJ0eU9uUmVpbml0aWFsaXplOiB0cnVlXG59KShTZWxlY3RTdGF0aW9uRm9ybSk7Il19