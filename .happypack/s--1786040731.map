{"version":3,"sources":["src/Containers/Operation/CommunityManage/CompanyMembers/ImportData.js"],"names":["CancleLeader","props","context","test","_this","form","FormData","append","state","file","companyId","communityId","name","error","xhr","XMLHttpRequest","onreadystatechange","readyState","status","console","log","response","code","message","success","onCancel","onSubmit","onerror","e","statusText","open","responseType","send","onLoadDemo","importFile","onTokenSuccess","setState","onChange","event","fileName","target","files","arr","split","type","length","router","params","isInit","isUploading","progress","textAlign","marginTop","marginBottom","width","padding","paddingRight","paddingLeft","propTypes","initialValues","PropTypes","object","communityOptions","array","orderTypeOptions","contextTypes","isRequired"],"mappings":"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","file":"ImportData.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\n\nimport {\n\treduxForm,\n\tformValueSelector,\n\tinitialize,\n\tarrayPush,\n\tarrayInsert,\n\tFieldArray,\n\tchange\n} from 'redux-form';\n\nimport {\n\tActions,\n\tStore,\n\tconnect\n} from 'kr/Redux';\nimport $ from 'jquery';\n\nimport {\n\tSection,\n\tKrField,\n\tGrid,\n\tRow,\n\tCol,\n\tMessage,\n\tButton,\n\tKrDate,\n\tDotTitle,\n\tButtonGroup,\n\tPaper,\n\tListGroup,\n\tNotify,\n\tListGroupItem\n} from 'kr-ui';\n\nexport default class CancleLeader extends Component {\n\tstatic propTypes = {\n\t\tinitialValues:React.PropTypes.object,\n\t\tcommunityOptions:React.PropTypes.array,\n\t\torderTypeOptions:React.PropTypes.array,\n\t}\n\tstatic contextTypes = {\n\t\trouter: React.PropTypes.object.isRequired\n\t}\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\t\tthis.companyId = this.context.router.params.companyId\n\t\tthis.communityId = this.context.router.params.communityId\n\t\tthis.state = {\n\t\t\tisInit: true,\n\t\t\tform: {},\n\t\t\tfiles: [],\n\t\t\tisUploading: false,\n\t\t\tprogress: 0,\n\t\t\tfile:{},\n\t\t\tfileName:''\n\t\t}\n\t}\n\ttest=()=>{\n\t\tlet _this = this;\n    \tvar form = new FormData();\n\t\tform.append('file', this.state.file);\n\t\tform.append('companyId', this.companyId);\n\t\tform.append('communityId', this.communityId);\n\t\tif(!this.state.file.name){\n\t\t\tMessage.error('请选择上传文件');\n\t\t\treturn false;\n\t\t}\n\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function() {\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif (xhr.status === 200) {\n\t\t\t\t\tconsole.log('ss',xhr.response);\n\t\t\t\t\tif(xhr.response.code=='-1'){\n\t\t\t\t\t\tMessage.error(xhr.response.message);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tMessage.success(\"上传文件成功\");\n            \t\t\t_this.onCancel(); \n            \t\t\t_this.onSubmit();\n\t\t\t\t\t}\n\n\t\t\t\t\n\t\t\t\t} else {\n            \t_this.onCancel(); \n\t\t\t\t\tMessage.error('上传文件失败');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.onerror = function(e) {\n\t\t\tconsole.error(xhr.statusText);\n\t\t};\n\t\txhr.open('POST', 'http://optest02.krspace.cn/api/krspace-finance-web/member/member-excel', true);\n\t\txhr.responseType = 'json';\n\t\txhr.send(form);\n\n  }\n\n\tonCancel=()=>{\n\t\tconst {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t}\n\tonSubmit=()=>{\n\t\tconst {onSubmit} = this.props;\n\t\tonSubmit && onSubmit();\n\t}\n\tonLoadDemo=()=>{\n\t\tconst {onLoadDemo} = this.props;\n\t\tonLoadDemo && onLoadDemo();\n\t}\n\timportFile=()=>{\n\t\t// console.log('importFile');\n\t}\n\tonTokenSuccess=(form)=> {\n\t\tthis.setState({\n\t\t\tform\n\t\t});\n\t}\n\n\tonChange=(event)=> {\n\n\t\tvar _this = this;\n\t\tlet fileName = event.target.files[0].name;\n\t\tlet arr = event.target.files[0].name.split('.');\n\t\tlet type = arr[arr.length-1];\n\t\tif(type != 'xls' && type != 'xlsx'){\n\t\t\tMessage.error('上传文件类型不对，请选择.xls或.xlsx');\n\t\t\treturn ;\n\t\t}\n\t\t_this.setState({\n\t\t\tfileName,\n\t\t\tfile:event.target.files[0]\n\t\t})\n\n\n\t}\n\n\n\n\n\n\trender() {\n\t\tlet {fileName} = this.state;\n\n\n\t\treturn (\n\t\t\t<form  name='import' style={{textAlign:'center'}}>\n\t\t\t\t<div>\n\t\t\t\t\t<span className='import-logo icon-excel' onClick={this.importFile}><input type=\"file\" name=\"file\" className='chooce-file' onChange={this.onChange}/></span>\n\t\t\t\t\t\n\t\t\t\t\t<input type=\"hidden\" name=\"companyId\" />\n\n\t\t\t\t\t<span className='import-font'><span className=\"chooce\">请选择上传文件</span><input type=\"file\" name=\"file\" className='chooce-file' onChange={this.onChange}/></span>\n\t\t\t\t\t{fileName?<span className='file-name'>{fileName}</span>:''}\n\t\t\t\t\t<span className='load-demo icon-template' onClick={this.onLoadDemo}>下载excel模板</span>\n\t\t\t\t</div>\n\t\t\t\t<Grid style={{marginTop:10,marginBottom:6}}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t<ListGroupItem style={{width:'180px',textAlign:'right',padding:0,paddingRight:15}}><Button  label=\"确定导入\" type=\"button\" width={90} height={34} onClick={this.test}/></ListGroupItem>\n\t\t\t\t\t\t\t<ListGroupItem style={{width:'150px',textAlign:'left',padding:0,paddingLeft:15}}><Button  label=\"取消\" type=\"button\" cancle={true} onTouchTap={this.onCancel} width={90} height={34}/> </ListGroupItem>\n\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t  </Row>\n\t\t\t\t</Grid>\n\t\t\t\t</form>\n)\n\t}\n}\n"]}