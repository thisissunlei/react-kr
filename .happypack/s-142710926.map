{"version":3,"sources":["src/Components/DatePicker/Popover/Popover.js"],"names":["Popover","props","context","timeout","renderLayer","animated","animation","anchorEl","anchorOrigin","autoCloseWhenOffScreen","canAutoPosition","children","onRequestClose","style","targetOrigin","useLayerForClickAway","other","styleRoot","position","state","open","Animation","closing","componentClickAway","requestClose","setPlacement","scrolling","refs","layer","getLayer","targetEl","anchor","getAnchorPosition","target","getTargetPosition","targetPosition","top","vertical","left","horizontal","applyAutoPositionIfNeeded","Math","max","maxHeight","window","innerHeight","handleResize","handleScroll","bind","nextProps","setState","setTimeout","cancel","clearTimeout","reason","el","findDOMNode","rect","getBoundingClientRect","a","width","offsetWidth","height","offsetHeight","right","bottom","middle","center","anchorPosition","innerWidth","median","indexOf","t","positions","x","filter","p","y","overlap","getOverlapMode","splice","anchorPos","getPositions","newTop","newLeft","propTypes","object","origin","bool","func","node","className","string","zDepth","defaultProps","overflowY","contextTypes","muiTheme","isRequired"],"mappings":"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","file":"Popover.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {Component, PropTypes} from 'react';\nimport ReactDOM from 'react-dom';\nimport EventListener from 'react-event-listener';\nimport RenderToLayer from '../internal/RenderToLayer';\nimport propTypes from '../utils/propTypes';\nimport Paper from '../Paper';\nimport throttle from 'lodash.throttle';\nimport PopoverAnimationDefault from './PopoverAnimationDefault';\n\nclass Popover extends Component {\n  static propTypes = {\n    /**\n     * This is the DOM element that will be used to set the position of the\n     * popover.\n     */\n    anchorEl: PropTypes.object,\n    /**\n     * This is the point on the anchor where the popover's\n     * `targetOrigin` will attach to.\n     * Options:\n     * vertical: [top, center, bottom]\n     * horizontal: [left, middle, right].\n     */\n    anchorOrigin: propTypes.origin,\n    /**\n     * If true, the popover will apply transitions when\n     * it is added to the DOM.\n     */\n    animated: PropTypes.bool,\n    /**\n     * Override the default animation component used.\n     */\n    animation: PropTypes.func,\n    /**\n     * If true, the popover will hide when the anchor is scrolled off the screen.\n     */\n    autoCloseWhenOffScreen: PropTypes.bool,\n    /**\n     * If true, the popover (potentially) ignores `targetOrigin`\n     * and `anchorOrigin` to make itself fit on screen,\n     * which is useful for mobile devices.\n     */\n    canAutoPosition: PropTypes.bool,\n    /**\n     * The content of the popover.\n     */\n    children: PropTypes.node,\n    /**\n     * The CSS class name of the root element.\n     */\n    className: PropTypes.string,\n    /**\n     * Callback function fired when the popover is requested to be closed.\n     *\n     * @param {string} reason The reason for the close request. Possibles values\n     * are 'clickAway' and 'offScreen'.\n     */\n    onRequestClose: PropTypes.func,\n    /**\n     * If true, the popover is visible.\n     */\n    open: PropTypes.bool,\n    /**\n     * Override the inline-styles of the root element.\n     */\n    style: PropTypes.object,\n    /**\n     * This is the point on the popover which will attach to\n     * the anchor's origin.\n     * Options:\n     * vertical: [top, center, bottom]\n     * horizontal: [left, middle, right].\n     */\n    targetOrigin: propTypes.origin,\n    /**\n     * If true, the popover will render on top of an invisible\n     * layer, which will prevent clicks to the underlying\n     * elements, and trigger an `onRequestClose('clickAway')` call.\n     */\n    useLayerForClickAway: PropTypes.bool,\n    /**\n     * The zDepth of the popover.\n     */\n    zDepth: propTypes.zDepth,\n  };\n\n  static defaultProps = {\n    anchorOrigin: {\n      vertical: 'bottom',\n      horizontal: 'left',\n    },\n    animated: true,\n    autoCloseWhenOffScreen: true,\n    canAutoPosition: true,\n    onRequestClose: () => {},\n    open: false,\n    style: {\n      overflowY: 'auto',\n    },\n    targetOrigin: {\n      vertical: 'top',\n      horizontal: 'left',\n    },\n    useLayerForClickAway: true,\n    zDepth: 1,\n  };\n\n  static contextTypes = {\n    muiTheme: PropTypes.object.isRequired,\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.handleResize = throttle(this.setPlacement, 100);\n    this.handleScroll = throttle(this.setPlacement.bind(this, true), 50);\n\n    this.state = {\n      open: props.open,\n      closing: false,\n    };\n  }\n\n  componentDidMount() {\n    this.setPlacement();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.open !== this.state.open) {\n      if (nextProps.open) {\n        this.anchorEl = nextProps.anchorEl || this.props.anchorEl;\n        this.setState({\n          open: true,\n          closing: false,\n        });\n      } else {\n        if (nextProps.animated) {\n          if (this.timeout !== null) return;\n          this.setState({closing: true});\n          this.timeout = setTimeout(() => {\n            this.setState({\n              open: false,\n            }, () => {\n              this.timeout = null;\n            });\n          }, 500);\n        } else {\n          this.setState({\n            open: false,\n          });\n        }\n      }\n    }\n  }\n\n  componentDidUpdate() {\n    this.setPlacement();\n  }\n\n  componentWillUnmount() {\n    this.handleResize.cancel();\n    this.handleScroll.cancel();\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = null;\n    }\n  }\n\n  timeout = null;\n\n  renderLayer = () => {\n    const {\n      animated,\n      animation,\n      anchorEl, // eslint-disable-line no-unused-vars\n      anchorOrigin, // eslint-disable-line no-unused-vars\n      autoCloseWhenOffScreen, // eslint-disable-line no-unused-vars\n      canAutoPosition, // eslint-disable-line no-unused-vars\n      children,\n      onRequestClose, // eslint-disable-line no-unused-vars\n      style,\n      targetOrigin,\n      useLayerForClickAway, // eslint-disable-line no-unused-vars\n      ...other\n    } = this.props;\n\n    let styleRoot = style;\n\n    if (!animated) {\n      styleRoot = {\n        position: 'fixed',\n      };\n\n      if (!this.state.open) {\n        return null;\n      }\n\n      return (\n        <Paper style={Object.assign({}, styleRoot, style)} {...other}>\n          {children}\n        </Paper>\n      );\n    }\n\n    const Animation = animation || PopoverAnimationDefault;\n\n    return (\n      <Animation\n        targetOrigin={targetOrigin}\n        style={styleRoot}\n        {...other}\n        open={this.state.open && !this.state.closing}\n      >\n        {children}\n      </Animation>\n    );\n  };\n\n  requestClose(reason) {\n    if (this.props.onRequestClose) {\n      this.props.onRequestClose(reason);\n    }\n  }\n\n  componentClickAway = () => {\n    this.requestClose('clickAway');\n  };\n\n  getAnchorPosition(el) {\n    if (!el) {\n      el = ReactDOM.findDOMNode(this);\n    }\n\n    const rect = el.getBoundingClientRect();\n    const a = {\n      top: rect.top,\n      left: rect.left,\n      width: el.offsetWidth,\n      height: el.offsetHeight,\n    };\n\n    a.right = rect.right || a.left + a.width;\n    a.bottom = rect.bottom || a.top + a.height;\n    a.middle = a.left + ((a.right - a.left) / 2);\n    a.center = a.top + ((a.bottom - a.top) / 2);\n\n    return a;\n  }\n\n  getTargetPosition(targetEl) {\n    return {\n      top: 0,\n      center: targetEl.offsetHeight / 2,\n      bottom: targetEl.offsetHeight,\n      left: 0,\n      middle: targetEl.offsetWidth / 2,\n      right: targetEl.offsetWidth,\n    };\n  }\n\n  setPlacement = (scrolling) => {\n    if (!this.state.open) {\n      return;\n    }\n\n    if (!this.refs.layer.getLayer()) {\n      return;\n    }\n\n    const targetEl = this.refs.layer.getLayer().children[0];\n    if (!targetEl) {\n      return;\n    }\n\n    const {targetOrigin, anchorOrigin} = this.props;\n    const anchorEl = this.props.anchorEl || this.anchorEl;\n\n    const anchor = this.getAnchorPosition(anchorEl);\n    let target = this.getTargetPosition(targetEl);\n\n    let targetPosition = {\n      top: anchor[anchorOrigin.vertical] - target[targetOrigin.vertical],\n      left: anchor[anchorOrigin.horizontal] - target[targetOrigin.horizontal],\n    };\n\n    if (scrolling && this.props.autoCloseWhenOffScreen) {\n      this.autoCloseWhenOffScreen(anchor);\n    }\n\n    if (this.props.canAutoPosition) {\n      target = this.getTargetPosition(targetEl); // update as height may have changed\n      targetPosition = this.applyAutoPositionIfNeeded(anchor, target, targetOrigin, anchorOrigin, targetPosition);\n    }\n\n    targetEl.style.top = `${Math.max(0, targetPosition.top)}px`;\n    targetEl.style.left = `${Math.max(0, targetPosition.left)}px`;\n    targetEl.style.maxHeight = `${window.innerHeight}px`;\n  };\n\n  autoCloseWhenOffScreen(anchorPosition) {\n    if (anchorPosition.top < 0 ||\n      anchorPosition.top > window.innerHeight ||\n      anchorPosition.left < 0 ||\n      anchorPosition.left > window.innerWidth) {\n      this.requestClose('offScreen');\n    }\n  }\n\n  getOverlapMode(anchor, target, median) {\n    if ([anchor, target].indexOf(median) >= 0) return 'auto';\n    if (anchor === target) return 'inclusive';\n    return 'exclusive';\n  }\n\n  getPositions(anchor, target) {\n    const a = {...anchor};\n    const t = {...target};\n\n    const positions = {\n      x: ['left', 'right'].filter((p) => p !== t.horizontal),\n      y: ['top', 'bottom'].filter((p) => p !== t.vertical),\n    };\n\n    const overlap = {\n      x: this.getOverlapMode(a.horizontal, t.horizontal, 'middle'),\n      y: this.getOverlapMode(a.vertical, t.vertical, 'center'),\n    };\n\n    positions.x.splice(overlap.x === 'auto' ? 0 : 1, 0, 'middle');\n    positions.y.splice(overlap.y === 'auto' ? 0 : 1, 0, 'center');\n\n    if (overlap.y !== 'auto') {\n      a.vertical = a.vertical === 'top' ? 'bottom' : 'top';\n      if (overlap.y === 'inclusive') {\n        t.vertical = t.vertical;\n      }\n    }\n\n    if (overlap.x !== 'auto') {\n      a.horizontal = a.horizontal === 'left' ? 'right' : 'left';\n      if (overlap.y === 'inclusive') {\n        t.horizontal = t.horizontal;\n      }\n    }\n\n    return {\n      positions: positions,\n      anchorPos: a,\n    };\n  }\n\n  applyAutoPositionIfNeeded(anchor, target, targetOrigin, anchorOrigin, targetPosition) {\n    const {positions, anchorPos} = this.getPositions(anchorOrigin, targetOrigin);\n\n    if (targetPosition.top < 0 || targetPosition.top + target.bottom > window.innerHeight) {\n      let newTop = anchor[anchorPos.vertical] - target[positions.y[0]];\n      if (newTop + target.bottom <= window.innerHeight)\n        targetPosition.top = Math.max(0, newTop);\n      else {\n        newTop = anchor[anchorPos.vertical] - target[positions.y[1]];\n        if (newTop + target.bottom <= window.innerHeight)\n          targetPosition.top = Math.max(0, newTop);\n      }\n    }\n    if (targetPosition.left < 0 || targetPosition.left + target.right > window.innerWidth) {\n      let newLeft = anchor[anchorPos.horizontal] - target[positions.x[0]];\n      if (newLeft + target.right <= window.innerWidth)\n        targetPosition.left = Math.max(0, newLeft);\n      else {\n        newLeft = anchor[anchorPos.horizontal] - target[positions.x[1]];\n        if (newLeft + target.right <= window.innerWidth)\n          targetPosition.left = Math.max(0, newLeft);\n      }\n    }\n    return targetPosition;\n  }\n\n  render() {\n    return (\n      <div>\n        <EventListener\n          target=\"window\"\n          onScroll={this.handleScroll}\n          onResize={this.handleResize}\n        />\n        <RenderToLayer\n          ref=\"layer\"\n          open={this.state.open}\n          componentClickAway={this.componentClickAway}\n          useLayerForClickAway={this.props.useLayerForClickAway}\n          render={this.renderLayer}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Popover;\n"]}