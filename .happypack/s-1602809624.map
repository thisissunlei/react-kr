{"version":3,"sources":["src/Containers/Operation/CustomerManage/AgreementList/OneNewAgreement/index.js"],"names":["OneNewAgreement","props","onSubmit","_this","dispatch","callAPI","mainBillId","then","response","admit","intention","enter","increase","reduce","relet","returnRent","error","openTowAgreement","catch","err","message","onCancel","onChangeSign","person","length","fetchCustomer","customerId","id","companyName","company","listId","orderNameInit","orderList","ordersListData","value","data","customerName","orderCount","orderListChange","label","openNewIndent","orderName","nextClick","state","handleSubmit","pristine","reset","dataReady","open","paddingLeft","marginBottom","width","marginLeft","marginTop","marginRight","display","PropTypes","func","validate","errors","values","companyId","staionTypeId","form","enableReinitialize","keepDirtyOnReinitialize"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {Component, PropTypes} from 'react';\nimport {connect} from 'kr/Redux';\n\nimport {reduxForm,formValueSelector,initialize,change} from 'redux-form';\nimport {Actions,Store} from 'kr/Redux';\nimport {\n\tobserver\n} from 'mobx-react';\nimport mobx, {\n\tobservable,\n\taction,\n\tasMap,\n\tcomputed,\n\textendObservable,\n\ttoJS\n} from 'mobx';\nimport {\n\tKrField,\n\tGrid,\n\tRow,\n\tCol,\n\tButton,\n\tNotify,\n\tButtonGroup,\n\tMessage\n} from 'kr-ui';\nimport './index.less';\nimport State from './State';\nimport allState from '../State';\nimport NewIndent from \"../NewIndent\";\nimport newIndentState from \"../NewIndent/State\";\n\n@observer\n class OneNewAgreement extends Component{\n\n\n\n\tstatic PropTypes = {\n\t\tonSubmit:React.PropTypes.func,\n\t\tonCancel:React.PropTypes.func,\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state={\n\t\t\torderList:[],\n\t\t}\n\t}\n\t\n\tcomponentDidMount(){\n\t \t // Store.dispatch(change('NewCustomerList','hasOffice','NOHAS'));\n\t\t // Store.dispatch(change('NewCustomerList','hasOffice','NO'));\n\n\t}\n\t//下一步被点击\n\tonSubmit = () => {\n\t\t\t\n\t    var _this = this;\n\t\tStore.dispatch(Actions.callAPI('contracts-creation', {mainBillId:allState.mainBillId})).then(function(response) {\n\t\t//承租意向\n\t\tallState.admit=response.intention;\n\t\t//入驻合同是否可创建\t\n\n\t\t// allState.enter=true;\n\t\tallState.enter=response.enter;\n\t\t//增租合同是否可创建\n\t\tallState.increase=response.increase;\n\t\t//减租合同是否可创建\n\t\tallState.reduce=response.reduce;\n\t\t// allState.reduce=true;\n\t\t//续租合同是否可创建\n\t\tallState.relet=response.relet;\n\t\t//allState.relet=true;\n\t\t//退组合同是否可创建\n\t\tallState.returnRent=response.returnRent;\n        if(!allState.enter&&!allState.increase&&!allState.reduce&&!allState.relet&&!allState.returnRent){\n        \tMessage.error('没有合同可以创建');\n        \treturn ;\n        }\n        allState.openTowAgreement=true;\t\n\t\t}).catch(function(err) {\n\t\t\tMessage.error(err.message);\n\t\t});\n\t}\n\tonCancel = () => {\n\t\tconst {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t}\n\t onChangeSign=(person)=>{\n\t \tif(!person || person.length == 0) {\n\t \t\treturn;\n\t \t}\n\t\n\t\tthis.fetchCustomer({customerId:person.id});\n\t\tallState.companyName=person.company;\n\t\tallState.listId=person.id;\n\t\tthis.orderNameInit(person.id);\n\n    }\n\n    fetchCustomer=(customerId)=>{\n    \tState.orderList=[];\n    \tState.ordersListData(customerId);\n    }\n\n    //获取订单名称\n\torderNameInit = (value) => {\n\t\tvar _this=this;\n\t\tlet data={};\n\t\t\n\t\tdata.customerId=value;\n\n\t\tStore.dispatch(Actions.callAPI('get-customName-orderName',data)).then(function(response) {\n\t\t\tallState.customerName=response.customerName;\n\t\t\tallState.orderCount=response.orderCount;\n\t\t}).catch(function(err) {\n\t\t\t Message.error(err.message);\n\t\t});\t\t\n\t}\n\t//\n    orderListChange = (data) =>{\n    \tif(data.label==\"新建订单\"){\n    \t\tallState.openNewIndent=true;\n    \t\tthis.openNewIndent();\n\n    \t}else{\n          allState.mainBillId=data.value;\n          \n    \t}\n    }\n    //打开新建订单\n    openNewIndent=()=>{\n\t\tStore.dispatch(initialize('NewIndent',{}));\n\t\tvar _this=this;\n\t\tlet data={};\n\t\tdata.customerId=allState.listId;\n\n\t\tStore.dispatch(Actions.callAPI('get-customName-orderName',data)).then(function(response) {\n\t\t\tallState.customerName=response.customerName;\n\t\t\tallState.orderCount=response.orderCount;\n\t\t\tnewIndentState.orderName=\"\";\n\t\t}).catch(function(err) {\n\t\t\t Message.error(err.message);\n\t\t});\t\t\n\t}\n    //下一步被点击\n    nextClick = () =>{\n    \tthis.onCancel();\n    }\n\n\trender(){\n\t\tconst { error, handleSubmit, pristine, reset,dataReady,open} = this.props;\n\t\tlet {orderList}=this.state;\n\t\treturn (\n\n\t\t\t<form className=\"m-newMerchants\" onSubmit={handleSubmit(this.onSubmit)} style={{paddingLeft:9}} >\n\t\t\t\t<div className=\"title\" style={{marginBottom:\"30px\"}}>\n\t\t\t\t\t\t<div><span className=\"new-icon\"></span><label className=\"title-text\">新建合同</label></div>\n\t\t\t\t\t\t<div className=\"customer-close\" onClick={this.onCancel}></div>\n\t\t\t\t</div>\n\t\t\t\t\t\t<KrField  grid={1/2}  name=\"companyId\" style={{width:262,marginLeft:28}} component='companyName'  label=\"客户名称\" inline={false} onChange={this.onChangeSign} placeholder='请输入客户名称' requireLabel={true}/>\n\n\n\t\t\t\t\t\t<KrField grid={1/2} label=\"订单名称\" name=\"staionTypeId\" component=\"select\" style={{width:262,marginLeft:28}}\n\t\t\t\t\t\t\t\toptions={toJS(State.orderList)}\n\t\t\t\t\t\t\t\trequireLabel={true}\n\t\t\t\t\t\t\t\tonChange={this.orderListChange}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<Grid style={{marginTop:30}}>\n\t\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t\t<Col md={12} align=\"center\" style={{marginLeft:\"-27px\"}}>\n\t\t\t\t\t\t\t\t\t\t<div  className='ui-btn-center' style={{marginRight:20,display:\"inline-block\"}}><Button  label=\"下一步\" type=\"submit\"/></div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t<div style={{marginLeft:15,display:\"inline-block\"}}><Button  label=\"取消\" type=\"button\" cancle={true} onTouchTap={this.onCancel} /></div>\n\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t</form>\n\t\t);\n\t}\n}\nconst validate = values =>{\n\tconst errors = {};\n\tif(!values.companyId){\n\t\terrors.companyId = '客户名称不能为空';\n\t}\n\tif(!values.staionTypeId){\n\t\terrors.staionTypeId = '订单名称不能为空';\n\t}\n\treturn errors;\n}\nexport default reduxForm({ form: 'OneNewAgreement',validate,enableReinitialize:true,keepDirtyOnReinitialize:true})(OneNewAgreement);\n"]}