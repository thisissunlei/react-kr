{"version":3,"sources":["src/Components/PlanMap/index.js"],"names":["PlanMapComponent","props","onCheckedStation","clickStation","selectedStations","swapStationStaff","originStation","targetStation","console","log","drawCanvas","state","configs","plugns","planMap","initializeStyle","planMapWrap","refs","loc","getBoundingClientRect","width","height","setState","getBasicInfo","_this","dispatch","callAPI","then","response","data","shift","stationsDataOrigin","figures","stations","map","item","index","obj","cellcoord","split","x","pop","y","cellwidth","cellheight","name","cellname","basic","id","backgroundImage","bgfilepath","catch","error","window","addEventListener","nextProps","Component","displayName","defaultProps","communityId","wherefloor","mainBillId","startDate","endDate","contractId","propTypes","PropTypes","any","string","checkedStations","array"],"mappings":"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","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["\nimport React from 'react';\n\nimport PlanMap from './Lib/PlanMap';\n\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\n\nexport default  class PlanMapComponent extends React.Component {\n\n\tstatic displayName = 'PlanMapComponent';\n\n\tstatic defaultProps = {\n\t\tcommunityId:4,\n\t\twherefloor:3,\n\t\tmainBillId:521,\n\t\tstartDate:'2016-12-30',\n\t\tendDate:'2016-12-31',\n\t\tcontractId:''\n\t}\n\n\tstatic propTypes = {\n\t\t\tcommunityId: React.PropTypes.any,\n\t\t\twherefloor: React.PropTypes.any,\n\t\t\tmainBillId: React.PropTypes.any,\n\t\t\tstartDate: React.PropTypes.string,\n\t\t\tendDate: React.PropTypes.string,\n\t\t\tcontractId: React.PropTypes.any,\n\t\t\t//选中的工位\n\t\t\tcheckedStations:React.PropTypes.array\n\t}\n\n\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\t\tconfigs:{},\n\t\t\t\tplugns:{\n\t\t\t\t\tonCheckedStation:this.onCheckedStation,\n\t\t\t\t\tswapStationStaff:this.swapStationStaff\n\t\t\t\t}\n\t\t}\n\n\t}\n\n\t//点选工位\n\tonCheckedStation = (clickStation,selectedStations)=>{\n\t\t\tconst {onCheckedStation} = this.props;\n\t\t\tonCheckedStation && onCheckedStation(clickStation,selectedStations);\n\t}\n\t//交换工位员工信息\n\tswapStationStaff = (originStation,targetStation)=>{\n\t\tconsole.log('---<<',originStation,targetStation);\n\t}\n\n\tdrawCanvas = ()=>{\n\t\tconst {configs,plugns} = this.state;\n\t\tvar planMap = new PlanMap('planMapCanvas',configs,plugns);\n\t}\n\n\tinitializeStyle = ()=>{\n\t\tvar planMapWrap = this.refs.planMapWrap;\n\n\t\tvar loc = planMapWrap.getBoundingClientRect();\n\t\tvar configs = this.state.configs;\n\t\tconfigs.width = loc.width;\n\t\tconfigs.height = 800;\n\n\t\tthis.setState({\n\t\t\tconfigs\n\t\t},function(){\n\t\t\tthis.drawCanvas();\n\t\t});\n\n\t}\n\n\n\tgetBasicInfo = ()=>{\n\n\t\tvar _this = this;\n\t \tStore.dispatch(Actions.callAPI('planMap',Object.assign({},this.props))).then(function(response){\n\t           var data  = response.shift();\n\t          var stationsDataOrigin = data.figures;\n\t          var stations = [];\n\t          stations = stationsDataOrigin.map(function(item,index){\n\t            var obj = {};\n\t            var cellcoord = item.cellcoord;\n\t            cellcoord = cellcoord.split(',');\n\t            var x  = cellcoord.shift().split(':').pop();\n\t            var y  = cellcoord.pop().split(':').pop();\n\n\t            obj.x = x;\n\t            obj.y = y;\n\n\t            obj.width = item.cellwidth;\n\t            obj.height = item.cellheight;\n\t            obj.name = item.cellname;\n\t            obj.basic = {\n\t              name:item.cellname,\n\t              id:'yay'\n\t            };\n\t            return obj;\n\t          });\n\n\t          var configs = {\n\t            width:0,\n\t            height:0,\n\t\t\t\t\t\t\tstations:stations,\n\t\t\t\t\t\t\tbackgroundImage: 'http://optest02.krspace.cn'+data.bgfilepath\n\t          };\n\t\t\t\t\t_this.setState({configs},function(){\n\t\t\t\t\t\tthis.initializeStyle();\n\t\t\t\t\t});\n\t\t}).catch(function(error){\n\n\t\t});\n\t}\n\n\tcomponentDidMount(){\n\t\t\tthis.getBasicInfo();\n\t\t\twindow.addEventListener(\"resize\",function(){\n\t\t\t\t//this.initializeStyle();\n\t\t\t},false);\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\n\t}\n\n\trender() {\n\n\t\treturn (\n\t\t\t<div ref=\"planMapWrap\">\n\t\t\t\t<canvas id=\"planMapCanvas\"></canvas>\n\t\t\t</div>\n\t\t);\n\t}\n}\n"]}