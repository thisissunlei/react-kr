{"version":3,"sources":["src/Containers/Operation/CustomerManage/AgreementList/Join/Create/index.js"],"names":["JoinCreate","console","log","props","params","context","openConfirmCreateDialog","bind","onCreateSubmit","onCancel","onConfrimSubmit","state","initialValues","optionValues","formValues","openConfirmCreate","dispatch","isConfirmSubmiting","setState","stationVos","JSON","stringify","_this","callAPI","then","response","baiscInf","show","message","type","ajaxListData","cityName","communityName","createDateBegin","createDateEnd","createrName","customerName","page","pageSize","salerName","openTowAgreement","openOneAgreement","catch","err","customerId","mainBillId","orderId","communityId","contractstate","mainbillid","leaseContact","customer","customerMember","leaseContacttel","customerPhone","leaseAddress","customerAddress","communityAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","communityid","mainbillCommunityId","marginTop","childContextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\treduxForm,\n\tsubmitForm,\n\tchange,\n\treset\n} from 'redux-form';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tNotify,\n\tBreadCrumbs,\n\tTitle,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport ConfirmFormDetail from './ConfirmFormDetail';\nimport './index.less';\nimport allState from \"../../State\";\n\n\nexport default class JoinCreate extends Component {\n\t static childContextTypes = {\n        params: React.PropTypes.object.isRequired\n     }\n\n\n\n\t\tgetChildContext() {\n\t\t\tconsole.log(this.props.params,)\n\t    return {\n\t        params: this.props.params\n\t      }\n\n\t    }\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.openConfirmCreateDialog = this.openConfirmCreateDialog.bind(this);\n\t\tthis.onCreateSubmit = this.onCreateSubmit.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\t\tthis.onConfrimSubmit = this.onConfrimSubmit.bind(this);\n\n\t\tthis.state = {\n\t\t\tinitialValues: {},\n\t\t\toptionValues: {},\n\t\t\tformValues: {},\n\t\t\topenConfirmCreate: false\n\t\t}\n\t\tStore.dispatch(reset('joinCreateForm'));\n\n\t\tthis.isConfirmSubmiting = false;\n\t}\n\n\tonCreateSubmit(formValues) {\n\t\tthis.setState({\n\t\t\tformValues\n\t\t}, function() {\n\t\t\tthis.openConfirmCreateDialog();\n\t\t});\n\t}\n\n\tonConfrimSubmit() {\n\n\t\tif(this.isConfirmSubmiting){\n\t\t\t\treturn ;\n\t\t}\n\n\t\tthis.isConfirmSubmiting = true;\n\n\t\tlet {\n\t\t\tformValues\n\t\t} = this.state;\n\n\t\tlet {\n\t\t\tparams\n\t\t} = this.props;\n\t\tformValues.stationVos = JSON.stringify(formValues.stationVos);\n\n\t\tvar _this = this;\n\t\tStore.dispatch(Actions.callAPI('addOrEditEnterContract', {}, formValues)).then(function(response) {\n\n\t\t\t_this.setState({baiscInf:response});\n\n\t\t\t_this.isConfirmSubmiting = false;\n\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '创建成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\t\t\tallState.ajaxListData({cityName:'',communityName:'',createDateBegin:'',createDateEnd:'',createrName:'',customerName:'',page:'',pageSize:'',salerName:''})\n\t\t\tallState.openTowAgreement=false;\n\t\t\tallState.openOneAgreement=false;\n\t\t\t// window.setTimeout(function() {\n\t\t\t// \twindow.location.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/join/\" + response.contractId + \"/detail\";\n\t\t\t// }, 0);\n\n\n\t\t}).catch(function(err) {\n\t\t\t_this.isConfirmSubmiting = false;\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t\tthis.openConfirmCreateDialog();\n\t}\n\n\tonCancel() {\n\t\t//window.history.back();\n\t\tallState.openTowAgreement=false;\n\t\tallState.openOneAgreement=false;\n\t}\n\n\topenConfirmCreateDialog() {\n\t\tthis.setState({\n\t\t\topenConfirmCreate: !this.state.openConfirmCreate\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\n\t\tvar _this = this;\n\t\tconst {\n\t\t\tparams\n\t\t} = this.props;\n\t\tlet initialValues = {};\n\t\tlet optionValues = {};\n\n\t\tStore.dispatch(Actions.callAPI('fina-contract-intention', {\n\t\t\tcustomerId: params.customerId,\n\t\t\tmainBillId: params.orderId,\n\t\t\tcommunityId: 1\n\t\t})).then(function(response) {\n\t\t\tinitialValues.contractstate = 'UNSTART';\n\t\t\tinitialValues.mainbillid = params.orderId;\n\n\n\t\t\tinitialValues.leaseContact = response.customer.customerMember;\n\t\t\tinitialValues.leaseContacttel = response.customer.customerPhone;\n\n\n\t\t\tinitialValues.leaseAddress = response.customer.customerAddress;\n\n\n\t\t\toptionValues.communityAddress = response.customer.communityAddress;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\t//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n\t\t\tinitialValues.contracttype = 'ENTER';\n\n\t\t\toptionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.corporationName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.paymentList = response.payment.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.payTypeList = response.payType.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.floorList = response.customer.floor;\n\t\t\toptionValues.customerName = response.customer.customerName;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\toptionValues.communityName = response.customer.communityName;\n\t\t\toptionValues.communityId = response.customer.communityid;\n\t\t\toptionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n\t\t\t_this.setState({\n\t\t\t\tinitialValues,\n\t\t\t\toptionValues,\n\t\t\t});\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\toptionValues\n\t\t} = this.state;\n\n\n\t\treturn (\n\n\t\t\t<div>\n\n\t\t\t\t<Title value=\"创建入驻协议书_财务管理\"/>\n\n\t\t\t<div style={{marginTop:10}}>\n\t\t\t\t\t<NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues}/>\n\t\t\t</div>\n\n\t\t\t<Dialog\n\t\t\t\ttitle=\"入驻协议书\"\n\t\t\t\tmodal={true}\n\t\t\t\tautoScrollBodyContent={true}\n\t\t\t\tautoDetectWindowHeight={true}\n\t\t\t\topen={this.state.openConfirmCreate}\n\t\t\t\tonClose={this.openConfirmCreateDialog} >\n\t\t\t\t\t\t<ConfirmFormDetail detail={Object.assign({},this.state.formValues)} onSubmit={this.onConfrimSubmit} onCancel={this.openConfirmCreateDialog} optionValues={optionValues}/>\n\t\t\t  </Dialog>\n\t\t</div>\n\t\t);\n\t}\n}\n"]}