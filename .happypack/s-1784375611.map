{"version":3,"sources":["src/Containers/Member/MemberManage/Setting/StartCardActivation.js"],"names":["StartCardActivation","props","onSubmit","values","_this","navigator","onLine","error","isErr","params","foreignCode","state","detail","startNum","interCode","accomplish","reg","test","dispatch","callAPI","then","response","onFlush","title","openMessageBar","endNum","cardNumAdd","setTimeout","closeMessageBar","catch","err","message","numhandle","num","start","end","toString","substring","len","parseInt","length","i","oldNum","setState","success","onCancel","skipCard","InterCodeFocus","clearInterCodeStyle","display","clearInterCode","cardChange","value","console","log","cReg","RegExp","slice","open","style","className","handleSubmit","pristine","reset","throwBack","numbers","textAlign","width","margin","marginTop","marginLeft","height","padding","fontSize","marginRight","marginBottom","defaultProps","stage","PropTypes","func","object","string","validate","errors","selector","form","enableReinitialize","keepDirtyOnReinitialize"],"mappings":"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","file":"StartCardActivation.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {Component, PropTypes} from 'react';\nimport {connect} from 'kr/Redux';\n\nimport {reduxForm,formValueSelector,initialize,change,submit} from 'redux-form';\nimport {Actions,Store} from 'kr/Redux';\nimport {\n\tKrField,\n\tGrid,\n\tRow,\n\tCol,\n\tButton,\n\tNotify,\n\tButtonGroup,\n\tSnackTip,\n\tMessage\n} from 'kr-ui';\nimport './index.less';\n\n class StartCardActivation extends Component{\n\n\t static defaultProps = {\n\t \t\tstage:'importNum'\n\n\t \t}\n\t //节点的暴露\n\t static PropTypes = {\n\t\t onSubmit:React.PropTypes.func,\n\t\t onCancel:React.PropTypes.func,\n\t\t detail:React.PropTypes.object,\n\t\t /**\n\t\t  * stage表示批量修改所处的阶段\n\t\t  * 允许填入的值为 importNum|| activeCard\n\t\t  */\n\t\t stage:React.PropTypes.string,\n\t }\n\t//数据的初始化设定\n\tconstructor(props){\n\t\tsuper(props);\n\t    this.state={\n\t\t\t\t\tdetail:props.detail,\n\t\t\t\t\taccomplish:false,\n\t\t\t\t\tstartNum:props.detail.endNum-props.detail.startNum,\n\t\t\t\t\toldNum:props.detail.endNum-props.detail.startNum,\n\t\t\t\t\tcloseMessageBar:{\n\t\t\t\t\t\ttitle:'',\n\t\t\t\t\t\topen:false,\n\t\t\t\t\t\tstyle:{},\n\t\t\t\t\t\tclassName:''\n\t\t\t\t\t},\n\t\t\t\t\tclearInterCodeStyle:{\n\t\t\t\t\t\tdisplay:'none'\n\t\t\t\t\t},\n\t\t\t\t\tnum:0,\n\t    }\n\t}\n\t onSubmit=(values)=>{\n\t\tvar _this = this;\n\t \tif (navigator.onLine) \n\t\t{ //正常工作\n\t\t} \n\t\telse { //执行离线状态时的任务\n\t\t \t\tMessage.error(\"网络已断开\")\n\t\t \t\treturn;\n\t\t} \n\n\t\t var isErr=false;\n\t\t const params={};\n\t\t params.foreignCode=this.state.detail.startNum;\n\t\t params.interCode=values.interCode;\n\n\t\t if(!values.interCode){\n\n\t\t \treturn;\n\t\t }\n\t\t if(this.state.accomplish){\n\n\t\t\t return;\n\t\t }\n\n\t\tvar reg=/^[0-9a-fA-F]{8}$/;\n\t\tif (values.interCode&&!reg.test(values.interCode)) {\n\n\n\t\t\tMessage.error('内码为8位16进制数');\n\t\t\treturn;\n\t\t}\n\n\t\t Store.dispatch(Actions.callAPI('CardActivation', {}, params)).then(function(response) {\n\t\t\t\t\t//  Message.success(\"成功\");\n\t\t\t\t\t const detail={};\n\t\t\t\t\t detail.interCode=\"\";\n\t\t\t\t\t Store.dispatch(initialize('StartCardActivation',detail));\n\t\t\t\t\t _this.props.onFlush();\n\t\t\t\t\t var title=\"会员卡\"+values.interCode+\"激活成功\";\n\t\t\t\t\t_this.props.openMessageBar(title,\"ok\");\n\t\t\t\t\t\n\n\t\t\t\t\t if (_this.state.detail.startNum<=_this.state.detail.endNum) {\n\n\t\t\t\t\t\t\t _this.cardNumAdd(4);\n\t\t\t\t\t }\n\t\t\t\t\t setTimeout(function(){\n\t\t\t\t\t\t_this.props.closeMessageBar();\n\t\t\t\t\t },1000)\n\n\t\t }).catch(function(err) {\n\t\t \tif (err.message==\"该会员卡已被录入\") {\n\t\t \t\terr.message=\"卡号\"+_this.state.detail.startNum+\"已存在请跳过！\"\n\t\t \t}else if(err.message==\"该卡已被激活,请重刷\"){\n\t\t \t\terr.message=\"会员卡\"+values.interCode+\"已被激活，请换卡重刷！\"\n\t\t \t}\n\t\t \tif(err.message==\"Failed to fetch\"){\n\t\t \t\terr.message=\"连接不到服务器!\";\n\t\t \t\tMessage.error(err.message);\n\t\t \t\treturn;\n\t\t \t}\n\t\t\t\n\t\t \t_this.props.openMessageBar(err.message,\"error\");\n\t\t \tsetTimeout(function(){\n\t\t\t\t_this.props.closeMessageBar();\n\t\t\t},3000)\n\t\t })\n\t }\n\n\t //数字处理\n\t numhandle=(num,start,end)=>{\n\t\t \tnum=num.toString();\n\t\t\tnum=num.substring(start,end);\n\t\t\treturn num\n\t }\n\t //卡号增加\n\t cardNumAdd=(len)=>{\n\t\t let detail = Object.assign({},this.props.detail);\n\t\t var start=this.state.detail.startNum.substring(0,6).toString();\n\t\t var num=parseInt(this.state.detail.startNum.substring(6,10));\n\t\t \t\t num=num+1;\n\t\t \t\t num=num.toString();\n\t\t\t\t if (num.length<len) {\n\t\t\t\t \tfor (var i = num.length; i < len; i++) {\n\t\t\t\t\t\t\tnum='0'+num;\n\t\t\t\t \t}\n\t\t\t\t }\n\t\t\t\t if (this.state.detail.startNum==this.state.detail.endNum) {\n\t\t\t\t \t\n\t\t\t\t \tvar oldNum=this.state.oldNum+1;\n\t\t\t\t \tif(this.state.startNum==this.state.num){\n\t\t\t\t \t\toldNum=0;\n\t\t\t\t \t}\n\t\t\t\t\tthis.setState({\n\t \t\t\t\t \taccomplish:true\n\t \t\t\t \t})\n\t \t\t\t \tMessage.success(oldNum+\"张会员卡激活成功！\")\n\t \t\t\t \tthis.onCancel();\n\t\t\t\t\tdetail.startNum=detail.endNum=\"0000000000\"\n\n\t\t\t\t }else{\n\t\t\t\t \tdetail.startNum=start+num;\n\t\t\t\t\tdetail.endNum=this.state.detail.endNum;\n\t\t\t\t }\n\t\t\t\t\n\t\t\t\tthis.setState({\n\t\t\t\t\tdetail:detail\n\t\t\t\t})\n\t }\n\t //跳过号码\n\t skipCard=()=>{\n\t \tif (+this.state.detail.endNum!=0) {\n\t \t\tconst detail={};\n\t\t\tdetail.interCode=\"\";\n\t\t\tvar num=this.state.num+1;\n\t\t\tStore.dispatch(initialize('StartCardActivation',detail));\n\t \t\t this.setState({\n\t \t\t \toldNum:(+this.state.oldNum)-1,\n\t \t\t \tnum:num\n\t \t\t })\n\t\t \tthis.cardNumAdd(4);\n\t\t }\n\t }\n\n\t //关闭窗口\n\t onCancel=()=>{\n\t\t const {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t }\n\t InterCodeFocus=(values)=>{\n\t\tif(true){\n\t\t\tthis.setState({\n\t\t\t\tclearInterCodeStyle:{\n\t\t\t\t\tdisplay:'block'\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tclearInterCode=()=>{\n\t\tconst detail={};\n\t\tdetail.interCode=\"\";\n\t\tStore.dispatch(initialize('StartCardActivation',detail));\n\t\tthis.setState({\n\t\t\t\tclearInterCodeStyle:{\n\t\t\t\t\tdisplay:'none'\n\t\t\t\t}\n\t\t\t})\n\t}\n\tcardChange=(value)=>{\n\t\t\tconsole.log(\"999\")\n\n\t\tvar cReg=new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\",\"g\");\n\t\tvar reg=/^[0-9a-fA-F]{8}$/;\n\t\tif(value.length>8){\n\t\t\tvalue=value.slice(8,value.length+1);\n\t\t\tconst detail={};\n\t\t\tdetail.interCode=value;\n\t\t\tStore.dispatch(initialize('StartCardActivation',detail));\n\n\t\t\treturn;\n\t\t}\n\t\tif(cReg.test(value)){\n\t\t\tMessage.error('卡内码内含有中文请切换英文输入法！');\n\t\t\treturn;\n\t\t}\n\t}\n\n\trender(){\n\t\tconst {\n\t\t\terror,\n\t\t\thandleSubmit,\n\t\t\tpristine,\n\t\t\treset,\n\t\t\tthrowBack\n\t\t} = this.props;\n\t\tvar numbers=+this.state.detail.endNum==0?0:(+this.state.detail.endNum)-(+this.state.detail.startNum)+1;\n\t\treturn (\n\t\t\t<form className=\"HeavilyActivation\" onSubmit={handleSubmit(this.onSubmit)}>\n\t\t\t\t<div className=\"activeImg\" ></div>\n\t\t\t\t<div style={{textAlign:\"right\",width:340,margin:\"auto\",marginTop:10,marginLeft:52}}>\n\t\t\t\t\t\t<label >{\"会员卡数量:\"+numbers+\"张\"}</label>\n\t\t\t\t\t\t<div style={{height:'60px',marginTop:\"15px\",marginLeft:\"4px\"}}>\n\t\t\t\t\t\t\t\t<span className=\"cardNum\">{this.numhandle(this.state.detail.startNum,0,4)}</span>\n\t\t\t\t\t\t\t\t<span className=\"cardNum\" style={{padding:\"0 10px\"}}>{this.numhandle(this.state.detail.startNum,4,6)}</span>\n\t\t\t\t\t\t\t\t<span className=\"cardNum normal\">{this.numhandle(this.state.detail.startNum,6,10)}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<label className=\"jump\" onClick={this.skipCard} style={{fontSize:\"14px\"}} >跳过该号码</label>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"clearInterCode\" style={{marginLeft:\"-4px\",marginRight:\"4px\"}}>\n\t\t\t\t\t<KrField  left={71} right={71} name=\"interCode\"  type=\"text\" onFocus={this.InterCodeFocus} onChange={this.cardChange} autoFocus={true}/>\n\t\t\t\t\t<div className=\"startX\" style={this.state.clearInterCodeStyle} onClick={this.clearInterCode}></div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<Grid style={{marginTop:18,marginBottom:5}}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col md={12} align=\"center\">\n\t\t\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t\t{this.state.accomplish&&<div  className='ui-btn-center' style={{marginLeft:27}}><Button  label=\"完成\" type=\"submit\" backgroundColor={this.state.accomplish?\"#499df1\":\"#cccccc\"} onTouchTap={this.onCancel} /></div>}\n\t\t\t\t\t\t\t{!this.state.accomplish&&<Button  label=\"返回\" type=\"button\" cancle={true} onTouchTap={throwBack} />}\n\t\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Grid>\n\t\t\t\t\n\t\t\t\t\n\t\t\t</form>\n\t\t);\n\t}\n}\nconst validate = values =>{\n\t\t\n\t\tconst errors = {}\n\t\tvar reg=/^[0-9a-fA-F]{8}$/;\n\t\tconsole.log(\"1233\")\n\t\tif (!reg.test(values.interCode)) {\n\t\t\terrors.interCode='内码为8位16进制数';\n\t\t}\n\t\t\n\t\treturn errors\n\t}\nconst selector = formValueSelector('StartCardActivation');\n\n\n\nexport default reduxForm({ form: 'StartCardActivation', validate,enableReinitialize:true, keepDirtyOnReinitialize:true })(StartCardActivation);\n"]}