'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reduxForm = require('redux-form');

var _Redux = require('kr/Redux');

var _fetch = require('kr/Redux/Utils/fetch');

var _fetch2 = _interopRequireDefault(_fetch);

var _krUi = require('kr-ui');

var _NewCreateForm = require('./NewCreateForm');

var _NewCreateForm2 = _interopRequireDefault(_NewCreateForm);

require('./index.less');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var JoinCreate = function (_Component) {
	_inherits(JoinCreate, _Component);

	function JoinCreate(props, context) {
		_classCallCheck(this, JoinCreate);

		var _this2 = _possibleConstructorReturn(this, (JoinCreate.__proto__ || Object.getPrototypeOf(JoinCreate)).call(this, props, context));

		_this2.onCreateSubmit = _this2.onCreateSubmit.bind(_this2);
		_this2.onCancel = _this2.onCancel.bind(_this2);

		_this2.state = {
			stationVos: [],
			initialValues: {},
			optionValues: {},
			formValues: {},
			openConfirmCreate: false
		};

		_this2.isConfirmSubmiting = false;

		_Redux.Store.dispatch((0, _reduxForm.reset)('joinEditForm'));
		return _this2;
	}

	_createClass(JoinCreate, [{
		key: 'onCreateSubmit',
		value: function onCreateSubmit(formValues) {

			if (this.isConfirmSubmiting) {
				return;
			}

			var params = this.props.params;


			var _this = this;
			_Redux.Store.dispatch(_Redux.Actions.callAPI('addOrEditEnterContract', {}, formValues)).then(function (response) {

				_this.isConfirmSubmiting = false;
				_krUi.Notify.show([{
					message: '更新成功',
					type: 'success'
				}]);

				window.setTimeout(function () {
					window.location.href = "./#/operation/customerManage/" + params.customerId + "/order/" + params.orderId + "/agreement/join/" + response.contractId + "/detail";
				}, 0);
			}).catch(function (err) {
				_this.isConfirmSubmiting = false;
				_krUi.Notify.show([{
					message: err.message,
					type: 'danger'
				}]);
			});
		}
	}, {
		key: 'onCancel',
		value: function onCancel() {
			var params = this.context.params;

			window.location.href = './#/operation/customerManage/' + params.customerId + '/order/' + params.orderId + '/detail';
		}
	}, {
		key: 'componentDidMount',
		value: function componentDidMount() {

			var _this = this;
			var params = this.props.params;

			var initialValues = {};
			var optionValues = {};
			var stationVos = [];

			_Redux.Store.dispatch(_Redux.Actions.callAPI('fina-contract-intention', {
				customerId: params.customerId,
				mainBillId: params.orderId,
				communityId: 1
			})).then(function (response) {

				initialValues.contractstate = 'UNSTART';
				initialValues.mainbillid = params.orderId;

				optionValues.communityAddress = response.customer.communityAddress;
				optionValues.leaseAddress = response.customer.customerAddress;
				//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）
				initialValues.contracttype = 'ENTER';

				optionValues.fnaCorporationList = response.fnaCorporation.map(function (item, index) {
					item.value = item.id;
					item.label = item.corporationName;
					return item;
				});

				optionValues.paymentList = response.payment.map(function (item, index) {
					item.value = item.id;
					item.label = item.dicName;
					return item;
				});

				optionValues.payTypeList = response.payType.map(function (item, index) {
					item.value = item.id;
					item.label = item.dicName;
					return item;
				});

				optionValues.floorList = response.customer.floor;
				optionValues.customerName = response.customer.customerName;
				optionValues.leaseAddress = response.customer.customerAddress;
				optionValues.communityName = response.customer.communityName;
				optionValues.communityId = response.customer.communityid;
				optionValues.mainbillCommunityId = response.mainbillCommunityId || 1;

				_Redux.Store.dispatch(_Redux.Actions.callAPI('show-checkin-agreement', {
					id: params.id
				})).then(function (response) {

					optionValues.lessorContactName = response.lessorContactName;
					optionValues.contractFileList = response.contractFileList;

					initialValues.id = response.id;
					initialValues.leaseId = response.leaseId;
					initialValues.contractcode = response.contractcode;
					initialValues.leaseAddress = response.leaseAddress;
					initialValues.lessorContactid = response.lessorContactid;
					initialValues.lessorContactName = response.lessorContactName;
					initialValues.lessorContacttel = response.lessorContacttel;
					initialValues.contractVersionType = response.contractVersion;

					initialValues.leaseContact = response.leaseContact;
					initialValues.leaseContacttel = response.leaseContacttel;
					initialValues.paytype = response.payType.id;
					initialValues.paymodel = response.payment.id;

					initialValues.stationnum = response.stationnum;
					initialValues.boardroomnum = response.boardroomnum;
					initialValues.wherefloor = response.wherefloor;
					initialValues.rentaluse = response.rentaluse;
					initialValues.contractmark = response.contractmark || '';
					initialValues.totalrent = response.totalrent;
					initialValues.totaldeposit = response.totaldeposit;

					//时间
					initialValues.firstpaydate = response.firstpaydate;
					initialValues.signdate = response.signdate;
					initialValues.leaseBegindate = response.leaseBegindate;
					initialValues.leaseEnddate = response.leaseEnddate;

					//处理stationvos
					stationVos = response.stationVos;

					_this.setState({
						initialValues: initialValues,
						optionValues: optionValues,
						stationVos: stationVos
					});
				}).catch(function (err) {
					_krUi.Notify.show([{
						message: '后台出错请联系管理员',
						type: 'danger'
					}]);
				});
			}).catch(function (err) {
				_krUi.Notify.show([{
					message: '后台出错请联系管理员',
					type: 'danger'
				}]);
			});
		}
	}, {
		key: 'render',
		value: function render() {
			var _state = this.state,
			    initialValues = _state.initialValues,
			    optionValues = _state.optionValues,
			    stationVos = _state.stationVos;


			return _react2.default.createElement(
				'div',
				null,
				_react2.default.createElement(_krUi.Title, { value: '\u7F16\u8F91\u5165\u9A7B\u534F\u8BAE\u4E66_\u8D22\u52A1\u7BA1\u7406' }),
				_react2.default.createElement(_krUi.BreadCrumbs, { children: ['系统运营', '客户管理', '入驻协议'] }),
				_react2.default.createElement(
					_krUi.Section,
					{ title: '\u5165\u9A7B\u534F\u8BAE\u4E66', description: '' },
					_react2.default.createElement(_NewCreateForm2.default, { onSubmit: this.onCreateSubmit, initialValues: initialValues, onCancel: this.onCancel, optionValues: optionValues, stationVos: stationVos })
				)
			);
		}
	}]);

	return JoinCreate;
}(_react.Component);

JoinCreate.contextTypes = {
	params: _react2.default.PropTypes.object.isRequired
};
exports.default = JoinCreate;
;

var _temp = function () {
	if (typeof __REACT_HOT_LOADER__ === 'undefined') {
		return;
	}

	__REACT_HOT_LOADER__.register(JoinCreate, 'JoinCreate', '/Users/tmac_zc/Code/kr-admin/src/Containers/Operation/CustomerManage/Agreement/Join/Edit/index.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db250YWluZXJzL09wZXJhdGlvbi9DdXN0b21lck1hbmFnZS9BZ3JlZW1lbnQvSm9pbi9FZGl0L2luZGV4LmpzIl0sIm5hbWVzIjpbIkpvaW5DcmVhdGUiLCJwcm9wcyIsImNvbnRleHQiLCJvbkNyZWF0ZVN1Ym1pdCIsImJpbmQiLCJvbkNhbmNlbCIsInN0YXRlIiwic3RhdGlvblZvcyIsImluaXRpYWxWYWx1ZXMiLCJvcHRpb25WYWx1ZXMiLCJmb3JtVmFsdWVzIiwib3BlbkNvbmZpcm1DcmVhdGUiLCJpc0NvbmZpcm1TdWJtaXRpbmciLCJkaXNwYXRjaCIsInBhcmFtcyIsIl90aGlzIiwiY2FsbEFQSSIsInRoZW4iLCJyZXNwb25zZSIsInNob3ciLCJtZXNzYWdlIiwidHlwZSIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJsb2NhdGlvbiIsImhyZWYiLCJjdXN0b21lcklkIiwib3JkZXJJZCIsImNvbnRyYWN0SWQiLCJjYXRjaCIsImVyciIsIm1haW5CaWxsSWQiLCJjb21tdW5pdHlJZCIsImNvbnRyYWN0c3RhdGUiLCJtYWluYmlsbGlkIiwiY29tbXVuaXR5QWRkcmVzcyIsImN1c3RvbWVyIiwibGVhc2VBZGRyZXNzIiwiY3VzdG9tZXJBZGRyZXNzIiwiY29udHJhY3R0eXBlIiwiZm5hQ29ycG9yYXRpb25MaXN0IiwiZm5hQ29ycG9yYXRpb24iLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJ2YWx1ZSIsImlkIiwibGFiZWwiLCJjb3Jwb3JhdGlvbk5hbWUiLCJwYXltZW50TGlzdCIsInBheW1lbnQiLCJkaWNOYW1lIiwicGF5VHlwZUxpc3QiLCJwYXlUeXBlIiwiZmxvb3JMaXN0IiwiZmxvb3IiLCJjdXN0b21lck5hbWUiLCJjb21tdW5pdHlOYW1lIiwiY29tbXVuaXR5aWQiLCJtYWluYmlsbENvbW11bml0eUlkIiwibGVzc29yQ29udGFjdE5hbWUiLCJjb250cmFjdEZpbGVMaXN0IiwibGVhc2VJZCIsImNvbnRyYWN0Y29kZSIsImxlc3NvckNvbnRhY3RpZCIsImxlc3NvckNvbnRhY3R0ZWwiLCJjb250cmFjdFZlcnNpb25UeXBlIiwiY29udHJhY3RWZXJzaW9uIiwibGVhc2VDb250YWN0IiwibGVhc2VDb250YWN0dGVsIiwicGF5dHlwZSIsInBheW1vZGVsIiwic3RhdGlvbm51bSIsImJvYXJkcm9vbW51bSIsIndoZXJlZmxvb3IiLCJyZW50YWx1c2UiLCJjb250cmFjdG1hcmsiLCJ0b3RhbHJlbnQiLCJ0b3RhbGRlcG9zaXQiLCJmaXJzdHBheWRhdGUiLCJzaWduZGF0ZSIsImxlYXNlQmVnaW5kYXRlIiwibGVhc2VFbmRkYXRlIiwic2V0U3RhdGUiLCJjb250ZXh0VHlwZXMiLCJQcm9wVHlwZXMiLCJvYmplY3QiLCJpc1JlcXVpcmVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7OztBQUlBOztBQU1BOztBQUlBOzs7O0FBRUE7O0FBU0E7Ozs7QUFDQTs7Ozs7Ozs7OztJQUVxQkEsVTs7O0FBT3BCLHFCQUFZQyxLQUFaLEVBQW1CQyxPQUFuQixFQUE0QjtBQUFBOztBQUFBLHVIQUNyQkQsS0FEcUIsRUFDZEMsT0FEYzs7QUFHM0IsU0FBS0MsY0FBTCxHQUFzQixPQUFLQSxjQUFMLENBQW9CQyxJQUFwQixRQUF0QjtBQUNBLFNBQUtDLFFBQUwsR0FBZ0IsT0FBS0EsUUFBTCxDQUFjRCxJQUFkLFFBQWhCOztBQUVBLFNBQUtFLEtBQUwsR0FBYTtBQUNaQyxlQUFZLEVBREE7QUFFWkMsa0JBQWUsRUFGSDtBQUdaQyxpQkFBYyxFQUhGO0FBSVpDLGVBQVksRUFKQTtBQUtaQyxzQkFBbUI7QUFMUCxHQUFiOztBQVFBLFNBQUtDLGtCQUFMLEdBQTBCLEtBQTFCOztBQUVBLGVBQU1DLFFBQU4sQ0FBZSxzQkFBTSxjQUFOLENBQWY7QUFoQjJCO0FBaUIzQjs7OztpQ0FFY0gsVSxFQUFZOztBQUUxQixPQUFJLEtBQUtFLGtCQUFULEVBQTZCO0FBQzVCO0FBQ0E7O0FBSnlCLE9BT3pCRSxNQVB5QixHQVF0QixLQUFLYixLQVJpQixDQU96QmEsTUFQeUI7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NUZILENBNEZTLFVBQVNDLEdBQVQsRUFBYztBQUN0QixpQkFBT1gsSUFBUCxDQUFZLENBQUM7QUFDWkMsY0FBUyxZQURHO0FBRVpDLFdBQU07QUFGTSxLQUFELENBQVo7QUFJQSxJQWpHRDtBQWtHQTs7OzJCQUdRO0FBQUEsZ0JBTUosS0FBS2YsS0FORDtBQUFBLE9BR1BFLGFBSE8sVUFHUEEsYUFITztBQUFBLE9BSVBDLFlBSk8sVUFJUEEsWUFKTztBQUFBLE9BS1BGLFVBTE8sVUFLUEEsVUFMTzs7O0FBUVIsVUFFQztBQUFBO0FBQUE7QUFDQSxpREFBTyxPQUFNLHFFQUFiLEdBREE7QUFFQyx1REFBYSxVQUFVLENBQUMsTUFBRCxFQUFRLE1BQVIsRUFBZSxNQUFmLENBQXZCLEdBRkQ7QUFHQTtBQUFBO0FBQUEsT0FBUyxPQUFNLGdDQUFmLEVBQXVCLGFBQVksRUFBbkM7QUFDRSw4REFBZSxVQUFVLEtBQUtKLGNBQTlCLEVBQThDLGVBQWVLLGFBQTdELEVBQTRFLFVBQVUsS0FBS0gsUUFBM0YsRUFBcUcsY0FBY0ksWUFBbkgsRUFBaUksWUFBWUYsVUFBN0k7QUFERjtBQUhBLElBRkQ7QUFVQTs7Ozs7O0FBcE1tQlAsVSxDQUdib0YsWSxHQUFlO0FBQ3JCdEUsU0FBUSxnQkFBTXVFLFNBQU4sQ0FBZ0JDLE1BQWhCLENBQXVCQztBQURWLEM7a0JBSEZ2RixVOzs7Ozs7OzsrQkFBQUEsVSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvdG1hY196Yy9Db2RlL2tyLWFkbWluIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7XG5cdENvbXBvbmVudCxcblx0UHJvcFR5cGVzXG59IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG5cdHJlZHV4Rm9ybSxcblx0c3VibWl0Rm9ybSxcblx0Y2hhbmdlLFxuXHRyZXNldFxufSBmcm9tICdyZWR1eC1mb3JtJztcbmltcG9ydCB7XG5cdEFjdGlvbnMsXG5cdFN0b3JlXG59IGZyb20gJ2tyL1JlZHV4JztcbmltcG9ydCBodHRwIGZyb20gJ2tyL1JlZHV4L1V0aWxzL2ZldGNoJztcblxuaW1wb3J0IHtcblx0RGlhbG9nLFxuXHRTZWN0aW9uLFxuXHRHcmlkLFxuXHROb3RpZnksXG5cdEJyZWFkQ3J1bWJzLFxuXHRUaXRsZSxcbn0gZnJvbSAna3ItdWknO1xuXG5pbXBvcnQgTmV3Q3JlYXRlRm9ybSBmcm9tICcuL05ld0NyZWF0ZUZvcm0nO1xuaW1wb3J0ICcuL2luZGV4Lmxlc3MnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBKb2luQ3JlYXRlIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuXG5cdHN0YXRpYyBjb250ZXh0VHlwZXMgPSB7XG5cdFx0cGFyYW1zOiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcblx0fVxuXG5cdGNvbnN0cnVjdG9yKHByb3BzLCBjb250ZXh0KSB7XG5cdFx0c3VwZXIocHJvcHMsIGNvbnRleHQpO1xuXG5cdFx0dGhpcy5vbkNyZWF0ZVN1Ym1pdCA9IHRoaXMub25DcmVhdGVTdWJtaXQuYmluZCh0aGlzKTtcblx0XHR0aGlzLm9uQ2FuY2VsID0gdGhpcy5vbkNhbmNlbC5iaW5kKHRoaXMpO1xuXG5cdFx0dGhpcy5zdGF0ZSA9IHtcblx0XHRcdHN0YXRpb25Wb3M6IFtdLFxuXHRcdFx0aW5pdGlhbFZhbHVlczoge30sXG5cdFx0XHRvcHRpb25WYWx1ZXM6IHt9LFxuXHRcdFx0Zm9ybVZhbHVlczoge30sXG5cdFx0XHRvcGVuQ29uZmlybUNyZWF0ZTogZmFsc2Vcblx0XHR9XG5cblx0XHR0aGlzLmlzQ29uZmlybVN1Ym1pdGluZyA9IGZhbHNlO1xuXG5cdFx0U3RvcmUuZGlzcGF0Y2gocmVzZXQoJ2pvaW5FZGl0Rm9ybScpKTtcblx0fVxuXG5cdG9uQ3JlYXRlU3VibWl0KGZvcm1WYWx1ZXMpIHtcblxuXHRcdGlmICh0aGlzLmlzQ29uZmlybVN1Ym1pdGluZykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGxldCB7XG5cdFx0XHRwYXJhbXNcblx0XHR9ID0gdGhpcy5wcm9wcztcblxuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0U3RvcmUuZGlzcGF0Y2goQWN0aW9ucy5jYWxsQVBJKCdhZGRPckVkaXRFbnRlckNvbnRyYWN0Jywge30sIGZvcm1WYWx1ZXMpKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cblx0XHRcdF90aGlzLmlzQ29uZmlybVN1Ym1pdGluZyA9IGZhbHNlO1xuXHRcdFx0Tm90aWZ5LnNob3coW3tcblx0XHRcdFx0bWVzc2FnZTogJ+abtOaWsOaIkOWKnycsXG5cdFx0XHRcdHR5cGU6ICdzdWNjZXNzJyxcblx0XHRcdH1dKTtcblxuXHRcdFx0d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIuLyMvb3BlcmF0aW9uL2N1c3RvbWVyTWFuYWdlL1wiICsgcGFyYW1zLmN1c3RvbWVySWQgKyBcIi9vcmRlci9cIiArIHBhcmFtcy5vcmRlcklkICsgXCIvYWdyZWVtZW50L2pvaW4vXCIgKyByZXNwb25zZS5jb250cmFjdElkICsgXCIvZGV0YWlsXCI7XG5cdFx0XHR9LCAwKTtcblxuXG5cdFx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRfdGhpcy5pc0NvbmZpcm1TdWJtaXRpbmcgPSBmYWxzZTtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6IGVyci5tZXNzYWdlLFxuXHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdH1dKTtcblx0XHR9KTtcblx0fVxuXG5cblx0b25DYW5jZWwoKSB7XG5cdFx0bGV0IHtcblx0XHRcdHBhcmFtc1xuXHRcdH0gPSB0aGlzLmNvbnRleHQ7XG5cdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBgLi8jL29wZXJhdGlvbi9jdXN0b21lck1hbmFnZS8ke3BhcmFtcy5jdXN0b21lcklkfS9vcmRlci8ke3BhcmFtcy5vcmRlcklkfS9kZXRhaWxgO1xuXHR9XG5cblx0Y29tcG9uZW50RGlkTW91bnQoKSB7XG5cblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdGNvbnN0IHtcblx0XHRcdHBhcmFtc1xuXHRcdH0gPSB0aGlzLnByb3BzO1xuXHRcdGxldCBpbml0aWFsVmFsdWVzID0ge307XG5cdFx0bGV0IG9wdGlvblZhbHVlcyA9IHt9O1xuXHRcdGxldCBzdGF0aW9uVm9zID0gW107XG5cblx0XHRTdG9yZS5kaXNwYXRjaChBY3Rpb25zLmNhbGxBUEkoJ2ZpbmEtY29udHJhY3QtaW50ZW50aW9uJywge1xuXHRcdFx0Y3VzdG9tZXJJZDogcGFyYW1zLmN1c3RvbWVySWQsXG5cdFx0XHRtYWluQmlsbElkOiBwYXJhbXMub3JkZXJJZCxcblx0XHRcdGNvbW11bml0eUlkOiAxXG5cdFx0fSkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuXHRcdFx0aW5pdGlhbFZhbHVlcy5jb250cmFjdHN0YXRlID0gJ1VOU1RBUlQnO1xuXHRcdFx0aW5pdGlhbFZhbHVlcy5tYWluYmlsbGlkID0gcGFyYW1zLm9yZGVySWQ7XG5cblx0XHRcdG9wdGlvblZhbHVlcy5jb21tdW5pdHlBZGRyZXNzID0gcmVzcG9uc2UuY3VzdG9tZXIuY29tbXVuaXR5QWRkcmVzcztcblx0XHRcdG9wdGlvblZhbHVlcy5sZWFzZUFkZHJlc3MgPSByZXNwb25zZS5jdXN0b21lci5jdXN0b21lckFkZHJlc3M7XG5cdFx0XHQvL+WQiOWQjOexu+WIq++8jOaemuS4vuexu+Wei++8iDE65oSP5ZCR5LmmLDI65YWl5L2P5Y2P6K6uLDM65aKe56ef5Y2P6K6uLDQu57ut56ef5Y2P6K6uLDU65YeP56ef5Y2P6K6uLDbpgIDnp5/ljY/orq7vvIlcblx0XHRcdGluaXRpYWxWYWx1ZXMuY29udHJhY3R0eXBlID0gJ0VOVEVSJztcblxuXHRcdFx0b3B0aW9uVmFsdWVzLmZuYUNvcnBvcmF0aW9uTGlzdCA9IHJlc3BvbnNlLmZuYUNvcnBvcmF0aW9uLm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHRcdFx0XHRpdGVtLnZhbHVlID0gaXRlbS5pZDtcblx0XHRcdFx0aXRlbS5sYWJlbCA9IGl0ZW0uY29ycG9yYXRpb25OYW1lO1xuXHRcdFx0XHRyZXR1cm4gaXRlbTtcblx0XHRcdH0pO1xuXG5cdFx0XHRvcHRpb25WYWx1ZXMucGF5bWVudExpc3QgPSByZXNwb25zZS5wYXltZW50Lm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHRcdFx0XHRpdGVtLnZhbHVlID0gaXRlbS5pZDtcblx0XHRcdFx0aXRlbS5sYWJlbCA9IGl0ZW0uZGljTmFtZTtcblx0XHRcdFx0cmV0dXJuIGl0ZW07XG5cdFx0XHR9KTtcblxuXHRcdFx0b3B0aW9uVmFsdWVzLnBheVR5cGVMaXN0ID0gcmVzcG9uc2UucGF5VHlwZS5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdFx0aXRlbS52YWx1ZSA9IGl0ZW0uaWQ7XG5cdFx0XHRcdGl0ZW0ubGFiZWwgPSBpdGVtLmRpY05hbWU7XG5cdFx0XHRcdHJldHVybiBpdGVtO1xuXHRcdFx0fSk7XG5cblx0XHRcdG9wdGlvblZhbHVlcy5mbG9vckxpc3QgPSByZXNwb25zZS5jdXN0b21lci5mbG9vcjtcblx0XHRcdG9wdGlvblZhbHVlcy5jdXN0b21lck5hbWUgPSByZXNwb25zZS5jdXN0b21lci5jdXN0b21lck5hbWU7XG5cdFx0XHRvcHRpb25WYWx1ZXMubGVhc2VBZGRyZXNzID0gcmVzcG9uc2UuY3VzdG9tZXIuY3VzdG9tZXJBZGRyZXNzO1xuXHRcdFx0b3B0aW9uVmFsdWVzLmNvbW11bml0eU5hbWUgPSByZXNwb25zZS5jdXN0b21lci5jb21tdW5pdHlOYW1lO1xuXHRcdFx0b3B0aW9uVmFsdWVzLmNvbW11bml0eUlkID0gcmVzcG9uc2UuY3VzdG9tZXIuY29tbXVuaXR5aWQ7XG5cdFx0XHRvcHRpb25WYWx1ZXMubWFpbmJpbGxDb21tdW5pdHlJZCA9IHJlc3BvbnNlLm1haW5iaWxsQ29tbXVuaXR5SWQgfHwgMTtcblxuXG5cdFx0XHRTdG9yZS5kaXNwYXRjaChBY3Rpb25zLmNhbGxBUEkoJ3Nob3ctY2hlY2tpbi1hZ3JlZW1lbnQnLCB7XG5cdFx0XHRcdGlkOiBwYXJhbXMuaWRcblx0XHRcdH0pKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cblx0XHRcdFx0b3B0aW9uVmFsdWVzLmxlc3NvckNvbnRhY3ROYW1lID0gcmVzcG9uc2UubGVzc29yQ29udGFjdE5hbWU7XG5cdFx0XHRcdG9wdGlvblZhbHVlcy5jb250cmFjdEZpbGVMaXN0ID0gcmVzcG9uc2UuY29udHJhY3RGaWxlTGlzdDtcblxuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmlkID0gcmVzcG9uc2UuaWQ7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VJZCA9IHJlc3BvbnNlLmxlYXNlSWQ7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMuY29udHJhY3Rjb2RlID0gcmVzcG9uc2UuY29udHJhY3Rjb2RlO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmxlYXNlQWRkcmVzcyA9IHJlc3BvbnNlLmxlYXNlQWRkcmVzcztcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZXNzb3JDb250YWN0aWQgPSByZXNwb25zZS5sZXNzb3JDb250YWN0aWQ7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVzc29yQ29udGFjdE5hbWUgPSByZXNwb25zZS5sZXNzb3JDb250YWN0TmFtZTtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZXNzb3JDb250YWN0dGVsID0gcmVzcG9uc2UubGVzc29yQ29udGFjdHRlbDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5jb250cmFjdFZlcnNpb25UeXBlID0gcmVzcG9uc2UuY29udHJhY3RWZXJzaW9uO1xuXG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VDb250YWN0ID0gcmVzcG9uc2UubGVhc2VDb250YWN0O1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmxlYXNlQ29udGFjdHRlbCA9IHJlc3BvbnNlLmxlYXNlQ29udGFjdHRlbDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5wYXl0eXBlID0gcmVzcG9uc2UucGF5VHlwZS5pZDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5wYXltb2RlbCA9IHJlc3BvbnNlLnBheW1lbnQuaWQ7XG5cblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5zdGF0aW9ubnVtID0gcmVzcG9uc2Uuc3RhdGlvbm51bTtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5ib2FyZHJvb21udW0gPSByZXNwb25zZS5ib2FyZHJvb21udW07XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMud2hlcmVmbG9vciA9IHJlc3BvbnNlLndoZXJlZmxvb3I7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMucmVudGFsdXNlID0gcmVzcG9uc2UucmVudGFsdXNlO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmNvbnRyYWN0bWFyayA9IHJlc3BvbnNlLmNvbnRyYWN0bWFyayB8fCAnJztcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy50b3RhbHJlbnQgPSByZXNwb25zZS50b3RhbHJlbnQ7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMudG90YWxkZXBvc2l0ID0gcmVzcG9uc2UudG90YWxkZXBvc2l0O1xuXG5cdFx0XHRcdC8v5pe26Ze0XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMuZmlyc3RwYXlkYXRlID0gcmVzcG9uc2UuZmlyc3RwYXlkYXRlO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLnNpZ25kYXRlID0gcmVzcG9uc2Uuc2lnbmRhdGU7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VCZWdpbmRhdGUgPSByZXNwb25zZS5sZWFzZUJlZ2luZGF0ZTtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZWFzZUVuZGRhdGUgPSByZXNwb25zZS5sZWFzZUVuZGRhdGU7XG5cblx0XHRcdFx0Ly/lpITnkIZzdGF0aW9udm9zXG5cdFx0XHRcdHN0YXRpb25Wb3MgPSByZXNwb25zZS5zdGF0aW9uVm9zO1xuXG5cdFx0XHRcdF90aGlzLnNldFN0YXRlKHtcblx0XHRcdFx0XHRpbml0aWFsVmFsdWVzLFxuXHRcdFx0XHRcdG9wdGlvblZhbHVlcyxcblx0XHRcdFx0XHRzdGF0aW9uVm9zXG5cdFx0XHRcdH0pO1xuXG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0Tm90aWZ5LnNob3coW3tcblx0XHRcdFx0XHRtZXNzYWdlOiAn5ZCO5Y+w5Ye66ZSZ6K+36IGU57O7566h55CG5ZGYJyxcblx0XHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdFx0fV0pO1xuXHRcdFx0fSk7XG5cblxuXHRcdH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXHRcdFx0Tm90aWZ5LnNob3coW3tcblx0XHRcdFx0bWVzc2FnZTogJ+WQjuWPsOWHuumUmeivt+iBlOezu+euoeeQhuWRmCcsXG5cdFx0XHRcdHR5cGU6ICdkYW5nZXInLFxuXHRcdFx0fV0pO1xuXHRcdH0pO1xuXHR9XG5cblxuXHRyZW5kZXIoKSB7XG5cblx0XHRsZXQge1xuXHRcdFx0aW5pdGlhbFZhbHVlcyxcblx0XHRcdG9wdGlvblZhbHVlcyxcblx0XHRcdHN0YXRpb25Wb3Ncblx0XHR9ID0gdGhpcy5zdGF0ZTtcblxuXHRcdHJldHVybiAoXG5cblx0XHRcdDxkaXY+XG5cdFx0XHQ8VGl0bGUgdmFsdWU9XCLnvJbovpHlhaXpqbvljY/orq7kuaZf6LSi5Yqh566h55CGXCIvPlxuXHRcdCBcdDxCcmVhZENydW1icyBjaGlsZHJlbj17Wyfns7vnu5/ov5DokKUnLCflrqLmiLfnrqHnkIYnLCflhaXpqbvljY/orq4nXX0vPlxuXHRcdFx0PFNlY3Rpb24gdGl0bGU9XCLlhaXpqbvljY/orq7kuaZcIiBkZXNjcmlwdGlvbj1cIlwiPlxuXHRcdFx0XHRcdDxOZXdDcmVhdGVGb3JtIG9uU3VibWl0PXt0aGlzLm9uQ3JlYXRlU3VibWl0fSBpbml0aWFsVmFsdWVzPXtpbml0aWFsVmFsdWVzfSBvbkNhbmNlbD17dGhpcy5vbkNhbmNlbH0gb3B0aW9uVmFsdWVzPXtvcHRpb25WYWx1ZXN9IHN0YXRpb25Wb3M9e3N0YXRpb25Wb3N9Lz5cblx0XHRcdDwvU2VjdGlvbj5cblx0XHQ8L2Rpdj5cblx0XHQpO1xuXHR9XG59Il19