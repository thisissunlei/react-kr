'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _simpleAssign = require('simple-assign');

var _simpleAssign2 = _interopRequireDefault(_simpleAssign);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reduxForm = require('redux-form');

var _Redux = require('kr/Redux');

var _fetch = require('kr/Redux/Utils/fetch');

var _fetch2 = _interopRequireDefault(_fetch);

var _krUi = require('kr-ui');

require('./index.less');

var _NewCreateForm = require('./NewCreateForm');

var _NewCreateForm2 = _interopRequireDefault(_NewCreateForm);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var JoinCreate = function (_Component) {
	_inherits(JoinCreate, _Component);

	function JoinCreate(props, context) {
		_classCallCheck(this, JoinCreate);

		var _this2 = _possibleConstructorReturn(this, (JoinCreate.__proto__ || Object.getPrototypeOf(JoinCreate)).call(this, props, context));

		_this2.onCreateSubmit = _this2.onCreateSubmit.bind(_this2);
		_this2.onCancel = _this2.onCancel.bind(_this2);

		_this2.state = {
			stationVos: [],
			initialValues: {},
			optionValues: {},
			formValues: {}
		};

		_Redux.Store.dispatch((0, _reduxForm.reset)('increaseCreateForm'));
		return _this2;
	}

	_createClass(JoinCreate, [{
		key: 'onCreateSubmit',
		value: function onCreateSubmit(formValues) {
			formValues = (0, _simpleAssign2.default)({}, formValues);
			var params = this.props.params;

			_Redux.Store.dispatch(_Redux.Actions.callAPI('addOrEditIncreaseContract', {}, formValues)).then(function (response) {
				_krUi.Notify.show([{
					message: '更新成功',
					type: 'success'
				}]);
				location.href = "./#/operation/customerManage/" + params.customerId + "/order/" + params.orderId + "/agreement/increase/" + response.contractId + "/detail";
			}).catch(function (err) {
				_krUi.Notify.show([{
					message: err.message,
					type: 'danger'
				}]);
			});
		}
	}, {
		key: 'onCancel',
		value: function onCancel() {
			var params = this.context.params;

			window.location.href = './#/operation/customerManage/' + params.customerId + '/order/' + params.orderId + '/detail';
		}
	}, {
		key: 'componentDidMount',
		value: function componentDidMount() {

			var _this = this;
			var params = this.props.params;

			var initialValues = {};
			var optionValues = {};
			var stationVos = [];

			_Redux.Store.dispatch(_Redux.Actions.callAPI('fina-contract-intention', {
				customerId: params.customerId,
				mainBillId: params.orderId,
				communityId: 1
			})).then(function (response) {

				initialValues.contractstate = 'UNSTART';
				initialValues.mainbillid = params.orderId;
				initialValues.leaseContact = response.customer.customerMember;
				initialValues.leaseContacttel = response.customer.customerPhone;
				initialValues.signdate = +new Date(new Date().getTime() - 24 * 60 * 60 * 1000);

				optionValues.communityAddress = response.customer.communityAddress;
				optionValues.leaseAddress = response.customer.customerAddress;
				//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）
				initialValues.contracttype = 'ADDRENT';

				optionValues.fnaCorporationList = response.fnaCorporation.map(function (item, index) {
					item.value = item.id;
					item.label = item.corporationName;
					return item;
				});
				optionValues.paymentList = response.payment.map(function (item, index) {
					item.value = item.id;
					item.label = item.dicName;
					return item;
				});
				optionValues.payTypeList = response.payType.map(function (item, index) {
					item.value = item.id;
					item.label = item.dicName;
					return item;
				});

				optionValues.floorList = response.customer.floor;
				optionValues.customerName = response.customer.customerName;
				optionValues.leaseAddress = response.customer.customerAddress;
				optionValues.communityName = response.customer.communityName;
				optionValues.communityId = response.customer.communityid;
				optionValues.mainbillCommunityId = response.mainbillCommunityId || 1;

				_Redux.Store.dispatch(_Redux.Actions.callAPI('show-checkin-agreement', {
					id: params.id
				})).then(function (response) {
					console.log('response', response);

					optionValues.lessorContactName = response.lessorContactName;

					optionValues.contractFileList = response.contractFileList;

					initialValues.id = response.id;
					initialValues.leaseId = response.leaseId;
					initialValues.contractcode = response.contractcode;
					initialValues.contractVersionType = response.contractVersion;

					initialValues.lessorContactid = response.lessorContactid;
					initialValues.lessorContactName = response.lessorContactName;

					initialValues.leaseId = response.leaseId;
					initialValues.leaseAddress = response.leaseAddress;
					initialValues.leaseContact = response.leaseContact;
					initialValues.leaseContacttel = response.leaseContacttel;
					initialValues.paytype = response.payType.id;
					initialValues.paymodel = response.payment.id;
					initialValues.stationnum = response.stationnum;
					initialValues.wherefloor = response.wherefloor;
					initialValues.rentaluse = response.rentaluse;
					initialValues.contractmark = response.contractmark || '';
					initialValues.totalrent = response.totalrent;
					initialValues.totaldeposit = response.totaldeposit;
					initialValues.lessorContacttel = response.lessorContacttel;

					//时间
					initialValues.firstpaydate = new Date(response.firstpaydate);
					initialValues.signdate = new Date(response.signdate);
					initialValues.leaseBegindate = new Date(response.leaseBegindate);
					initialValues.leaseEnddate = new Date(response.leaseEnddate);

					console.log('时间', initialValues);

					//处理stationvos
					stationVos = response.stationVos;

					_this.setState({
						initialValues: initialValues,
						optionValues: optionValues,
						stationVos: stationVos
					});
				}).catch(function (err) {
					_krUi.Notify.show([{
						message: '后台出错请联系管理员',
						type: 'danger'
					}]);
				});
			}).catch(function (err) {
				_krUi.Notify.show([{
					message: '后台出错请联系管理员',
					type: 'danger'
				}]);
			});
		}
	}, {
		key: 'render',
		value: function render() {
			var _state = this.state,
			    initialValues = _state.initialValues,
			    optionValues = _state.optionValues,
			    stationVos = _state.stationVos;


			return _react2.default.createElement(
				'div',
				null,
				_react2.default.createElement(_krUi.Title, { value: '\u7F16\u8F91\u589E\u79DF\u534F\u8BAE\u4E66_\u8D22\u52A1\u7BA1\u7406' }),
				_react2.default.createElement(_krUi.BreadCrumbs, { children: ['系统运营', '客户管理', '增租协议书'] }),
				_react2.default.createElement(
					_krUi.Section,
					{ title: '\u589E\u79DF\u534F\u8BAE\u4E66', description: '' },
					_react2.default.createElement(_NewCreateForm2.default, { onSubmit: this.onCreateSubmit, initialValues: initialValues, onCancel: this.onCancel, optionValues: optionValues, stationVos: stationVos })
				)
			);
		}
	}]);

	return JoinCreate;
}(_react.Component);

JoinCreate.contextTypes = {
	params: _react2.default.PropTypes.object.isRequired
};
exports.default = JoinCreate;
;

var _temp = function () {
	if (typeof __REACT_HOT_LOADER__ === 'undefined') {
		return;
	}

	__REACT_HOT_LOADER__.register(JoinCreate, 'JoinCreate', '/Users/tmac_zc/Code/kr-admin/src/Containers/Operation/CustomerManage/Agreement/Increase/Edit/index.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db250YWluZXJzL09wZXJhdGlvbi9DdXN0b21lck1hbmFnZS9BZ3JlZW1lbnQvSW5jcmVhc2UvRWRpdC9pbmRleC5qcyJdLCJuYW1lcyI6WyJKb2luQ3JlYXRlIiwicHJvcHMiLCJjb250ZXh0Iiwib25DcmVhdGVTdWJtaXQiLCJiaW5kIiwib25DYW5jZWwiLCJzdGF0ZSIsInN0YXRpb25Wb3MiLCJpbml0aWFsVmFsdWVzIiwib3B0aW9uVmFsdWVzIiwiZm9ybVZhbHVlcyIsImRpc3BhdGNoIiwicGFyYW1zIiwiY2FsbEFQSSIsInRoZW4iLCJyZXNwb25zZSIsInNob3ciLCJtZXNzYWdlIiwidHlwZSIsImxvY2F0aW9uIiwiaHJlZiIsImN1c3RvbWVySWQiLCJvcmRlcklkIiwiY29udHJhY3RJZCIsImNhdGNoIiwiZXJyIiwid2luZG93IiwiX3RoaXMiLCJtYWluQmlsbElkIiwiY29tbXVuaXR5SWQiLCJjb250cmFjdHN0YXRlIiwibWFpbmJpbGxpZCIsImxlYXNlQ29udGFjdCIsImN1c3RvbWVyIiwiY3VzdG9tZXJNZW1iZXIiLCJsZWFzZUNvbnRhY3R0ZWwiLCJjdXN0b21lclBob25lIiwic2lnbmRhdGUiLCJEYXRlIiwiZ2V0VGltZSIsImNvbW11bml0eUFkZHJlc3MiLCJsZWFzZUFkZHJlc3MiLCJjdXN0b21lckFkZHJlc3MiLCJjb250cmFjdHR5cGUiLCJmbmFDb3Jwb3JhdGlvbkxpc3QiLCJmbmFDb3Jwb3JhdGlvbiIsIm1hcCIsIml0ZW0iLCJpbmRleCIsInZhbHVlIiwiaWQiLCJsYWJlbCIsImNvcnBvcmF0aW9uTmFtZSIsInBheW1lbnRMaXN0IiwicGF5bWVudCIsImRpY05hbWUiLCJwYXlUeXBlTGlzdCIsInBheVR5cGUiLCJmbG9vckxpc3QiLCJmbG9vciIsImN1c3RvbWVyTmFtZSIsImNvbW11bml0eU5hbWUiLCJjb21tdW5pdHlpZCIsIm1haW5iaWxsQ29tbXVuaXR5SWQiLCJjb25zb2xlIiwibG9nIiwibGVzc29yQ29udGFjdE5hbWUiLCJjb250cmFjdEZpbGVMaXN0IiwibGVhc2VJZCIsImNvbnRyYWN0Y29kZSIsImNvbnRyYWN0VmVyc2lvblR5cGUiLCJjb250cmFjdFZlcnNpb24iLCJsZXNzb3JDb250YWN0aWQiLCJwYXl0eXBlIiwicGF5bW9kZWwiLCJzdGF0aW9ubnVtIiwid2hlcmVmbG9vciIsInJlbnRhbHVzZSIsImNvbnRyYWN0bWFyayIsInRvdGFscmVudCIsInRvdGFsZGVwb3NpdCIsImxlc3NvckNvbnRhY3R0ZWwiLCJmaXJzdHBheWRhdGUiLCJsZWFzZUJlZ2luZGF0ZSIsImxlYXNlRW5kZGF0ZSIsInNldFN0YXRlIiwiY29udGV4dFR5cGVzIiwiUHJvcFR5cGVzIiwib2JqZWN0IiwiaXNSZXF1aXJlZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBSUE7O0FBTUE7O0FBSUE7Ozs7QUFFQTs7QUFTQTs7QUFDQTs7Ozs7Ozs7Ozs7O0lBR3FCQSxVOzs7QUFNcEIscUJBQVlDLEtBQVosRUFBbUJDLE9BQW5CLEVBQTRCO0FBQUE7O0FBQUEsdUhBQ3JCRCxLQURxQixFQUNkQyxPQURjOztBQUczQixTQUFLQyxjQUFMLEdBQXNCLE9BQUtBLGNBQUwsQ0FBb0JDLElBQXBCLFFBQXRCO0FBQ0EsU0FBS0MsUUFBTCxHQUFnQixPQUFLQSxRQUFMLENBQWNELElBQWQsUUFBaEI7O0FBRUEsU0FBS0UsS0FBTCxHQUFhO0FBQ1pDLGVBQVksRUFEQTtBQUVaQyxrQkFBZSxFQUZIO0FBR1pDLGlCQUFjLEVBSEY7QUFJWkMsZUFBWTtBQUpBLEdBQWI7O0FBT0EsZUFBTUMsUUFBTixDQUFlLHNCQUFNLG9CQUFOLENBQWY7QUFiMkI7QUFjM0I7Ozs7aUNBRWNELFUsRUFBWTtBQUMxQkEsZ0JBQWEsNEJBQWMsRUFBZCxFQUFrQkEsVUFBbEIsQ0FBYjtBQUQwQixPQUd6QkUsTUFIeUIsR0FJdEIsS0FBS1gsS0FKaUIsQ0FHekJXLE1BSHlCOztBQUsxQixnQkFBTUQsUUFBTixDQUFlLGVBQVFFLE9BQVIsQ0FBZ0IsMkJB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QU0wRCxRQUFOLENBQWU7QUFDZDdFLGtDQURjO0FBRWRDLGdDQUZjO0FBR2RGO0FBSGMsTUFBZjtBQU1BLEtBbERELEVBa0RHaUIsS0FsREgsQ0FrRFMsVUFBU0MsR0FBVCxFQUFjO0FBQ3RCLGtCQUFPVCxJQUFQLENBQVksQ0FBQztBQUNaQyxlQUFTLFlBREc7QUFFWkMsWUFBTTtBQUZNLE1BQUQsQ0FBWjtBQUlBLEtBdkREO0FBMERBLElBbkdELEVBbUdHTSxLQW5HSCxDQW1HUyxVQUFTQyxHQUFULEVBQWM7QUFDdEIsaUJBQU9ULElBQVAsQ0FBWSxDQUFDO0FBQ1pDLGNBQVMsWUFERztBQUVaQyxXQUFNO0FBRk0sS0FBRCxDQUFaO0FBSUEsSUF4R0Q7QUEwR0E7OzsyQkFHUTtBQUFBLGdCQU1KLEtBQUtaLEtBTkQ7QUFBQSxPQUdQRSxhQUhPLFVBR1BBLGFBSE87QUFBQSxPQUlQQyxZQUpPLFVBSVBBLFlBSk87QUFBQSxPQUtQRixVQUxPLFVBS1BBLFVBTE87OztBQVFSLFVBRUM7QUFBQTtBQUFBO0FBQ0EsaURBQU8sT0FBTSxxRUFBYixHQURBO0FBRUMsdURBQWEsVUFBVSxDQUFDLE1BQUQsRUFBUSxNQUFSLEVBQWUsT0FBZixDQUF2QixHQUZEO0FBR0E7QUFBQTtBQUFBLE9BQVMsT0FBTSxnQ0FBZixFQUF1QixhQUFZLEVBQW5DO0FBQ0UsOERBQWUsVUFBVSxLQUFLSixjQUE5QixFQUE4QyxlQUFlSyxhQUE3RCxFQUE0RSxVQUFVLEtBQUtILFFBQTNGLEVBQXFHLGNBQWNJLFlBQW5ILEVBQWlJLFlBQVlGLFVBQTdJO0FBREY7QUFIQSxJQUZEO0FBV0E7Ozs7OztBQTNMbUJQLFUsQ0FFYnNGLFksR0FBZTtBQUNyQjFFLFNBQVEsZ0JBQU0yRSxTQUFOLENBQWdCQyxNQUFoQixDQUF1QkM7QUFEVixDO2tCQUZGekYsVTs7Ozs7Ozs7K0JBQUFBLFUiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL3RtYWNfemMvQ29kZS9rci1hZG1pbiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge1xuXHRDb21wb25lbnQsXG5cdFByb3BUeXBlc1xufSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuXHRyZWR1eEZvcm0sXG5cdHN1Ym1pdEZvcm0sXG5cdGNoYW5nZSxcblx0cmVzZXRcbn0gZnJvbSAncmVkdXgtZm9ybSc7XG5pbXBvcnQge1xuXHRBY3Rpb25zLFxuXHRTdG9yZVxufSBmcm9tICdrci9SZWR1eCc7XG5pbXBvcnQgaHR0cCBmcm9tICdrci9SZWR1eC9VdGlscy9mZXRjaCc7XG5cbmltcG9ydCB7XG5cdERpYWxvZyxcblx0U2VjdGlvbixcblx0R3JpZCxcblx0Tm90aWZ5LFxuXHRCcmVhZENydW1icyxcblx0VGl0bGUsXG59IGZyb20gJ2tyLXVpJztcblxuaW1wb3J0ICcuL2luZGV4Lmxlc3MnO1xuaW1wb3J0IE5ld0NyZWF0ZUZvcm0gZnJvbSAnLi9OZXdDcmVhdGVGb3JtJztcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBKb2luQ3JlYXRlIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuXHRzdGF0aWMgY29udGV4dFR5cGVzID0ge1xuXHRcdHBhcmFtczogUmVhY3QuUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG5cdH1cblxuXHRjb25zdHJ1Y3Rvcihwcm9wcywgY29udGV4dCkge1xuXHRcdHN1cGVyKHByb3BzLCBjb250ZXh0KTtcblxuXHRcdHRoaXMub25DcmVhdGVTdWJtaXQgPSB0aGlzLm9uQ3JlYXRlU3VibWl0LmJpbmQodGhpcyk7XG5cdFx0dGhpcy5vbkNhbmNlbCA9IHRoaXMub25DYW5jZWwuYmluZCh0aGlzKTtcblxuXHRcdHRoaXMuc3RhdGUgPSB7XG5cdFx0XHRzdGF0aW9uVm9zOiBbXSxcblx0XHRcdGluaXRpYWxWYWx1ZXM6IHt9LFxuXHRcdFx0b3B0aW9uVmFsdWVzOiB7fSxcblx0XHRcdGZvcm1WYWx1ZXM6IHt9LFxuXHRcdH1cblxuXHRcdFN0b3JlLmRpc3BhdGNoKHJlc2V0KCdpbmNyZWFzZUNyZWF0ZUZvcm0nKSk7XG5cdH1cblxuXHRvbkNyZWF0ZVN1Ym1pdChmb3JtVmFsdWVzKSB7XG5cdFx0Zm9ybVZhbHVlcyA9IE9iamVjdC5hc3NpZ24oe30sIGZvcm1WYWx1ZXMpO1xuXHRcdGxldCB7XG5cdFx0XHRwYXJhbXNcblx0XHR9ID0gdGhpcy5wcm9wcztcblx0XHRTdG9yZS5kaXNwYXRjaChBY3Rpb25zLmNhbGxBUEkoJ2FkZE9yRWRpdEluY3JlYXNlQ29udHJhY3QnLCB7fSwgZm9ybVZhbHVlcykpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICfmm7TmlrDmiJDlip8nLFxuXHRcdFx0XHR0eXBlOiAnc3VjY2VzcycsXG5cdFx0XHR9XSk7XG5cdFx0XHRsb2NhdGlvbi5ocmVmID0gXCIuLyMvb3BlcmF0aW9uL2N1c3RvbWVyTWFuYWdlL1wiICsgcGFyYW1zLmN1c3RvbWVySWQgKyBcIi9vcmRlci9cIiArIHBhcmFtcy5vcmRlcklkICsgXCIvYWdyZWVtZW50L2luY3JlYXNlL1wiICsgcmVzcG9uc2UuY29udHJhY3RJZCArIFwiL2RldGFpbFwiO1xuXG5cdFx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiBlcnIubWVzc2FnZSxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cdFx0fSk7XG5cdH1cblxuXHRvbkNhbmNlbCgpIHtcblx0XHRsZXQge1xuXHRcdFx0cGFyYW1zXG5cdFx0fSA9IHRoaXMuY29udGV4dDtcblx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IGAuLyMvb3BlcmF0aW9uL2N1c3RvbWVyTWFuYWdlLyR7cGFyYW1zLmN1c3RvbWVySWR9L29yZGVyLyR7cGFyYW1zLm9yZGVySWR9L2RldGFpbGA7XG5cdH1cblxuXHRjb21wb25lbnREaWRNb3VudCgpIHtcblxuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0Y29uc3Qge1xuXHRcdFx0cGFyYW1zXG5cdFx0fSA9IHRoaXMucHJvcHM7XG5cdFx0bGV0IGluaXRpYWxWYWx1ZXMgPSB7fTtcblx0XHRsZXQgb3B0aW9uVmFsdWVzID0ge307XG5cdFx0bGV0IHN0YXRpb25Wb3MgPSBbXTtcblxuXHRcdFN0b3JlLmRpc3BhdGNoKEFjdGlvbnMuY2FsbEFQSSgnZmluYS1jb250cmFjdC1pbnRlbnRpb24nLCB7XG5cdFx0XHRjdXN0b21lcklkOiBwYXJhbXMuY3VzdG9tZXJJZCxcblx0XHRcdG1haW5CaWxsSWQ6IHBhcmFtcy5vcmRlcklkLFxuXHRcdFx0Y29tbXVuaXR5SWQ6IDFcblx0XHR9KSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXG5cdFx0XHRpbml0aWFsVmFsdWVzLmNvbnRyYWN0c3RhdGUgPSAnVU5TVEFSVCc7XG5cdFx0XHRpbml0aWFsVmFsdWVzLm1haW5iaWxsaWQgPSBwYXJhbXMub3JkZXJJZDtcblx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VDb250YWN0ID0gcmVzcG9uc2UuY3VzdG9tZXIuY3VzdG9tZXJNZW1iZXI7XG5cdFx0XHRpbml0aWFsVmFsdWVzLmxlYXNlQ29udGFjdHRlbCA9IHJlc3BvbnNlLmN1c3RvbWVyLmN1c3RvbWVyUGhvbmU7XG5cdFx0XHRpbml0aWFsVmFsdWVzLnNpZ25kYXRlID0gK25ldyBEYXRlKChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcblxuXHRcdFx0b3B0aW9uVmFsdWVzLmNvbW11bml0eUFkZHJlc3MgPSByZXNwb25zZS5jdXN0b21lci5jb21tdW5pdHlBZGRyZXNzO1xuXHRcdFx0b3B0aW9uVmFsdWVzLmxlYXNlQWRkcmVzcyA9IHJlc3BvbnNlLmN1c3RvbWVyLmN1c3RvbWVyQWRkcmVzcztcblx0XHRcdC8v5ZCI5ZCM57G75Yir77yM5p6a5Li+57G75Z6L77yIMTrmhI/lkJHkuaYsMjrlhaXkvY/ljY/orq4sMzrlop7np5/ljY/orq4sNC7nu63np5/ljY/orq4sNTrlh4/np5/ljY/orq4sNumAgOenn+WNj+iuru+8iVxuXHRcdFx0aW5pdGlhbFZhbHVlcy5jb250cmFjdHR5cGUgPSAnQUREUkVOVCc7XG5cblx0XHRcdG9wdGlvblZhbHVlcy5mbmFDb3Jwb3JhdGlvbkxpc3QgPSByZXNwb25zZS5mbmFDb3Jwb3JhdGlvbi5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdFx0aXRlbS52YWx1ZSA9IGl0ZW0uaWQ7XG5cdFx0XHRcdGl0ZW0ubGFiZWwgPSBpdGVtLmNvcnBvcmF0aW9uTmFtZTtcblx0XHRcdFx0cmV0dXJuIGl0ZW07XG5cdFx0XHR9KTtcblx0XHRcdG9wdGlvblZhbHVlcy5wYXltZW50TGlzdCA9IHJlc3BvbnNlLnBheW1lbnQubWFwKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0XHRcdGl0ZW0udmFsdWUgPSBpdGVtLmlkO1xuXHRcdFx0XHRpdGVtLmxhYmVsID0gaXRlbS5kaWNOYW1lO1xuXHRcdFx0XHRyZXR1cm4gaXRlbTtcblx0XHRcdH0pO1xuXHRcdFx0b3B0aW9uVmFsdWVzLnBheVR5cGVMaXN0ID0gcmVzcG9uc2UucGF5VHlwZS5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdFx0aXRlbS52YWx1ZSA9IGl0ZW0uaWQ7XG5cdFx0XHRcdGl0ZW0ubGFiZWwgPSBpdGVtLmRpY05hbWU7XG5cdFx0XHRcdHJldHVybiBpdGVtO1xuXHRcdFx0fSk7XG5cblx0XHRcdG9wdGlvblZhbHVlcy5mbG9vckxpc3QgPSByZXNwb25zZS5jdXN0b21lci5mbG9vcjtcblx0XHRcdG9wdGlvblZhbHVlcy5jdXN0b21lck5hbWUgPSByZXNwb25zZS5jdXN0b21lci5jdXN0b21lck5hbWU7XG5cdFx0XHRvcHRpb25WYWx1ZXMubGVhc2VBZGRyZXNzID0gcmVzcG9uc2UuY3VzdG9tZXIuY3VzdG9tZXJBZGRyZXNzO1xuXHRcdFx0b3B0aW9uVmFsdWVzLmNvbW11bml0eU5hbWUgPSByZXNwb25zZS5jdXN0b21lci5jb21tdW5pdHlOYW1lO1xuXHRcdFx0b3B0aW9uVmFsdWVzLmNvbW11bml0eUlkID0gcmVzcG9uc2UuY3VzdG9tZXIuY29tbXVuaXR5aWQ7XG5cdFx0XHRvcHRpb25WYWx1ZXMubWFpbmJpbGxDb21tdW5pdHlJZCA9IHJlc3BvbnNlLm1haW5iaWxsQ29tbXVuaXR5SWQgfHwgMTtcblxuXG5cdFx0XHRTdG9yZS5kaXNwYXRjaChBY3Rpb25zLmNhbGxBUEkoJ3Nob3ctY2hlY2tpbi1hZ3JlZW1lbnQnLCB7XG5cdFx0XHRcdGlkOiBwYXJhbXMuaWRcblx0XHRcdH0pKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdyZXNwb25zZScscmVzcG9uc2UpO1xuXG5cblx0XHRcdFx0b3B0aW9uVmFsdWVzLmxlc3NvckNvbnRhY3ROYW1lID0gcmVzcG9uc2UubGVzc29yQ29udGFjdE5hbWU7XG5cblx0XHRcdFx0b3B0aW9uVmFsdWVzLmNvbnRyYWN0RmlsZUxpc3QgPSByZXNwb25zZS5jb250cmFjdEZpbGVMaXN0O1xuXG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMuaWQgPSByZXNwb25zZS5pZDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZWFzZUlkID0gcmVzcG9uc2UubGVhc2VJZDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5jb250cmFjdGNvZGUgPSByZXNwb25zZS5jb250cmFjdGNvZGU7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMuY29udHJhY3RWZXJzaW9uVHlwZSA9IHJlc3BvbnNlLmNvbnRyYWN0VmVyc2lvbjtcblxuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmxlc3NvckNvbnRhY3RpZCA9IHJlc3BvbnNlLmxlc3NvckNvbnRhY3RpZDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZXNzb3JDb250YWN0TmFtZSA9IHJlc3BvbnNlLmxlc3NvckNvbnRhY3ROYW1lO1xuXG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VJZCA9IHJlc3BvbnNlLmxlYXNlSWQ7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VBZGRyZXNzID0gcmVzcG9uc2UubGVhc2VBZGRyZXNzO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmxlYXNlQ29udGFjdCA9IHJlc3BvbnNlLmxlYXNlQ29udGFjdDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZWFzZUNvbnRhY3R0ZWwgPSByZXNwb25zZS5sZWFzZUNvbnRhY3R0ZWw7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMucGF5dHlwZSA9IHJlc3BvbnNlLnBheVR5cGUuaWQ7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMucGF5bW9kZWwgPSByZXNwb25zZS5wYXltZW50LmlkO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLnN0YXRpb25udW0gPSByZXNwb25zZS5zdGF0aW9ubnVtO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLndoZXJlZmxvb3IgPSByZXNwb25zZS53aGVyZWZsb29yO1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLnJlbnRhbHVzZSA9IHJlc3BvbnNlLnJlbnRhbHVzZTtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5jb250cmFjdG1hcmsgPSByZXNwb25zZS5jb250cmFjdG1hcmsgfHwgJyc7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMudG90YWxyZW50ID0gcmVzcG9uc2UudG90YWxyZW50O1xuXHRcdFx0XHRpbml0aWFsVmFsdWVzLnRvdGFsZGVwb3NpdCA9IHJlc3BvbnNlLnRvdGFsZGVwb3NpdDtcblx0XHRcdFx0aW5pdGlhbFZhbHVlcy5sZXNzb3JDb250YWN0dGVsID0gcmVzcG9uc2UubGVzc29yQ29udGFjdHRlbDtcblxuXHRcdFx0XHQvL+aXtumXtFxuXHRcdFx0XHRpbml0aWFsVmFsdWVzLmZpcnN0cGF5ZGF0ZSA9IG5ldyBEYXRlKHJlc3BvbnNlLmZpcnN0cGF5ZGF0ZSk7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMuc2lnbmRhdGUgPSBuZXcgRGF0ZShyZXNwb25zZS5zaWduZGF0ZSk7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VCZWdpbmRhdGUgPSBuZXcgRGF0ZShyZXNwb25zZS5sZWFzZUJlZ2luZGF0ZSk7XG5cdFx0XHRcdGluaXRpYWxWYWx1ZXMubGVhc2VFbmRkYXRlID0gbmV3IERhdGUocmVzcG9uc2UubGVhc2VFbmRkYXRlKTtcblxuXHRcdFx0XHRjb25zb2xlLmxvZygn5pe26Ze0JywgaW5pdGlhbFZhbHVlcyk7XG5cblxuXHRcdFx0XHQvL+WkhOeQhnN0YXRpb252b3Ncblx0XHRcdFx0c3RhdGlvblZvcyA9IHJlc3BvbnNlLnN0YXRpb25Wb3M7XG5cblx0XHRcdFx0X3RoaXMuc2V0U3RhdGUoe1xuXHRcdFx0XHRcdGluaXRpYWxWYWx1ZXMsXG5cdFx0XHRcdFx0b3B0aW9uVmFsdWVzLFxuXHRcdFx0XHRcdHN0YXRpb25Wb3Ncblx0XHRcdFx0fSk7XG5cblx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXHRcdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRcdG1lc3NhZ2U6ICflkI7lj7Dlh7rplJnor7fogZTns7vnrqHnkIblkZgnLFxuXHRcdFx0XHRcdHR5cGU6ICdkYW5nZXInLFxuXHRcdFx0XHR9XSk7XG5cdFx0XHR9KTtcblxuXG5cdFx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiAn5ZCO5Y+w5Ye66ZSZ6K+36IGU57O7566h55CG5ZGYJyxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cdFx0fSk7XG5cblx0fVxuXG5cblx0cmVuZGVyKCkge1xuXG5cdFx0bGV0IHtcblx0XHRcdGluaXRpYWxWYWx1ZXMsXG5cdFx0XHRvcHRpb25WYWx1ZXMsXG5cdFx0XHRzdGF0aW9uVm9zXG5cdFx0fSA9IHRoaXMuc3RhdGU7XG5cblx0XHRyZXR1cm4gKFxuXG5cdFx0XHQ8ZGl2PlxuXHRcdFx0PFRpdGxlIHZhbHVlPVwi57yW6L6R5aKe56ef5Y2P6K6u5LmmX+i0ouWKoeeuoeeQhlwiLz5cblx0XHQgXHQ8QnJlYWRDcnVtYnMgY2hpbGRyZW49e1sn57O757uf6L+Q6JClJywn5a6i5oi3566h55CGJywn5aKe56ef5Y2P6K6u5LmmJ119Lz5cblx0XHRcdDxTZWN0aW9uIHRpdGxlPVwi5aKe56ef5Y2P6K6u5LmmXCIgZGVzY3JpcHRpb249XCJcIj5cblx0XHRcdFx0XHQ8TmV3Q3JlYXRlRm9ybSBvblN1Ym1pdD17dGhpcy5vbkNyZWF0ZVN1Ym1pdH0gaW5pdGlhbFZhbHVlcz17aW5pdGlhbFZhbHVlc30gb25DYW5jZWw9e3RoaXMub25DYW5jZWx9IG9wdGlvblZhbHVlcz17b3B0aW9uVmFsdWVzfSBzdGF0aW9uVm9zPXtzdGF0aW9uVm9zfS8+XG5cdFx0XHQ8L1NlY3Rpb24+XG5cblx0XHQ8L2Rpdj5cblx0XHQpO1xuXHR9XG59Il19