'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _simpleAssign = require('simple-assign');

var _simpleAssign2 = _interopRequireDefault(_simpleAssign);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactEventListener = require('react-event-listener');

var _reactEventListener2 = _interopRequireDefault(_reactEventListener);

var _keycode = require('keycode');

var _keycode2 = _interopRequireDefault(_keycode);

var _Calendar = require('./Calendar');

var _Calendar2 = _interopRequireDefault(_Calendar);

var _Dialog = require('../Dialog');

var _Dialog2 = _interopRequireDefault(_Dialog);

var _Popover = require('../Popover/Popover');

var _Popover2 = _interopRequireDefault(_Popover);

var _PopoverAnimationVertical = require('../Popover/PopoverAnimationVertical');

var _PopoverAnimationVertical2 = _interopRequireDefault(_PopoverAnimationVertical);

var _dateUtils = require('./dateUtils');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var DatePickerDialog = function (_Component) {
  _inherits(DatePickerDialog, _Component);

  function DatePickerDialog() {
    var _ref;

    var _temp, _this, _ret;

    _classCallCheck(this, DatePickerDialog);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = DatePickerDialog.__proto__ || Object.getPrototypeOf(DatePickerDialog)).call.apply(_ref, [this].concat(args))), _this), _this.state = {
      open: false
    }, _this.show = function () {
      if (_this.props.onShow && !_this.state.open) {
        _this.props.onShow();
      }

      _this.setState({
        open: true
      });
    }, _this.dismiss = function () {
      if (_this.props.onDismiss && _this.state.open) {
        _this.props.onDismiss();
      }

      _this.setState({
        open: false
      });
    }, _this.handleTouchTapDay = function () {
      if (_this.props.autoOk) {
        setTimeout(_this.handleTouchTapOk, 0);
      }
    }, _this.handleTouchTapCancel = function () {
      _this.dismiss();
    }, _this.handleRequestClose = function () {
      _this.dismiss();
    }, _this.handleTouchTapOk = function () {
      if (_this.props.onAccept && !_this.refs.calendar.isSelectedDateDisabled()) {

        _this.props.onAccept(_this.refs.calendar.getSelectedDate());
      }

      _this.setState({
        open: false
      });
    }, _this.handleWindowKeyUp = function (event) {
      switch ((0, _keycode2.default)(event)) {
        case 'enter':
          _this.handleTouchTapOk();
          break;
      }
    }, _temp), _possibleConstructorReturn(_this, _ret);
  }

  _createClass(DatePickerDialog, [{
    key: 'render',
    value: function render() {
      var _props = this.props,
          DateTimeFormat = _props.DateTimeFormat,
          autoOk = _props.autoOk,
          cancelLabel = _props.cancelLabel,
          container = _props.container,
          containerStyle = _props.containerStyle,
          disableYearSelection = _props.disableYearSelection,
          initialDate = _props.initialDate,
          firstDayOfWeek = _props.firstDayOfWeek,
          locale = _props.locale,
          maxDate = _props.maxDate,
          minDate = _props.minDate,
          mode = _props.mode,
          okLabel = _props.okLabel,
          onAccept = _props.onAccept,
          onDismiss = _props.onDismiss,
          onShow = _props.onShow,
          shouldDisableDate = _props.shouldDisableDate,
          style = _props.style,
          animation = _props.animation,
          other = _objectWithoutProperties(_props, ['DateTimeFormat', 'autoOk', 'cancelLabel', 'container', 'containerStyle', 'disableYearSelection', 'initialDate', 'firstDayOfWeek', 'locale', 'maxDate', 'minDate', 'mode', 'okLabel', 'onAccept', 'onDismiss', 'onShow', 'shouldDisableDate', 'style', 'animation']);

      var open = this.state.open;


      var styles = {
        dialogContent: {
          width: mode === 'landscape' ? 479 : 310
        },
        dialogBodyContent: {
          padding: 0,
          //minHeight: mode === 'landscape' ? 330 : 434,
          minHeight: mode === 'landscape' ? 330 : 310,
          minWidth: mode === 'landscape' ? 479 : 310
        }
      };

      var Container = container === 'inline' ? _Popover2.default : _Dialog2.default;

      return _react2.default.createElement(
        'div',
        _extends({}, other, { ref: 'root' }),
        _react2.default.createElement(
          Container,
          {
            anchorEl: this.refs.root // For Popover
            , animation: animation || _PopoverAnimationVertical2.default // For Popover
            , bodyStyle: styles.dialogBodyContent,
            contentStyle: styles.dialogContent,
            ref: 'dialog',
            repositionOnUpdate: true,
            open: open,
            onRequestClose: this.handleRequestClose,
            style: (0, _simpleAssign2.default)(styles.dialogBodyContent, containerStyle)
          },
          _react2.default.createElement(_reactEventListener2.default, {
            target: 'window',
            onKeyUp: this.handleWindowKeyUp
          }),
          _react2.default.createElement(_Calendar2.default, {
            autoOk: autoOk,
            DateTimeFormat: DateTimeFormat,
            cancelLabel: cancelLabel,
            disableYearSelection: disableYearSelection,
            firstDayOfWeek: firstDayOfWeek,
            initialDate: initialDate,
            locale: locale,
            onTouchTapDay: this.handleTouchTapDay,
            maxDate: maxDate,
            minDate: minDate,
            mode: mode,
            open: open,
            ref: 'calendar',
            onTouchTapCancel: this.handleTouchTapCancel,
            onTouchTapOk: this.handleTouchTapOk,
            okLabel: okLabel,
            shouldDisableDate: shouldDisableDate
          })
        )
      );
    }
  }]);

  return DatePickerDialog;
}(_react.Component);

DatePickerDialog.propTypes = {
  DateTimeFormat: _react.PropTypes.func,
  animation: _react.PropTypes.func,
  autoOk: _react.PropTypes.bool,
  cancelLabel: _react.PropTypes.node,
  container: _react.PropTypes.oneOf(['dialog', 'inline']),
  containerStyle: _react.PropTypes.object,
  disableYearSelection: _react.PropTypes.bool,
  firstDayOfWeek: _react.PropTypes.number,
  initialDate: _react.PropTypes.object,
  locale: _react.PropTypes.string,
  maxDate: _react.PropTypes.object,
  minDate: _react.PropTypes.object,
  mode: _react.PropTypes.oneOf(['portrait', 'landscape']),
  okLabel: _react.PropTypes.node,
  onAccept: _react.PropTypes.func,
  onDismiss: _react.PropTypes.func,
  onShow: _react.PropTypes.func,
  open: _react.PropTypes.bool,
  shouldDisableDate: _react.PropTypes.func,
  style: _react.PropTypes.object
};
DatePickerDialog.defaultProps = {
  DateTimeFormat: _dateUtils.dateTimeFormat,
  cancelLabel: 'Cancel',
  container: 'dialog',
  locale: 'en-US',
  okLabel: 'OK'
};
DatePickerDialog.contextTypes = {
  muiTheme: _react.PropTypes.object.isRequired
};
var _default = DatePickerDialog;
exports.default = _default;
;

var _temp2 = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(DatePickerDialog, 'DatePickerDialog', '/Users/liuyihao/Code/kr-admin/src/Components/DatePicker/DatePicker/DatePickerDialog.js');

  __REACT_HOT_LOADER__.register(_default, 'default', '/Users/liuyihao/Code/kr-admin/src/Components/DatePicker/DatePicker/DatePickerDialog.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db21wb25lbnRzL0RhdGVQaWNrZXIvRGF0ZVBpY2tlci9EYXRlUGlja2VyRGlhbG9nLmpzIl0sIm5hbWVzIjpbIkRhdGVQaWNrZXJEaWFsb2ciLCJzdGF0ZSIsIm9wZW4iLCJzaG93IiwicHJvcHMiLCJvblNob3ciLCJzZXRTdGF0ZSIsImRpc21pc3MiLCJvbkRpc21pc3MiLCJoYW5kbGVUb3VjaFRhcERheSIsImF1dG9PayIsInNldFRpbWVvdXQiLCJoYW5kbGVUb3VjaFRhcE9rIiwiaGFuZGxlVG91Y2hUYXBDYW5jZWwiLCJoYW5kbGVSZXF1ZXN0Q2xvc2UiLCJvbkFjY2VwdCIsInJlZnMiLCJjYWxlbmRhciIsImlzU2VsZWN0ZWREYXRlRGlzYWJsZWQiLCJnZXRTZWxlY3RlZERhdGUiLCJoYW5kbGVXaW5kb3dLZXlVcCIsImV2ZW50IiwiRGF0ZVRpbWVGb3JtYXQiLCJjYW5jZWxMYWJlbCIsImNvbnRhaW5lciIsImNvbnRhaW5lclN0eWxlIiwiZGlzYWJsZVllYXJTZWxlY3Rpb24iLCJpbml0aWFsRGF0ZSIsImZpcnN0RGF5T2ZXZWVrIiwibG9jYWxlIiwibWF4RGF0ZSIsIm1pbkRhdGUiLCJtb2RlIiwib2tMYWJlbCIsInNob3VsZERpc2FibGVEYXRlIiwic3R5bGUiLCJhbmltYXRpb24iLCJvdGhlciIsInN0eWxlcyIsImRpYWxvZ0NvbnRlbnQiLCJ3aWR0aCIsImRpYWxvZ0JvZHlDb250ZW50IiwicGFkZGluZyIsIm1pbkhlaWdodCIsIm1pbldpZHRoIiwiQ29udGFpbmVyIiwicm9vdCIsInByb3BUeXBlcyIsImZ1bmMiLCJib29sIiwibm9kZSIsIm9uZU9mIiwib2JqZWN0IiwibnVtYmVyIiwic3RyaW5nIiwiZGVmYXVsdFByb3BzIiwiY29udGV4dFR5cGVzIiwibXVpVGhlbWUiLCJpc1JlcXVpcmVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztB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dUMsSUFIRDtBQUlqQjFCLGVBQWEsaUJBQVUyQixJQUpOO0FBS2pCMUIsYUFBVyxpQkFBVTJCLEtBQVYsQ0FBZ0IsQ0FBQyxRQUFELEVBQVcsUUFBWCxDQUFoQixDQUxNO0FBTWpCMUIsa0JBQWdCLGlCQUFVMkIsTUFOVDtBQU9qQjFCLHdCQUFzQixpQkFBVXVCLElBUGY7QUFRakJyQixrQkFBZ0IsaUJBQVV5QixNQVJUO0FBU2pCMUIsZUFBYSxpQkFBVXlCLE1BVE47QUFVakJ2QixVQUFRLGlCQUFVeUIsTUFWRDtBQVdqQnhCLFdBQVMsaUJBQVVzQixNQVhGO0FBWWpCckIsV0FBUyxpQkFBVXFCLE1BWkY7QUFhakJwQixRQUFNLGlCQUFVbUIsS0FBVixDQUFnQixDQUFDLFVBQUQsRUFBYSxXQUFiLENBQWhCLENBYlc7QUFjakJsQixXQUFTLGlCQUFVaUIsSUFkRjtBQWVqQm5DLFlBQVUsaUJBQVVpQyxJQWZIO0FBZ0JqQnhDLGFBQVcsaUJBQVV3QyxJQWhCSjtBQWlCakIzQyxVQUFRLGlCQUFVMkMsSUFqQkQ7QUFrQmpCOUMsUUFBTSxpQkFBVStDLElBbEJDO0FBbUJqQmYscUJBQW1CLGlCQUFVYyxJQW5CWjtBQW9CakJiLFNBQU8saUJBQVVpQjtBQXBCQSxDO0FBRGZwRCxnQixDQXdCR3VELFksR0FBZTtBQUNwQmpDLDJDQURvQjtBQUVwQkMsZUFBYSxRQUZPO0FBR3BCQyxhQUFXLFFBSFM7QUFJcEJLLFVBQVEsT0FKWTtBQUtwQkksV0FBUztBQUxXLEM7QUF4QmxCakMsZ0IsQ0FnQ0d3RCxZLEdBQWU7QUFDcEJDLFlBQVUsaUJBQVVMLE1BQVYsQ0FBaUJNO0FBRFAsQztlQStJVDFELGdCOzs7Ozs7Ozs7Z0NBL0tUQSxnQiIsImZpbGUiOiJEYXRlUGlja2VyRGlhbG9nLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9saXV5aWhhby9Db2RlL2tyLWFkbWluIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBFdmVudExpc3RlbmVyIGZyb20gJ3JlYWN0LWV2ZW50LWxpc3RlbmVyJztcbmltcG9ydCBrZXljb2RlIGZyb20gJ2tleWNvZGUnO1xuaW1wb3J0IENhbGVuZGFyIGZyb20gJy4vQ2FsZW5kYXInO1xuaW1wb3J0IERpYWxvZyBmcm9tICcuLi9EaWFsb2cnO1xuaW1wb3J0IFBvcG92ZXIgZnJvbSAnLi4vUG9wb3Zlci9Qb3BvdmVyJztcbmltcG9ydCBQb3BvdmVyQW5pbWF0aW9uVmVydGljYWwgZnJvbSAnLi4vUG9wb3Zlci9Qb3BvdmVyQW5pbWF0aW9uVmVydGljYWwnO1xuaW1wb3J0IHtkYXRlVGltZUZvcm1hdH0gZnJvbSAnLi9kYXRlVXRpbHMnO1xuXG5jbGFzcyBEYXRlUGlja2VyRGlhbG9nIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICBEYXRlVGltZUZvcm1hdDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgYW5pbWF0aW9uOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBhdXRvT2s6IFByb3BUeXBlcy5ib29sLFxuICAgIGNhbmNlbExhYmVsOiBQcm9wVHlwZXMubm9kZSxcbiAgICBjb250YWluZXI6IFByb3BUeXBlcy5vbmVPZihbJ2RpYWxvZycsICdpbmxpbmUnXSksXG4gICAgY29udGFpbmVyU3R5bGU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgZGlzYWJsZVllYXJTZWxlY3Rpb246IFByb3BUeXBlcy5ib29sLFxuICAgIGZpcnN0RGF5T2ZXZWVrOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIGluaXRpYWxEYXRlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGxvY2FsZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBtYXhEYXRlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIG1pbkRhdGU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgbW9kZTogUHJvcFR5cGVzLm9uZU9mKFsncG9ydHJhaXQnLCAnbGFuZHNjYXBlJ10pLFxuICAgIG9rTGFiZWw6IFByb3BUeXBlcy5ub2RlLFxuICAgIG9uQWNjZXB0OiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvbkRpc21pc3M6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uU2hvdzogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gICAgc2hvdWxkRGlzYWJsZURhdGU6IFByb3BUeXBlcy5mdW5jLFxuICAgIHN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICB9O1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgRGF0ZVRpbWVGb3JtYXQ6IGRhdGVUaW1lRm9ybWF0LFxuICAgIGNhbmNlbExhYmVsOiAnQ2FuY2VsJyxcbiAgICBjb250YWluZXI6ICdkaWFsb2cnLFxuICAgIGxvY2FsZTogJ2VuLVVTJyxcbiAgICBva0xhYmVsOiAnT0snLFxuICB9O1xuXG4gIHN0YXRpYyBjb250ZXh0VHlwZXMgPSB7XG4gICAgbXVpVGhlbWU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgfTtcblxuICBzdGF0ZSA9IHtcbiAgICBvcGVuOiBmYWxzZSxcbiAgfTtcblxuICBzaG93ID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLm9uU2hvdyAmJiAhdGhpcy5zdGF0ZS5vcGVuKSB7XG4gICAgICB0aGlzLnByb3BzLm9uU2hvdygpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgb3BlbjogdHJ1ZSxcbiAgICB9KTtcbiAgfTtcblxuICBkaXNtaXNzID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLm9uRGlzbWlzcyAmJiB0aGlzLnN0YXRlLm9wZW4pIHtcbiAgICAgIHRoaXMucHJvcHMub25EaXNtaXNzKCk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBvcGVuOiBmYWxzZSxcbiAgICB9KTtcbiAgfTtcblxuICBoYW5kbGVUb3VjaFRhcERheSA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5wcm9wcy5hdXRvT2spIHtcbiAgICAgIHNldFRpbWVvdXQodGhpcy5oYW5kbGVUb3VjaFRhcE9rLCAwKTtcbiAgICB9XG4gIH07XG5cbiAgaGFuZGxlVG91Y2hUYXBDYW5jZWwgPSAoKSA9PiB7XG4gICAgdGhpcy5kaXNtaXNzKCk7XG4gIH07XG5cbiAgaGFuZGxlUmVxdWVzdENsb3NlID0gKCkgPT4ge1xuICAgIHRoaXMuZGlzbWlzcygpO1xuICB9O1xuXG4gIGhhbmRsZVRvdWNoVGFwT2sgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMub25BY2NlcHQgJiYgIXRoaXMucmVmcy5jYWxlbmRhci5pc1NlbGVjdGVkRGF0ZURpc2FibGVkKCkpIHtcblxuICAgICAgdGhpcy5wcm9wcy5vbkFjY2VwdCh0aGlzLnJlZnMuY2FsZW5kYXIuZ2V0U2VsZWN0ZWREYXRlKCkpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgb3BlbjogZmFsc2UsXG4gICAgfSk7XG4gIH07XG5cbiAgaGFuZGxlV2luZG93S2V5VXAgPSAoZXZlbnQpID0+IHtcbiAgICBzd2l0Y2ggKGtleWNvZGUoZXZlbnQpKSB7XG4gICAgICBjYXNlICdlbnRlcic6XG4gICAgICAgIHRoaXMuaGFuZGxlVG91Y2hUYXBPaygpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIERhdGVUaW1lRm9ybWF0LFxuICAgICAgYXV0b09rLFxuICAgICAgY2FuY2VsTGFiZWwsXG4gICAgICBjb250YWluZXIsXG4gICAgICBjb250YWluZXJTdHlsZSxcbiAgICAgIGRpc2FibGVZZWFyU2VsZWN0aW9uLFxuICAgICAgaW5pdGlhbERhdGUsXG4gICAgICBmaXJzdERheU9mV2VlayxcbiAgICAgIGxvY2FsZSxcbiAgICAgIG1heERhdGUsXG4gICAgICBtaW5EYXRlLFxuICAgICAgbW9kZSxcbiAgICAgIG9rTGFiZWwsXG4gICAgICBvbkFjY2VwdCwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgb25EaXNtaXNzLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgICBvblNob3csIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgIHNob3VsZERpc2FibGVEYXRlLFxuICAgICAgc3R5bGUsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgIGFuaW1hdGlvbixcbiAgICAgIC4uLm90aGVyXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBjb25zdCB7b3Blbn0gPSB0aGlzLnN0YXRlO1xuXG4gICAgY29uc3Qgc3R5bGVzID0ge1xuICAgICAgZGlhbG9nQ29udGVudDoge1xuICAgICAgICB3aWR0aDogbW9kZSA9PT0gJ2xhbmRzY2FwZScgPyA0NzkgOiAzMTAsXG4gICAgICB9LFxuICAgICAgZGlhbG9nQm9keUNvbnRlbnQ6IHtcbiAgICAgICAgcGFkZGluZzogMCxcbiAgICAgICAgLy9taW5IZWlnaHQ6IG1vZGUgPT09ICdsYW5kc2NhcGUnID8gMzMwIDogNDM0LFxuICAgICAgICBtaW5IZWlnaHQ6IG1vZGUgPT09ICdsYW5kc2NhcGUnID8gMzMwIDogMzEwLFxuICAgICAgICBtaW5XaWR0aDogbW9kZSA9PT0gJ2xhbmRzY2FwZScgPyA0NzkgOiAzMTAsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdCBDb250YWluZXIgPSAoY29udGFpbmVyID09PSAnaW5saW5lJyA/IFBvcG92ZXIgOiBEaWFsb2cpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgey4uLm90aGVyfSByZWY9XCJyb290XCI+XG4gICAgICAgIDxDb250YWluZXJcbiAgICAgICAgICBhbmNob3JFbD17dGhpcy5yZWZzLnJvb3R9IC8vIEZvciBQb3BvdmVyXG4gICAgICAgICAgYW5pbWF0aW9uPXthbmltYXRpb24gfHwgUG9wb3ZlckFuaW1hdGlvblZlcnRpY2FsfSAvLyBGb3IgUG9wb3ZlclxuICAgICAgICAgIGJvZHlTdHlsZT17c3R5bGVzLmRpYWxvZ0JvZHlDb250ZW50fVxuICAgICAgICAgIGNvbnRlbnRTdHlsZT17c3R5bGVzLmRpYWxvZ0NvbnRlbnR9XG4gICAgICAgICAgcmVmPVwiZGlhbG9nXCJcbiAgICAgICAgICByZXBvc2l0aW9uT25VcGRhdGU9e3RydWV9XG4gICAgICAgICAgb3Blbj17b3Blbn1cbiAgICAgICAgICBvblJlcXVlc3RDbG9zZT17dGhpcy5oYW5kbGVSZXF1ZXN0Q2xvc2V9XG4gICAgICAgICAgc3R5bGU9e09iamVjdC5hc3NpZ24oc3R5bGVzLmRpYWxvZ0JvZHlDb250ZW50LCBjb250YWluZXJTdHlsZSl9XG4gICAgICAgID5cbiAgICAgICAgICA8RXZlbnRMaXN0ZW5lclxuICAgICAgICAgICAgdGFyZ2V0PVwid2luZG93XCJcbiAgICAgICAgICAgIG9uS2V5VXA9e3RoaXMuaGFuZGxlV2luZG93S2V5VXB9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8Q2FsZW5kYXJcbiAgICAgICAgICAgIGF1dG9Paz17YXV0b09rfVxuICAgICAgICAgICAgRGF0ZVRpbWVGb3JtYXQ9e0RhdGVUaW1lRm9ybWF0fVxuICAgICAgICAgICAgY2FuY2VsTGFiZWw9e2NhbmNlbExhYmVsfVxuICAgICAgICAgICAgZGlzYWJsZVllYXJTZWxlY3Rpb249e2Rpc2FibGVZZWFyU2VsZWN0aW9ufVxuICAgICAgICAgICAgZmlyc3REYXlPZldlZWs9e2ZpcnN0RGF5T2ZXZWVrfVxuICAgICAgICAgICAgaW5pdGlhbERhdGU9e2luaXRpYWxEYXRlfVxuICAgICAgICAgICAgbG9jYWxlPXtsb2NhbGV9XG4gICAgICAgICAgICBvblRvdWNoVGFwRGF5PXt0aGlzLmhhbmRsZVRvdWNoVGFwRGF5fVxuICAgICAgICAgICAgbWF4RGF0ZT17bWF4RGF0ZX1cbiAgICAgICAgICAgIG1pbkRhdGU9e21pbkRhdGV9XG4gICAgICAgICAgICBtb2RlPXttb2RlfVxuICAgICAgICAgICAgb3Blbj17b3Blbn1cbiAgICAgICAgICAgIHJlZj1cImNhbGVuZGFyXCJcbiAgICAgICAgICAgIG9uVG91Y2hUYXBDYW5jZWw9e3RoaXMuaGFuZGxlVG91Y2hUYXBDYW5jZWx9XG4gICAgICAgICAgICBvblRvdWNoVGFwT2s9e3RoaXMuaGFuZGxlVG91Y2hUYXBPa31cbiAgICAgICAgICAgIG9rTGFiZWw9e29rTGFiZWx9XG4gICAgICAgICAgICBzaG91bGREaXNhYmxlRGF0ZT17c2hvdWxkRGlzYWJsZURhdGV9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9Db250YWluZXI+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IERhdGVQaWNrZXJEaWFsb2c7XG4iXX0=