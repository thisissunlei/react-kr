'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reduxForm = require('redux-form');

var _Redux = require('kr/Redux');

var _fetch = require('kr/Redux/Utils/fetch');

var _fetch2 = _interopRequireDefault(_fetch);

var _krUi = require('kr-ui');

var _NewCreateForm = require('./NewCreateForm');

var _NewCreateForm2 = _interopRequireDefault(_NewCreateForm);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var EditCreate = function (_Component) {
  _inherits(EditCreate, _Component);

  function EditCreate(props, context) {
    _classCallCheck(this, EditCreate);

    var _this2 = _possibleConstructorReturn(this, (EditCreate.__proto__ || Object.getPrototypeOf(EditCreate)).call(this, props, context));

    _this2.onCreateSubmit = _this2.onCreateSubmit.bind(_this2);
    _this2.onCancel = _this2.onCancel.bind(_this2);

    _this2.state = {
      stationVos: [],
      initialValues: {},
      optionValues: {},
      formValues: {},
      openConfirmCreate: false
    };

    _Redux.Store.dispatch((0, _reduxForm.reset)('exitEditForm'));
    return _this2;
  }

  _createClass(EditCreate, [{
    key: 'onCreateSubmit',
    value: function onCreateSubmit(formValues) {
      var params = this.props.params;

      _Redux.Store.dispatch(_Redux.Actions.callAPI('addFnaContractWithdrawal', {}, formValues)).then(function (response) {
        _krUi.Notify.show([{
          message: '编辑成功',
          type: 'success'
        }]);
        location.href = "./#/operation/customerManage/" + params.customerId + "/order/" + params.orderId + "/agreement/exit/" + response.contractId + "/detail";
      }).catch(function (err) {
        _krUi.Notify.show([{
          message: err.message,
          type: 'danger'
        }]);
      });
    }
  }, {
    key: 'onCancel',
    value: function onCancel() {
      window.history.back();
    }
  }, {
    key: 'componentDidMount',
    value: function componentDidMount() {

      var _this = this;
      var params = this.props.params;

      var initialValues = {};
      var optionValues = {};
      var stationVos = [];

      _Redux.Store.dispatch(_Redux.Actions.callAPI('fina-contract-intention', {
        customerId: params.customerId,
        mainBillId: params.orderId
      })).then(function (response) {

        //initialValues.ContractStateType = 'EXECUTE';

        initialValues.mainbillid = params.orderId;

        initialValues.leaseBegindate = new Date();
        initialValues.leaseEnddate = new Date();

        optionValues.communityAddress = response.customer.communityAddress;
        optionValues.leaseAddress = response.customer.customerAddress;
        //合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）
        initialValues.contracttype = 'QUITRENT';

        optionValues.fnaCorporationList = response.fnaCorporation.map(function (item, index) {
          item.value = item.id;
          item.label = item.corporationName;
          return item;
        });
        optionValues.paymentList = response.payment.map(function (item, index) {
          item.value = item.id;
          item.label = item.dicName;
          return item;
        });
        optionValues.payTypeList = response.payType.map(function (item, index) {
          item.value = item.id;
          item.label = item.dicName;
          return item;
        });

        optionValues.floorList = response.customer.floor;
        optionValues.customerName = response.customer.customerName;
        optionValues.leaseAddress = response.customer.customerAddress;
        optionValues.communityName = response.customer.communityName;
        optionValues.communityId = response.customer.communityid;
        optionValues.mainbillCommunityId = response.mainbillCommunityId || 1;

        _Redux.Store.dispatch(_Redux.Actions.callAPI('getFnaContractWithdrawalById', {
          id: params.id
        })).then(function (response) {

          optionValues.contractFileList = response.contractFileList;
          optionValues.lessorContactName = response.lessorContactName;

          initialValues.id = response.id;
          initialValues.contractstate = response.contractstate;
          initialValues.leaseId = response.leaseId;
          initialValues.contractcode = response.contractcode;
          initialValues.leaseAddress = response.leaseAddress;
          initialValues.lessorContactName = response.lessorContactName;
          initialValues.leaseContact = response.leaseContact;
          initialValues.lessorContacttel = response.lessorContacttel;
          initialValues.leaseContacttel = response.leaseContacttel;
          initialValues.contractVersionType = response.contractVersion;
          if (response.payType) {
            initialValues.paytype = response.payType.id;
          }
          if (response.payment) {
            initialValues.paymodel = response.payment.id;
          }
          initialValues.stationnum = response.stationnum;
          initialValues.wherefloor = response.wherefloor;
          initialValues.rentaluse = response.rentaluse;
          initialValues.contractmark = response.contractmark;
          initialValues.totalrent = response.totalrent;
          initialValues.totaldeposit = response.totaldeposit;
          initialValues.lessorContactid = response.lessorContactid;
          initialValues.depositamount = response.depositamount;
          initialValues.totalreturn = response.totalreturn;
          //时间

          initialValues.signdate = new Date(response.signdate);
          initialValues.leaseBegindate = new Date(response.leaseBegindate);
          initialValues.leaseEnddate = new Date(response.leaseEnddate);
          initialValues.withdrawdate = response.withdrawdate;

          //处理stationvos
          stationVos = response.stationVos;

          _this.setState({
            initialValues: initialValues,
            optionValues: optionValues,
            stationVos: stationVos
          });
        }).catch(function (err) {
          _krUi.Notify.show([{
            message: '后台出错请联系管理员',
            type: 'danger'
          }]);
        });
      }).catch(function (err) {
        _krUi.Notify.show([{
          message: '后台出错请联系管理员',
          type: 'danger'
        }]);
      });
    }
  }, {
    key: 'render',
    value: function render() {
      var _state = this.state,
          initialValues = _state.initialValues,
          optionValues = _state.optionValues,
          stationVos = _state.stationVos;

      console.log('stationVos', stationVos);
      return _react2.default.createElement(
        'div',
        null,
        _react2.default.createElement(_krUi.Title, { value: '\u7F16\u8F91\u9000\u79DF\u534F\u8BAE\u4E66_\u8D22\u52A1\u7BA1\u7406' }),
        _react2.default.createElement(_krUi.BreadCrumbs, { children: ['系统运营', '客户管理', '退租协议'] }),
        _react2.default.createElement(
          _krUi.Section,
          { title: '\u9000\u79DF\u534F\u8BAE\u4E66', description: '' },
          _react2.default.createElement(_NewCreateForm2.default, { onSubmit: this.onCreateSubmit, initialValues: initialValues, onCancel: this.onCancel, optionValues: optionValues, stationVos: stationVos })
        )
      );
    }
  }]);

  return EditCreate;
}(_react.Component);

exports.default = EditCreate;
;

var _temp = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(EditCreate, 'EditCreate', '/Users/liuyihao/Code/kr-admin/src/PureComponents/Agreement/Exit/Edit/index.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9QdXJlQ29tcG9uZW50cy9BZ3JlZW1lbnQvRXhpdC9FZGl0L2luZGV4LmpzIl0sIm5hbWVzIjpbIkVkaXRDcmVhdGUiLCJwcm9wcyIsImNvbnRleHQiLCJvbkNyZWF0ZVN1Ym1pdCIsImJpbmQiLCJvbkNhbmNlbCIsInN0YXRlIiwic3RhdGlvblZvcyIsImluaXRpYWxWYWx1ZXMiLCJvcHRpb25WYWx1ZXMiLCJmb3JtVmFsdWVzIiwib3BlbkNvbmZpcm1DcmVhdGUiLCJkaXNwYXRjaCIsInBhcmFtcyIsImNhbGxBUEkiLCJ0aGVuIiwicmVzcG9uc2UiLCJzaG93IiwibWVzc2FnZSIsInR5cGUiLCJsb2NhdGlvbiIsImhyZWYiLCJjdXN0b21lcklkIiwib3JkZXJJZCIsImNvbnRyYWN0SWQiLCJjYXRjaCIsImVyciIsIndpbmRvdyIsImhpc3RvcnkiLCJiYWNrIiwiX3RoaXMiLCJtYWluQmlsbElkIiwibWFpbmJpbGxpZCIsImxlYXNlQmVnaW5kYXRlIiwiRGF0ZSIsImxlYXNlRW5kZGF0ZSIsImNvbW11bml0eUFkZHJlc3MiLCJjdXN0b21lciIsImxlYXNlQWRkcmVzcyIsImN1c3RvbWVyQWRkcmVzcyIsImNvbnRyYWN0dHlwZSIsImZuYUNvcnBvcmF0aW9uTGlzdCIsImZuYUNvcnBvcmF0aW9uIiwibWFwIiwiaXRlbSIsImluZGV4IiwidmFsdWUiLCJpZCIsImxhYmVsIiwiY29ycG9yYXRpb25OYW1lIiwicGF5bWVudExpc3QiLCJwYXltZW50IiwiZGljTmFtZSIsInBheVR5cGVMaXN0IiwicGF5VHlwZSIsImZsb29yTGlzdCIsImZsb29yIiwiY3VzdG9tZXJOYW1lIiwiY29tbXVuaXR5TmFtZSIsImNvbW11bml0eUlkIiwiY29tbXVuaXR5aWQiLCJtYWluYmlsbENvbW11bml0eUlkIiwiY29udHJhY3RGaWxlTGlzdCIsImxlc3NvckNvbnRhY3ROYW1lIiwiY29udHJhY3RzdGF0ZSIsImxlYXNlSWQiLCJjb250cmFjdGNvZGUiLCJsZWFzZUNvbnRhY3QiLCJsZXNzb3JDb250YWN0dGVsIiwibGVhc2VDb250YWN0dGVsIiwiY29udHJhY3RWZXJzaW9uVHlwZSIsImNvbnRyYWN0VmVyc2lvbiIsInBheXR5cGUiLCJwYXltb2RlbCIsInN0YXRpb25udW0iLCJ3aGVyZWZsb29yIiwicmVudGFsdXNlIiwiY29udHJhY3RtYXJrIiwidG90YWxyZW50IiwidG90YWxkZXBvc2l0IiwibGVzc29yQ29udGFjdGlkIiwiZGVwb3NpdGFtb3VudCIsInRvdGFscmV0dXJuIiwic2lnbmRhdGUiLCJ3aXRoZHJhd2RhdGUiLCJzZXRTdGF0ZSIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOzs7O0FBSUE7O0FBTUE7O0FBSUE7Ozs7QUFFQTs7QUFTQTs7Ozs7Ozs7Ozs7O0lBR3FCQSxVOzs7QUFFbkIsc0JBQVlDLEtBQVosRUFBbUJDLE9BQW5CLEVBQTRCO0FBQUE7O0FBQUEseUhBQ3BCRCxLQURvQixFQUNiQyxPQURhOztBQUcxQixXQUFLQyxjQUFMLEdBQXNCLE9BQUtBLGNBQUwsQ0FBb0JDLElBQXBCLFFBQXRCO0FBQ0EsV0FBS0MsUUFBTCxHQUFnQixPQUFLQSxRQUFMLENBQWNELElBQWQsUUFBaEI7O0FBRUEsV0FBS0UsS0FBTCxHQUFhO0FBQ1hDLGtCQUFZLEVBREQ7QUFFWEMscUJBQWUsRUFGSjtBQUdYQyxvQkFBYyxFQUhIO0FBSVhDLGtCQUFZLEVBSkQ7QUFLWEMseUJBQW1CO0FBTFIsS0FBYjs7QUFRQSxpQkFBTUMsUUFBTixDQUFlLHNCQUFNLGNBQU4sQ0FBZjtBQWQwQjtBQWUzQjs7OzttQ0FFY0YsVSxFQUFZO0FBQUEsVUFDbEJHLE1BRGtCLEdBQ1IsS0FBS1osS0FERyxDQUNsQlksTUFEa0I7O0FBRXpCLG1CQUFNRCxRQUFOLENBQWUsZUFBUUUsT0FBUixDQUFnQiwwQkFBaEIsRUFBNEMsRUFBNUMsRUFBZ0RKLFVBQWhELENBQWYsRUFBNEVLLElBQTVFLENBQWlGLFVBQVNDLFFBQVQsRUFBbUI7QUFDbEcscUJBQU9DLElB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RCxPQTFHRDtBQTRHRDs7OzZCQUdRO0FBQUEsbUJBTUgsS0FBS2IsS0FORjtBQUFBLFVBR0xFLGFBSEssVUFHTEEsYUFISztBQUFBLFVBSUxDLFlBSkssVUFJTEEsWUFKSztBQUFBLFVBS0xGLFVBTEssVUFLTEEsVUFMSzs7QUFPUCtFLGNBQVFDLEdBQVIsQ0FBWSxZQUFaLEVBQTBCaEYsVUFBMUI7QUFDQSxhQUVFO0FBQUE7QUFBQTtBQUNBLHFEQUFPLE9BQU0scUVBQWIsR0FEQTtBQUVBLDJEQUFhLFVBQVUsQ0FBQyxNQUFELEVBQVEsTUFBUixFQUFlLE1BQWYsQ0FBdkIsR0FGQTtBQUdBO0FBQUE7QUFBQSxZQUFTLE9BQU0sZ0NBQWYsRUFBdUIsYUFBWSxFQUFuQztBQUNJLG1FQUFlLFVBQVUsS0FBS0osY0FBOUIsRUFBOEMsZUFBZUssYUFBN0QsRUFBNEUsVUFBVSxLQUFLSCxRQUEzRixFQUFxRyxjQUFjSSxZQUFuSCxFQUFpSSxZQUFZRixVQUE3STtBQURKO0FBSEEsT0FGRjtBQVVEOzs7Ozs7a0JBbkxrQlAsVTs7Ozs7Ozs7Z0NBQUFBLFUiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2xpdXlpaGFvL0NvZGUva3ItYWRtaW4iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtcbiAgQ29tcG9uZW50LFxuICBQcm9wVHlwZXNcbn0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgcmVkdXhGb3JtLFxuICBzdWJtaXRGb3JtLFxuICBjaGFuZ2UsXG4gIHJlc2V0XG59IGZyb20gJ3JlZHV4LWZvcm0nO1xuaW1wb3J0IHtcbiAgQWN0aW9ucyxcbiAgU3RvcmVcbn0gZnJvbSAna3IvUmVkdXgnO1xuaW1wb3J0IGh0dHAgZnJvbSAna3IvUmVkdXgvVXRpbHMvZmV0Y2gnO1xuXG5pbXBvcnQge1xuICBEaWFsb2csXG4gIFNlY3Rpb24sXG4gIEdyaWQsXG4gIE5vdGlmeSxcbiAgQnJlYWRDcnVtYnMsXG4gIFRpdGxlLFxufSBmcm9tICdrci11aSc7XG5cbmltcG9ydCBOZXdDcmVhdGVGb3JtIGZyb20gJy4vTmV3Q3JlYXRlRm9ybSc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRWRpdENyZWF0ZSBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgY29uc3RydWN0b3IocHJvcHMsIGNvbnRleHQpIHtcbiAgICBzdXBlcihwcm9wcywgY29udGV4dCk7XG5cbiAgICB0aGlzLm9uQ3JlYXRlU3VibWl0ID0gdGhpcy5vbkNyZWF0ZVN1Ym1pdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DYW5jZWwgPSB0aGlzLm9uQ2FuY2VsLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgc3RhdGlvblZvczogW10sXG4gICAgICBpbml0aWFsVmFsdWVzOiB7fSxcbiAgICAgIG9wdGlvblZhbHVlczoge30sXG4gICAgICBmb3JtVmFsdWVzOiB7fSxcbiAgICAgIG9wZW5Db25maXJtQ3JlYXRlOiBmYWxzZVxuICAgIH1cblxuICAgIFN0b3JlLmRpc3BhdGNoKHJlc2V0KCdleGl0RWRpdEZvcm0nKSk7XG4gIH1cblxuICBvbkNyZWF0ZVN1Ym1pdChmb3JtVmFsdWVzKSB7XG4gICAgY29uc3Qge3BhcmFtc30gPSB0aGlzLnByb3BzO1xuICAgIFN0b3JlLmRpc3BhdGNoKEFjdGlvbnMuY2FsbEFQSSgnYWRkRm5hQ29udHJhY3RXaXRoZHJhd2FsJywge30sIGZvcm1WYWx1ZXMpKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICBOb3RpZnkuc2hvdyhbe1xuICAgICAgICBtZXNzYWdlOiAn57yW6L6R5oiQ5YqfJyxcbiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgfV0pO1xuICAgICAgbG9jYXRpb24uaHJlZiA9IFwiLi8jL29wZXJhdGlvbi9jdXN0b21lck1hbmFnZS9cIiArIHBhcmFtcy5jdXN0b21lcklkICsgXCIvb3JkZXIvXCIgKyBwYXJhbXMub3JkZXJJZCArIFwiL2FncmVlbWVudC9leGl0L1wiICsgcmVzcG9uc2UuY29udHJhY3RJZCArIFwiL2RldGFpbFwiO1xuXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICBOb3RpZnkuc2hvdyhbe1xuICAgICAgICBtZXNzYWdlOiBlcnIubWVzc2FnZSxcbiAgICAgICAgdHlwZTogJ2RhbmdlcicsXG4gICAgICB9XSk7XG4gICAgfSk7XG4gIH1cblxuICBvbkNhbmNlbCgpIHtcbiAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKCk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcblxuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgY29uc3Qge1xuICAgICAgcGFyYW1zXG4gICAgfSA9IHRoaXMucHJvcHM7XG4gICAgbGV0IGluaXRpYWxWYWx1ZXMgPSB7fTtcbiAgICBsZXQgb3B0aW9uVmFsdWVzID0ge307XG4gICAgbGV0IHN0YXRpb25Wb3MgPSBbXTtcblxuICAgIFN0b3JlLmRpc3BhdGNoKEFjdGlvbnMuY2FsbEFQSSgnZmluYS1jb250cmFjdC1pbnRlbnRpb24nLCB7XG4gICAgICBjdXN0b21lcklkOiBwYXJhbXMuY3VzdG9tZXJJZCxcbiAgICAgIG1haW5CaWxsSWQ6IHBhcmFtcy5vcmRlcklkLFxuICAgIH0pKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cbiAgICAgIC8vaW5pdGlhbFZhbHVlcy5Db250cmFjdFN0YXRlVHlwZSA9ICdFWEVDVVRFJztcblxuICAgICAgaW5pdGlhbFZhbHVlcy5tYWluYmlsbGlkID0gcGFyYW1zLm9yZGVySWQ7XG5cbiAgICAgIGluaXRpYWxWYWx1ZXMubGVhc2VCZWdpbmRhdGUgPSBuZXcgRGF0ZTtcbiAgICAgIGluaXRpYWxWYWx1ZXMubGVhc2VFbmRkYXRlID0gbmV3IERhdGU7XG5cblxuICAgICAgb3B0aW9uVmFsdWVzLmNvbW11bml0eUFkZHJlc3MgPSByZXNwb25zZS5jdXN0b21lci5jb21tdW5pdHlBZGRyZXNzO1xuICAgICAgb3B0aW9uVmFsdWVzLmxlYXNlQWRkcmVzcyA9IHJlc3BvbnNlLmN1c3RvbWVyLmN1c3RvbWVyQWRkcmVzcztcbiAgICAgIC8v5ZCI5ZCM57G75Yir77yM5p6a5Li+57G75Z6L77yIMTrmhI/lkJHkuaYsMjrlhaXkvY/ljY/orq4sMzrlop7np5/ljY/orq4sNC7nu63np5/ljY/orq4sNTrlh4/np5/ljY/orq4sNumAgOenn+WNj+iuru+8iVxuICAgICAgaW5pdGlhbFZhbHVlcy5jb250cmFjdHR5cGUgPSAnUVVJVFJFTlQnO1xuXG4gICAgICBvcHRpb25WYWx1ZXMuZm5hQ29ycG9yYXRpb25MaXN0ID0gcmVzcG9uc2UuZm5hQ29ycG9yYXRpb24ubWFwKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGl0ZW0udmFsdWUgPSBpdGVtLmlkO1xuICAgICAgICBpdGVtLmxhYmVsID0gaXRlbS5jb3Jwb3JhdGlvbk5hbWU7XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgfSk7XG4gICAgICBvcHRpb25WYWx1ZXMucGF5bWVudExpc3QgPSByZXNwb25zZS5wYXltZW50Lm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICBpdGVtLnZhbHVlID0gaXRlbS5pZDtcbiAgICAgICAgaXRlbS5sYWJlbCA9IGl0ZW0uZGljTmFtZTtcbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICB9KTtcbiAgICAgIG9wdGlvblZhbHVlcy5wYXlUeXBlTGlzdCA9IHJlc3BvbnNlLnBheVR5cGUubWFwKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGl0ZW0udmFsdWUgPSBpdGVtLmlkO1xuICAgICAgICBpdGVtLmxhYmVsID0gaXRlbS5kaWNOYW1lO1xuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgIH0pO1xuXG4gICAgICBvcHRpb25WYWx1ZXMuZmxvb3JMaXN0ID0gcmVzcG9uc2UuY3VzdG9tZXIuZmxvb3I7XG4gICAgICBvcHRpb25WYWx1ZXMuY3VzdG9tZXJOYW1lID0gcmVzcG9uc2UuY3VzdG9tZXIuY3VzdG9tZXJOYW1lO1xuICAgICAgb3B0aW9uVmFsdWVzLmxlYXNlQWRkcmVzcyA9IHJlc3BvbnNlLmN1c3RvbWVyLmN1c3RvbWVyQWRkcmVzcztcbiAgICAgIG9wdGlvblZhbHVlcy5jb21tdW5pdHlOYW1lID0gcmVzcG9uc2UuY3VzdG9tZXIuY29tbXVuaXR5TmFtZTtcbiAgICAgIG9wdGlvblZhbHVlcy5jb21tdW5pdHlJZCA9IHJlc3BvbnNlLmN1c3RvbWVyLmNvbW11bml0eWlkO1xuICAgICAgb3B0aW9uVmFsdWVzLm1haW5iaWxsQ29tbXVuaXR5SWQgPSByZXNwb25zZS5tYWluYmlsbENvbW11bml0eUlkIHx8IDE7XG5cbiAgICAgIFN0b3JlLmRpc3BhdGNoKEFjdGlvbnMuY2FsbEFQSSgnZ2V0Rm5hQ29udHJhY3RXaXRoZHJhd2FsQnlJZCcsIHtcbiAgICAgICAgaWQ6IHBhcmFtcy5pZFxuICAgICAgfSkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuICAgICAgICBvcHRpb25WYWx1ZXMuY29udHJhY3RGaWxlTGlzdCA9IHJlc3BvbnNlLmNvbnRyYWN0RmlsZUxpc3Q7XG4gICAgICAgIG9wdGlvblZhbHVlcy5sZXNzb3JDb250YWN0TmFtZSA9IHJlc3BvbnNlLmxlc3NvckNvbnRhY3ROYW1lO1xuXG4gICAgICAgIGluaXRpYWxWYWx1ZXMuaWQgPSByZXNwb25zZS5pZDtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5jb250cmFjdHN0YXRlID0gcmVzcG9uc2UuY29udHJhY3RzdGF0ZTtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5sZWFzZUlkID0gcmVzcG9uc2UubGVhc2VJZDtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5jb250cmFjdGNvZGUgPSByZXNwb25zZS5jb250cmFjdGNvZGU7XG4gICAgICAgIGluaXRpYWxWYWx1ZXMubGVhc2VBZGRyZXNzID0gcmVzcG9uc2UubGVhc2VBZGRyZXNzO1xuICAgICAgICBpbml0aWFsVmFsdWVzLmxlc3NvckNvbnRhY3ROYW1lID0gcmVzcG9uc2UubGVzc29yQ29udGFjdE5hbWU7XG4gICAgICAgIGluaXRpYWxWYWx1ZXMubGVhc2VDb250YWN0ID0gcmVzcG9uc2UubGVhc2VDb250YWN0O1xuICAgICAgICBpbml0aWFsVmFsdWVzLmxlc3NvckNvbnRhY3R0ZWwgPSByZXNwb25zZS5sZXNzb3JDb250YWN0dGVsO1xuICAgICAgICBpbml0aWFsVmFsdWVzLmxlYXNlQ29udGFjdHRlbCA9IHJlc3BvbnNlLmxlYXNlQ29udGFjdHRlbDtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5jb250cmFjdFZlcnNpb25UeXBlID0gcmVzcG9uc2UuY29udHJhY3RWZXJzaW9uO1xuICAgICAgICBpZiAocmVzcG9uc2UucGF5VHlwZSkge1xuICAgICAgICAgIGluaXRpYWxWYWx1ZXMucGF5dHlwZSA9IHJlc3BvbnNlLnBheVR5cGUuaWQ7XG5cbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2UucGF5bWVudCkge1xuICAgICAgICAgIGluaXRpYWxWYWx1ZXMucGF5bW9kZWwgPSByZXNwb25zZS5wYXltZW50LmlkO1xuXG4gICAgICAgIH1cbiAgICAgICAgaW5pdGlhbFZhbHVlcy5zdGF0aW9ubnVtID0gcmVzcG9uc2Uuc3RhdGlvbm51bTtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy53aGVyZWZsb29yID0gcmVzcG9uc2Uud2hlcmVmbG9vcjtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5yZW50YWx1c2UgPSByZXNwb25zZS5yZW50YWx1c2U7XG4gICAgICAgIGluaXRpYWxWYWx1ZXMuY29udHJhY3RtYXJrID0gcmVzcG9uc2UuY29udHJhY3RtYXJrO1xuICAgICAgICBpbml0aWFsVmFsdWVzLnRvdGFscmVudCA9IHJlc3BvbnNlLnRvdGFscmVudDtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy50b3RhbGRlcG9zaXQgPSByZXNwb25zZS50b3RhbGRlcG9zaXQ7XG4gICAgICAgIGluaXRpYWxWYWx1ZXMubGVzc29yQ29udGFjdGlkID0gcmVzcG9uc2UubGVzc29yQ29udGFjdGlkO1xuICAgICAgICBpbml0aWFsVmFsdWVzLmRlcG9zaXRhbW91bnQgPSByZXNwb25zZS5kZXBvc2l0YW1vdW50O1xuICAgICAgICBpbml0aWFsVmFsdWVzLnRvdGFscmV0dXJuID0gcmVzcG9uc2UudG90YWxyZXR1cm47XG4gICAgICAgIC8v5pe26Ze0XG5cbiAgICAgICAgaW5pdGlhbFZhbHVlcy5zaWduZGF0ZSA9IG5ldyBEYXRlKHJlc3BvbnNlLnNpZ25kYXRlKTtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5sZWFzZUJlZ2luZGF0ZSA9IG5ldyBEYXRlKHJlc3BvbnNlLmxlYXNlQmVnaW5kYXRlKTtcbiAgICAgICAgaW5pdGlhbFZhbHVlcy5sZWFzZUVuZGRhdGUgPSBuZXcgRGF0ZShyZXNwb25zZS5sZWFzZUVuZGRhdGUpO1xuICAgICAgICBpbml0aWFsVmFsdWVzLndpdGhkcmF3ZGF0ZSA9IHJlc3BvbnNlLndpdGhkcmF3ZGF0ZTtcblxuXG4gICAgICAgIC8v5aSE55CGc3RhdGlvbnZvc1xuICAgICAgICBzdGF0aW9uVm9zID0gcmVzcG9uc2Uuc3RhdGlvblZvcztcblxuXG4gICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBpbml0aWFsVmFsdWVzLFxuICAgICAgICAgIG9wdGlvblZhbHVlcyxcbiAgICAgICAgICBzdGF0aW9uVm9zXG4gICAgICAgIH0pO1xuXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgTm90aWZ5LnNob3coW3tcbiAgICAgICAgICBtZXNzYWdlOiAn5ZCO5Y+w5Ye66ZSZ6K+36IGU57O7566h55CG5ZGYJyxcbiAgICAgICAgICB0eXBlOiAnZGFuZ2VyJyxcbiAgICAgICAgfV0pO1xuICAgICAgfSk7XG5cblxuICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgTm90aWZ5LnNob3coW3tcbiAgICAgICAgbWVzc2FnZTogJ+WQjuWPsOWHuumUmeivt+iBlOezu+euoeeQhuWRmCcsXG4gICAgICAgIHR5cGU6ICdkYW5nZXInLFxuICAgICAgfV0pO1xuICAgIH0pO1xuXG4gIH1cblxuXG4gIHJlbmRlcigpIHtcblxuICAgIGxldCB7XG4gICAgICBpbml0aWFsVmFsdWVzLFxuICAgICAgb3B0aW9uVmFsdWVzLFxuICAgICAgc3RhdGlvblZvc1xuICAgIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnNvbGUubG9nKCdzdGF0aW9uVm9zJywgc3RhdGlvblZvcylcbiAgICByZXR1cm4gKFxuXG4gICAgICA8ZGl2PlxuICAgICAgPFRpdGxlIHZhbHVlPVwi57yW6L6R6YCA56ef5Y2P6K6u5LmmX+i0ouWKoeeuoeeQhlwiLz5cbiAgICAgIDxCcmVhZENydW1icyBjaGlsZHJlbj17Wyfns7vnu5/ov5DokKUnLCflrqLmiLfnrqHnkIYnLCfpgIDnp5/ljY/orq4nXX0vPlxuICAgICAgPFNlY3Rpb24gdGl0bGU9XCLpgIDnp5/ljY/orq7kuaZcIiBkZXNjcmlwdGlvbj1cIlwiPlxuICAgICAgICAgIDxOZXdDcmVhdGVGb3JtIG9uU3VibWl0PXt0aGlzLm9uQ3JlYXRlU3VibWl0fSBpbml0aWFsVmFsdWVzPXtpbml0aWFsVmFsdWVzfSBvbkNhbmNlbD17dGhpcy5vbkNhbmNlbH0gb3B0aW9uVmFsdWVzPXtvcHRpb25WYWx1ZXN9IHN0YXRpb25Wb3M9e3N0YXRpb25Wb3N9Lz5cbiAgICAgIDwvU2VjdGlvbj5cbiAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG4iXX0=