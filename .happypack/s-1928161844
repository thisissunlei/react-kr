'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = undefined;

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _simpleAssign = require('simple-assign');

var _simpleAssign2 = _interopRequireDefault(_simpleAssign);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _TableRow = require('../TableRow');

var _TableRow2 = _interopRequireDefault(_TableRow);

var _TableRowColumn = require('../TableRowColumn');

var _TableRowColumn2 = _interopRequireDefault(_TableRowColumn);

var _Checkbox = require('../../Checkbox');

var _Checkbox2 = _interopRequireDefault(_Checkbox);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var TableBody = function (_React$Component) {
	_inherits(TableBody, _React$Component);

	function TableBody(props, context) {
		_classCallCheck(this, TableBody);

		var _this = _possibleConstructorReturn(this, (TableBody.__proto__ || Object.getPrototypeOf(TableBody)).call(this, props, context));

		_this.toggleInsertElement = _this.toggleInsertElement.bind(_this);
		_this.createRowElement = _this.createRowElement.bind(_this);

		_this.renderRows = _this.renderRows.bind(_this);
		_this.onCellClick = _this.onCellClick.bind(_this);
		_this.onCellHover = _this.onCellHover.bind(_this);
		_this.onCellHoverExit = _this.onCellHoverExit.bind(_this);
		_this.onRowHover = _this.onRowHover.bind(_this);
		_this.onRowHoverExit = _this.onRowHoverExit.bind(_this);
		_this.onRowClick = _this.onRowClick.bind(_this);
		_this.onOperation = _this.onOperation.bind(_this);

		_this.createRowCheckboxColumn = _this.createRowCheckboxColumn.bind(_this);

		_this.createAjaxRow = _this.createAjaxRow.bind(_this);
		_this.createNormalRow = _this.createNormalRow.bind(_this);

		_this.state = {
			showInsertElement: false
		};
		return _this;
	}

	_createClass(TableBody, [{
		key: 'toggleInsertElement',
		value: function toggleInsertElement(event) {

			if (event && !event.hasOwnProperty('target')) {
				return;
			}

			var target = event && event.target;
			var nodeName = target && target.nodeName.toLowerCase();

			if (nodeName === 'input') {
				return false;
			}
			this.setState({
				showInsertElement: !this.state.showInsertElement
			});
		}
	}, {
		key: 'renderInsertElement',
		value: function renderInsertElement() {
			var _props = this.props,
			    insertElement = _props.insertElement,
			    colSpan = _props.colSpan;


			if (!insertElement || !this.state.showInsertElement) {
				return null;
			}
			return _react2.default.createElement(
				_TableRow2.default,
				null,
				_react2.default.createElement(
					_TableRowColumn2.default,
					{ colSpan: colSpan },
					' ',
					insertElement,
					' '
				)
			);
		}
	}, {
		key: 'onOperation',
		value: function onOperation(type, itemData) {
			var onOperation = this.props.onOperation;

			onOperation && onOperation(type, itemData);
		}
	}, {
		key: 'onCellClick',
		value: function onCellClick() {}
	}, {
		key: 'onCellHover',
		value: function onCellHover() {}
	}, {
		key: 'onCellHoverExit',
		value: function onCellHoverExit() {}
	}, {
		key: 'onRowHover',
		value: function onRowHover() {}
	}, {
		key: 'onRowHoverExit',
		value: function onRowHoverExit() {}
	}, {
		key: 'onRowClick',
		value: function onRowClick(event, rowNumber) {
			var onRowClick = this.props.onRowClick;


			onRowClick && onRowClick(event, rowNumber);
			this.toggleInsertElement(event);
		}
	}, {
		key: 'createRowCheckboxColumn',
		value: function createRowCheckboxColumn(rowProps) {

			if (!this.props.displayCheckbox) {
				return null;
			}

			if (!rowProps.displayCheckbox && this.props.displayCheckbox) {
				return null;
			}
			return _react2.default.createElement(
				_TableRowColumn2.default,
				_extends({
					columnNumber: 0,
					width: this.props.defaultValue.checkboxWidth
				}, rowProps),
				_react2.default.createElement(_Checkbox2.default, { checked: rowProps.selected, onCheck: function onCheck(event) {
						rowProps.onRowClick(event, rowProps.key);
					} })
			);
		}
	}, {
		key: 'createRowElement',
		value: function createRowElement(child, rowNumber) {
			var _props2 = this.props,
			    listData = _props2.listData,
			    displayCheckbox = _props2.displayCheckbox;


			var handlers = {
				onCellClick: this.onCellClick,
				onCellHover: this.onCellHover,
				onCellHoverExit: this.onCellHoverExit,
				onRowHover: this.onRowHover,
				onRowHoverExit: this.onRowHoverExit,
				onRowClick: this.onRowClick,
				onOperation: this.onOperation
			};

			/*
   let displayCheckbox = true;
   if(child.props && child.props.hasOwnProperty('displayCheckbox')){
   	displayCheckbox = child.props.displayCheckbox;
   }
   */

			var itemData = listData[rowNumber] || {};

			var props = {
				displayCheckbox: displayCheckbox,
				key: rowNumber,
				rowNumber: rowNumber,
				selected: this.isRowSelected(rowNumber),
				visibility: this.isRowVisibility(rowNumber),
				itemData: itemData
			};

			var children = [this.createRowCheckboxColumn((0, _simpleAssign2.default)({}, props, handlers))];

			if (_react2.default.isValidElement(child)) {
				_react2.default.Children.forEach(child.props.children, function (child) {
					children.push(child);
				});
				return _react2.default.cloneElement(child, _extends({}, child.props, props, handlers), children);
			}

			return null;
		}
	}, {
		key: 'createAjaxRow',
		value: function createAjaxRow() {
			var _props3 = this.props,
			    listData = _props3.listData,
			    ajax = _props3.ajax;


			var cloneElement = void 0;
			_react2.default.Children.map(this.props.children, function (child) {
				cloneElement = child;
			});

			var rows = [];

			for (var i = 0; i < listData.length; i++) {
				var element = _react2.default.cloneElement(cloneElement, {
					key: i
				});

				if (_react2.default.isValidElement(element)) {
					rows.push(this.createRowElement(element, i));
				}
			}

			return rows;
		}
	}, {
		key: 'createNormalRow',
		value: function createNormalRow() {
			var _this2 = this;

			var rows = [];
			var numChildren = _react2.default.Children.count(this.props.children);
			var _props4 = this.props,
			    displayCheckbox = _props4.displayCheckbox,
			    setRowTotalCount = _props4.setRowTotalCount;

			var rowNumber = 0;
			_react2.default.Children.map(this.props.children, function (child) {
				rows.push(_this2.createRowElement(child, rowNumber++));
			});
			return rows;
		}
	}, {
		key: 'renderRows',
		value: function renderRows() {
			var ajax = this.props.ajax;


			return ajax ? this.createAjaxRow() : this.createNormalRow();
		}
	}, {
		key: 'isRowVisibility',
		value: function isRowVisibility(rowNumber) {

			if (parseInt(this.props.visibilityRows[rowNumber])) {
				return true;
			}

			return false;
		}
	}, {
		key: 'isRowSelected',
		value: function isRowSelected(rowNumber) {
			if (parseInt(this.props.selectedRows[rowNumber])) {
				return true;
			}
			return false;
		}
	}, {
		key: 'render',
		value: function render() {
			var className = this.props.className;


			return _react2.default.createElement(
				'tbody',
				{ className: className, style: { borderBottom: "solid 1px #eee" } },
				this.renderRows()
			);
		}
	}]);

	return TableBody;
}(_react2.default.Component);

/*
   <tbody className={className} onTouchTap={this.toggleInsertElement}>

*/


TableBody.displayName = 'TableBody';
TableBody.PropTypes = {
	className: _react2.default.PropTypes.string,
	children: _react2.default.PropTypes.node,
	insertElement: _react2.default.PropTypes.node,
	allRowsSelected: _react2.default.PropTypes.bool,
	displayCheckbox: _react2.default.PropTypes.bool,
	selectedRows: _react2.default.PropTypes.array,
	visibilityRows: _react2.default.PropTypes.array,
	setRowTotalCount: _react2.default.PropTypes.func,
	defaultValue: _react2.default.PropTypes.object,
	listData: _react2.default.PropTypes.listData,
	onOperation: _react2.default.PropTypes.func
};
exports.default = TableBody;
;

var _temp = function () {
	if (typeof __REACT_HOT_LOADER__ === 'undefined') {
		return;
	}

	__REACT_HOT_LOADER__.register(TableBody, 'TableBody', '/Users/tmac_zc/Code/kr-admin/src/Components/Table/TableBody/index.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db21wb25lbnRzL1RhYmxlL1RhYmxlQm9keS9pbmRleC5qcyJdLCJuYW1lcyI6WyJUYWJsZUJvZHkiLCJwcm9wcyIsImNvbnRleHQiLCJ0b2dnbGVJbnNlcnRFbGVtZW50IiwiYmluZCIsImNyZWF0ZVJvd0VsZW1lbnQiLCJyZW5kZXJSb3dzIiwib25DZWxsQ2xpY2siLCJvbkNlbGxIb3ZlciIsIm9uQ2VsbEhvdmVyRXhpdCIsIm9uUm93SG92ZXIiLCJvblJvd0hvdmVyRXhpdCIsIm9uUm93Q2xpY2siLCJvbk9wZXJhdGlvbiIsImNyZWF0ZVJvd0NoZWNrYm94Q29sdW1uIiwiY3JlYXRlQWpheFJvdyIsImNyZWF0ZU5vcm1hbFJvdyIsInN0YXRlIiwic2hvd0luc2VydEVsZW1lbnQiLCJldmVudCIsImhhc093blByb3BlcnR5IiwidGFyZ2V0Iiwibm9kZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsInNldFN0YXRlIiwiaW5zZXJ0RWxlbWVudCIsImNvbFNwYW4iLCJ0eXBlIiwiaXRlbURhdGEiLCJyb3dOdW1iZXIiLCJyb3dQcm9wcyIsImRpc3BsYXlDaGVja2JveCIsImRlZmF1bHRWYWx1ZSIsImNoZWNrYm94V2lkdGgiLCJzZWxlY3RlZCIsImtleSIsImNoaWxkIiwibGlzdERhdGEiLCJoYW5kbGVycyIsImlzUm93U2VsZWN0ZWQiLCJ2aXNpYmlsaXR5IiwiaXNSb3dWaXNpYmlsaXR5IiwiY2hpbGRyZW4iLCJpc1ZhbGlkRWxlbWVudCIsIkNoaWxkcmVuIiwiZm9yRWFjaCIsInB1c2giLCJjbG9uZUVsZW1lbnQiLCJhamF4IiwibWFwIiwicm93cyIsImkiLCJsZW5ndGgiLCJlbGVtZW50IiwibnVtQ2hpbGRyZW4iLCJjb3VudCIsInNldFJvd1RvdGFsQ291bnQiLCJwYXJzZUludCIsInZpc2liaWxpdHlSb3dzIiwic2VsZWN0ZWRSb3dzIiwiY2xhc3NOYW1lIiwiYm9yZGVyQm90dG9tIiwiQ29tcG9uZW50IiwiZGlzcGxheU5hbWUiLCJQcm9wVHlwZXMi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QUFDRCxVQUFPLEtBQVA7QUFDQTs7OzJCQUdRO0FBQUEsT0FHUCtCLFNBSE8sR0FJSixLQUFLM0QsS0FKRCxDQUdQMkQsU0FITzs7O0FBTVIsVUFDQztBQUFBO0FBQUEsTUFBUSxXQUFXQSxTQUFuQixFQUE4QixPQUFPLEVBQUNDLGNBQWEsZ0JBQWQsRUFBckM7QUFDQyxTQUFLdkQsVUFBTDtBQURELElBREQ7QUFPQTs7OztFQWpScUMsZ0JBQU13RCxTOztBQXNSN0M7Ozs7OztBQXRScUI5RCxTLENBRWIrRCxXLEdBQWMsVztBQUZEL0QsUyxDQUliZ0UsUyxHQUFZO0FBQ2xCSixZQUFXLGdCQUFNSSxTQUFOLENBQWdCQyxNQURUO0FBRWxCdkIsV0FBVSxnQkFBTXNCLFNBQU4sQ0FBZ0JFLElBRlI7QUFHbEJ6QyxnQkFBZSxnQkFBTXVDLFNBQU4sQ0FBZ0JFLElBSGI7QUFJbEJDLGtCQUFpQixnQkFBTUgsU0FBTixDQUFnQkksSUFKZjtBQUtsQnJDLGtCQUFpQixnQkFBTWlDLFNBQU4sQ0FBZ0JJLElBTGY7QUFNbEJULGVBQWMsZ0JBQU1LLFNBQU4sQ0FBZ0JLLEtBTlo7QUFPbEJYLGlCQUFnQixnQkFBTU0sU0FBTixDQUFnQkssS0FQZDtBQVFsQmIsbUJBQWtCLGdCQUFNUSxTQUFOLENBQWdCTSxJQVJoQjtBQVNsQnRDLGVBQWMsZ0JBQU1nQyxTQUFOLENBQWdCTyxNQVRaO0FBVWxCbEMsV0FBVSxnQkFBTTJCLFNBQU4sQ0FBZ0IzQixRQVZSO0FBV2xCeEIsY0FBYSxnQkFBTW1ELFNBQU4sQ0FBZ0JNO0FBWFgsQztrQkFKQ3RFLFM7Ozs7Ozs7OytCQUFBQSxTIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy90bWFjX3pjL0NvZGUva3ItYWRtaW4iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgVGFibGVSb3cgZnJvbSAnLi4vVGFibGVSb3cnO1xuaW1wb3J0IFRhYmxlUm93Q29sdW1uIGZyb20gJy4uL1RhYmxlUm93Q29sdW1uJztcblxuaW1wb3J0IENoZWNrYm94IGZyb20gJy4uLy4uL0NoZWNrYm94JztcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYWJsZUJvZHkgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG5cdHN0YXRpYyBkaXNwbGF5TmFtZSA9ICdUYWJsZUJvZHknO1xuXG5cdHN0YXRpYyBQcm9wVHlwZXMgPSB7XG5cdFx0Y2xhc3NOYW1lOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuXHRcdGNoaWxkcmVuOiBSZWFjdC5Qcm9wVHlwZXMubm9kZSxcblx0XHRpbnNlcnRFbGVtZW50OiBSZWFjdC5Qcm9wVHlwZXMubm9kZSxcblx0XHRhbGxSb3dzU2VsZWN0ZWQ6IFJlYWN0LlByb3BUeXBlcy5ib29sLFxuXHRcdGRpc3BsYXlDaGVja2JveDogUmVhY3QuUHJvcFR5cGVzLmJvb2wsXG5cdFx0c2VsZWN0ZWRSb3dzOiBSZWFjdC5Qcm9wVHlwZXMuYXJyYXksXG5cdFx0dmlzaWJpbGl0eVJvd3M6IFJlYWN0LlByb3BUeXBlcy5hcnJheSxcblx0XHRzZXRSb3dUb3RhbENvdW50OiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcblx0XHRkZWZhdWx0VmFsdWU6IFJlYWN0LlByb3BUeXBlcy5vYmplY3QsXG5cdFx0bGlzdERhdGE6IFJlYWN0LlByb3BUeXBlcy5saXN0RGF0YSxcblx0XHRvbk9wZXJhdGlvbjogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG5cdH1cblxuXG5cdGNvbnN0cnVjdG9yKHByb3BzLCBjb250ZXh0KSB7XG5cdFx0c3VwZXIocHJvcHMsIGNvbnRleHQpO1xuXG5cdFx0dGhpcy50b2dnbGVJbnNlcnRFbGVtZW50ID0gdGhpcy50b2dnbGVJbnNlcnRFbGVtZW50LmJpbmQodGhpcyk7XG5cdFx0dGhpcy5jcmVhdGVSb3dFbGVtZW50ID0gdGhpcy5jcmVhdGVSb3dFbGVtZW50LmJpbmQodGhpcyk7XG5cblx0XHR0aGlzLnJlbmRlclJvd3MgPSB0aGlzLnJlbmRlclJvd3MuYmluZCh0aGlzKTtcblx0XHR0aGlzLm9uQ2VsbENsaWNrID0gdGhpcy5vbkNlbGxDbGljay5iaW5kKHRoaXMpO1xuXHRcdHRoaXMub25DZWxsSG92ZXIgPSB0aGlzLm9uQ2VsbEhvdmVyLmJpbmQodGhpcyk7XG5cdFx0dGhpcy5vbkNlbGxIb3ZlckV4aXQgPSB0aGlzLm9uQ2VsbEhvdmVyRXhpdC5iaW5kKHRoaXMpO1xuXHRcdHRoaXMub25Sb3dIb3ZlciA9IHRoaXMub25Sb3dIb3Zlci5iaW5kKHRoaXMpO1xuXHRcdHRoaXMub25Sb3dIb3ZlckV4aXQgPSB0aGlzLm9uUm93SG92ZXJFeGl0LmJpbmQodGhpcyk7XG5cdFx0dGhpcy5vblJvd0NsaWNrID0gdGhpcy5vblJvd0NsaWNrLmJpbmQodGhpcyk7XG5cdFx0dGhpcy5vbk9wZXJhdGlvbiA9IHRoaXMub25PcGVyYXRpb24uYmluZCh0aGlzKTtcblxuXHRcdHRoaXMuY3JlYXRlUm93Q2hlY2tib3hDb2x1bW4gPSB0aGlzLmNyZWF0ZVJvd0NoZWNrYm94Q29sdW1uLmJpbmQodGhpcyk7XG5cblx0XHR0aGlzLmNyZWF0ZUFqYXhSb3cgPSB0aGlzLmNyZWF0ZUFqYXhSb3cuYmluZCh0aGlzKTtcblx0XHR0aGlzLmNyZWF0ZU5vcm1hbFJvdyA9IHRoaXMuY3JlYXRlTm9ybWFsUm93LmJpbmQodGhpcyk7XG5cblx0XHR0aGlzLnN0YXRlID0ge1xuXHRcdFx0c2hvd0luc2VydEVsZW1lbnQ6IGZhbHNlLFxuXHRcdH1cblx0fVxuXG5cdHRvZ2dsZUluc2VydEVsZW1lbnQoZXZlbnQpIHtcblxuXHRcdGlmKGV2ZW50JiYhZXZlbnQuaGFzT3duUHJvcGVydHkoJ3RhcmdldCcpKXtcblx0XHRcdFx0cmV0dXJuIDtcblx0XHR9XG5cblx0XHRsZXQgdGFyZ2V0ID0gZXZlbnQmJmV2ZW50LnRhcmdldDtcblx0XHRsZXQgbm9kZU5hbWUgPXRhcmdldCYmdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRpZiAobm9kZU5hbWUgPT09ICdpbnB1dCcpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0dGhpcy5zZXRTdGF0ZSh7XG5cdFx0XHRzaG93SW5zZXJ0RWxlbWVudDogIXRoaXMuc3RhdGUuc2hvd0luc2VydEVsZW1lbnRcblx0XHR9KTtcblx0fVxuXG5cdHJlbmRlckluc2VydEVsZW1lbnQoKSB7XG5cblx0XHRsZXQge1xuXHRcdFx0aW5zZXJ0RWxlbWVudCxcblx0XHRcdGNvbFNwYW5cblx0XHR9ID0gdGhpcy5wcm9wcztcblxuXHRcdGlmICghaW5zZXJ0RWxlbWVudCB8fCAhdGhpcy5zdGF0ZS5zaG93SW5zZXJ0RWxlbWVudCkge1xuXHRcdFx0cmV0dXJuIG51bGwgO1xuXHRcdH1cblx0XHRyZXR1cm4gKFxuXHRcdFx0PFRhYmxlUm93PlxuXHRcdFx0XHQ8VGFibGVSb3dDb2x1bW4gY29sU3Bhbj17Y29sU3Bhbn0+IHtpbnNlcnRFbGVtZW50fSA8L1RhYmxlUm93Q29sdW1uPlxuXHRcdFx0PC9UYWJsZVJvdz5cblx0XHQpXG5cdH1cblxuXHRvbk9wZXJhdGlvbih0eXBlLCBpdGVtRGF0YSkge1xuXHRcdGNvbnN0IHtcblx0XHRcdG9uT3BlcmF0aW9uXG5cdFx0fSA9IHRoaXMucHJvcHM7XG5cdFx0b25PcGVyYXRpb24gJiYgb25PcGVyYXRpb24odHlwZSwgaXRlbURhdGEpO1xuXHR9XG5cblx0b25DZWxsQ2xpY2soKSB7XG5cblx0fVxuXG5cdG9uQ2VsbEhvdmVyKCkge1xuXG5cdH1cblxuXHRvbkNlbGxIb3ZlckV4aXQoKSB7XG5cblx0fVxuXG5cdG9uUm93SG92ZXIoKSB7XG5cblx0fVxuXG5cdG9uUm93SG92ZXJFeGl0KCkge1xuXG5cdH1cblxuXHRvblJvd0NsaWNrKGV2ZW50LCByb3dOdW1iZXIpIHtcblxuXHRcdGNvbnN0IHtcblx0XHRcdG9uUm93Q2xpY2tcblx0XHR9ID0gdGhpcy5wcm9wcztcblxuXHRcdG9uUm93Q2xpY2sgJiYgb25Sb3dDbGljayhldmVudCwgcm93TnVtYmVyKTtcblx0XHR0aGlzLnRvZ2dsZUluc2VydEVsZW1lbnQoZXZlbnQpO1xuXHR9XG5cblx0Y3JlYXRlUm93Q2hlY2tib3hDb2x1bW4ocm93UHJvcHMpIHtcblxuXHRcdGlmICghdGhpcy5wcm9wcy5kaXNwbGF5Q2hlY2tib3gpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdGlmICghcm93UHJvcHMuZGlzcGxheUNoZWNrYm94ICYmIHRoaXMucHJvcHMuZGlzcGxheUNoZWNrYm94KSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdFx0cmV0dXJuIChcblx0XHRcdDxUYWJsZVJvd0NvbHVtblxuXHRcdFx0Y29sdW1uTnVtYmVyPXswfVxuXHRcdFx0d2lkdGg9e3RoaXMucHJvcHMuZGVmYXVsdFZhbHVlLmNoZWNrYm94V2lkdGh9XG5cdFx0XHR7Li4ucm93UHJvcHN9XG5cdFx0XHQ+XG5cdFx0XHQ8Q2hlY2tib3ggY2hlY2tlZD17cm93UHJvcHMuc2VsZWN0ZWR9ICBvbkNoZWNrPXtmdW5jdGlvbihldmVudCl7IHJvd1Byb3BzLm9uUm93Q2xpY2soZXZlbnQscm93UHJvcHMua2V5KTsgfX0gLz5cblx0XHRcdDwvVGFibGVSb3dDb2x1bW4+XG5cdFx0KTtcblx0fVxuXG5cblx0Y3JlYXRlUm93RWxlbWVudChjaGlsZCwgcm93TnVtYmVyKSB7XG5cblx0XHRsZXQge1xuXHRcdFx0bGlzdERhdGEsXG5cdFx0XHRkaXNwbGF5Q2hlY2tib3hcblx0XHR9ID0gdGhpcy5wcm9wcztcblxuXHRcdGNvbnN0IGhhbmRsZXJzID0ge1xuXHRcdFx0b25DZWxsQ2xpY2s6IHRoaXMub25DZWxsQ2xpY2ssXG5cdFx0XHRvbkNlbGxIb3ZlcjogdGhpcy5vbkNlbGxIb3Zlcixcblx0XHRcdG9uQ2VsbEhvdmVyRXhpdDogdGhpcy5vbkNlbGxIb3ZlckV4aXQsXG5cdFx0XHRvblJvd0hvdmVyOiB0aGlzLm9uUm93SG92ZXIsXG5cdFx0XHRvblJvd0hvdmVyRXhpdDogdGhpcy5vblJvd0hvdmVyRXhpdCxcblx0XHRcdG9uUm93Q2xpY2s6IHRoaXMub25Sb3dDbGljayxcblx0XHRcdG9uT3BlcmF0aW9uOiB0aGlzLm9uT3BlcmF0aW9uLFxuXHRcdH07XG5cblx0XHQvKlxuXHRcdGxldCBkaXNwbGF5Q2hlY2tib3ggPSB0cnVlO1xuXHRcdGlmKGNoaWxkLnByb3BzICYmIGNoaWxkLnByb3BzLmhhc093blByb3BlcnR5KCdkaXNwbGF5Q2hlY2tib3gnKSl7XG5cdFx0XHRkaXNwbGF5Q2hlY2tib3ggPSBjaGlsZC5wcm9wcy5kaXNwbGF5Q2hlY2tib3g7XG5cdFx0fVxuXHRcdCovXG5cblx0XHRsZXQgaXRlbURhdGEgPSBsaXN0RGF0YVtyb3dOdW1iZXJdIHx8IHt9O1xuXG5cdFx0bGV0IHByb3BzID0ge1xuXHRcdFx0ZGlzcGxheUNoZWNrYm94OiBkaXNwbGF5Q2hlY2tib3gsXG5cdFx0XHRrZXk6IHJvd051bWJlcixcblx0XHRcdHJvd051bWJlcjogcm93TnVtYmVyLFxuXHRcdFx0c2VsZWN0ZWQ6IHRoaXMuaXNSb3dTZWxlY3RlZChyb3dOdW1iZXIpLFxuXHRcdFx0dmlzaWJpbGl0eTogdGhpcy5pc1Jvd1Zpc2liaWxpdHkocm93TnVtYmVyKSxcblx0XHRcdGl0ZW1EYXRhLFxuXHRcdH07XG5cblx0XHRsZXQgY2hpbGRyZW4gPSBbXG5cdFx0XHR0aGlzLmNyZWF0ZVJvd0NoZWNrYm94Q29sdW1uKE9iamVjdC5hc3NpZ24oe30sIHByb3BzLCBoYW5kbGVycykpLFxuXHRcdF07XG5cblx0XHRpZihSZWFjdC5pc1ZhbGlkRWxlbWVudChjaGlsZCkpIHtcblx0XHRcdFJlYWN0LkNoaWxkcmVuLmZvckVhY2goY2hpbGQucHJvcHMuY2hpbGRyZW4sIChjaGlsZCkgPT4ge1xuXHRcdFx0XHRjaGlsZHJlbi5wdXNoKGNoaWxkKTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIFJlYWN0LmNsb25lRWxlbWVudChjaGlsZCwge1xuXHRcdFx0XHQuLi5jaGlsZC5wcm9wcyxcblx0XHRcdFx0Li4ucHJvcHMsXG5cdFx0XHRcdC4uLmhhbmRsZXJzXG5cdFx0XHR9LCBjaGlsZHJlbik7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXG5cdGNyZWF0ZUFqYXhSb3coKSB7XG5cblx0XHRsZXQge1xuXHRcdFx0bGlzdERhdGEsXG5cdFx0XHRhamF4XG5cdFx0fSA9IHRoaXMucHJvcHM7XG5cblxuXHRcdGxldCBjbG9uZUVsZW1lbnQ7XG5cdFx0UmVhY3QuQ2hpbGRyZW4ubWFwKHRoaXMucHJvcHMuY2hpbGRyZW4sIChjaGlsZCkgPT4ge1xuXHRcdFx0Y2xvbmVFbGVtZW50ID0gY2hpbGQ7XG5cdFx0fSk7XG5cblx0XHRsZXQgcm93cyA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0RGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGVsZW1lbnQgPSBSZWFjdC5jbG9uZUVsZW1lbnQoY2xvbmVFbGVtZW50LCB7XG5cdFx0XHRcdGtleTogaVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmKFJlYWN0LmlzVmFsaWRFbGVtZW50KGVsZW1lbnQpKXtcblx0XHRcdFx0cm93cy5wdXNoKHRoaXMuY3JlYXRlUm93RWxlbWVudChlbGVtZW50LCBpKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJvd3M7XG5cdH1cblxuXHRjcmVhdGVOb3JtYWxSb3coKSB7XG5cdFx0bGV0IHJvd3MgPSBbXTtcblx0XHRsZXQgbnVtQ2hpbGRyZW4gPSBSZWFjdC5DaGlsZHJlbi5jb3VudCh0aGlzLnByb3BzLmNoaWxkcmVuKTtcblx0XHRsZXQge1xuXHRcdFx0ZGlzcGxheUNoZWNrYm94LFxuXHRcdFx0c2V0Um93VG90YWxDb3VudFxuXHRcdH0gPSB0aGlzLnByb3BzO1xuXHRcdGxldCByb3dOdW1iZXIgPSAwO1xuXHRcdFJlYWN0LkNoaWxkcmVuLm1hcCh0aGlzLnByb3BzLmNoaWxkcmVuLCAoY2hpbGQpID0+IHtcblx0XHRcdHJvd3MucHVzaCh0aGlzLmNyZWF0ZVJvd0VsZW1lbnQoY2hpbGQsIHJvd051bWJlcisrKSk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHJvd3M7XG5cdH1cblxuXHRyZW5kZXJSb3dzKCkge1xuXG5cdFx0bGV0IHtcblx0XHRcdGFqYXhcblx0XHR9ID0gdGhpcy5wcm9wcztcblxuXHRcdHJldHVybiBhamF4ID8gdGhpcy5jcmVhdGVBamF4Um93KCkgOiB0aGlzLmNyZWF0ZU5vcm1hbFJvdygpO1xuXHR9XG5cblxuXHRpc1Jvd1Zpc2liaWxpdHkocm93TnVtYmVyKSB7XG5cblxuXHRcdGlmIChwYXJzZUludCh0aGlzLnByb3BzLnZpc2liaWxpdHlSb3dzW3Jvd051bWJlcl0pKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRpc1Jvd1NlbGVjdGVkKHJvd051bWJlcikge1xuXHRcdGlmIChwYXJzZUludCh0aGlzLnByb3BzLnNlbGVjdGVkUm93c1tyb3dOdW1iZXJdKSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cblx0cmVuZGVyKCkge1xuXG5cdFx0bGV0IHtcblx0XHRcdGNsYXNzTmFtZVxuXHRcdH0gPSB0aGlzLnByb3BzO1xuXG5cdFx0cmV0dXJuIChcblx0XHRcdDx0Ym9keSAgY2xhc3NOYW1lPXtjbGFzc05hbWV9IHN0eWxlPXt7Ym9yZGVyQm90dG9tOlwic29saWQgMXB4ICNlZWVcIn19PlxuXHRcdFx0e3RoaXMucmVuZGVyUm93cygpfVxuXHRcdFx0ey8qdGhpcy5yZW5kZXJJbnNlcnRFbGVtZW50KCkqL31cblx0XHRcdDwvdGJvZHk+XG5cdFx0KTtcblxuXHR9XG59XG5cblxuXG4vKlxuICAgPHRib2R5IGNsYXNzTmFtZT17Y2xhc3NOYW1lfSBvblRvdWNoVGFwPXt0aGlzLnRvZ2dsZUluc2VydEVsZW1lbnR9PlxuXG4qL1xuIl19