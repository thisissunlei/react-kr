'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _simpleAssign = require('simple-assign');

var _simpleAssign2 = _interopRequireDefault(_simpleAssign);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _Redux = require('kr/Redux');

var _reduxForm = require('redux-form');

var _krUi = require('kr-ui');

require('./index.less');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var StartCardActivation = function (_Component) {
	_inherits(StartCardActivation, _Component);

	//数据的初始化设定
	function StartCardActivation(props) {
		_classCallCheck(this, StartCardActivation);

		var _this2 = _possibleConstructorReturn(this, (StartCardActivation.__proto__ || Object.getPrototypeOf(StartCardActivation)).call(this, props));

		_this2.onSubmit = function (values) {
			var _this = _this2;
			if (navigator.onLine) {//正常工作
			} else {
				//执行离线状态时的任务
				_krUi.Message.error("网络已断开");
				return;
			}

			var isErr = false;
			var params = {};
			params.foreignCode = _this2.state.detail.startNum;
			params.interCode = values.interCode;

			if (!values.interCode) {

				return;
			}
			if (_this2.state.accomplish) {

				return;
			}

			var reg = /^[0-9a-fA-F]{8}$/;
			if (values.interCode && !reg.test(values.interCode)) {

				_krUi.Message.error('内码为8位16进制数');
				return;
			}

			_Redux.Store.dispatch(_Redux.Actions.callAPI('CardActivation', {}, params)).then(function (response) {
				//  Message.success("成功");
				var detail = {};
				detail.interCode = "";
				_Redux.Store.dispatch((0, _reduxForm.initialize)('StartCardActivation', detail));
				_this.props.onFlush();
				var title = "会员卡" + values.interCode + "激活成功";
				_this.props.openMessageBar(title, "ok");

				if (_this.state.detail.startNum <= _this.state.detail.endNum) {

					_this.cardNumAdd(4);
				}
				setTimeout(function () {
					_this.props.closeMessageBar();
				}, 1000);
			}).catch(function (err) {
				if (err.message == "该会员卡已被录入") {
					err.message = "卡号" + _this.state.detail.startNum + "已存在请跳过！";
				} else if (err.message == "该卡已被激活,请重刷") {
					err.message = "会员卡" + values.interCode + "已被激活，请换卡重刷！";
				}
				if (err.message == "Failed to fetch") {
					err.message = "连接不到服务器!";
					_krUi.Message.error(err.message);
					return;
				}

				_this.props.openMessageBar(err.message, "error");
				setTimeout(function () {
					_this.props.closeMessageBar();
				}, 3000);
			});
		};

		_this2.numhandle = function (num, start, end) {
			num = num.toString();
			num = num.substring(start, end);
			return num;
		};

		_this2.cardNumAdd = function (len) {
			var detail = (0, _simpleAssign2.default)({}, _this2.props.detail);
			var start = _this2.state.detail.startNum.substring(0, 6).toString();
			var num = parseInt(_this2.state.detail.startNum.substring(6, 10));
			num = num + 1;
			num = num.toString();
			if (num.length < len) {
				for (var i = num.length; i < len; i++) {
					num = '0' + num;
				}
			}
			if (_this2.state.detail.startNum == _this2.state.detail.endNum) {

				var oldNum = _this2.state.oldNum + 1;
				if (_this2.state.startNum == _this2.state.num) {
					oldNum = 0;
				}
				_this2.setState({
					accomplish: true
				});
				_krUi.Message.success(oldNum + "张会员卡激活成功！");
				_this2.onCancel();
				detail.startNum = detail.endNum = "0000000000";
			} else {
				detail.startNum = start + num;
				detail.endNum = _this2.state.detail.endNum;
			}

			_this2.setState({
				detail: detail
			});
		};

		_this2.skipCard = function () {
			if (+_this2.state.detail.endNum != 0) {
				var detail = {};
				detail.interCode = "";
				var num = _this2.state.num + 1;
				_Redux.Store.dispatch((0, _reduxForm.initialize)('StartCardActivation', detail));
				_this2.setState({
					oldNum: +_this2.state.oldNum - 1,
					num: num
				});
				_this2.cardNumAdd(4);
			}
		};

		_this2.onCancel = function () {
			var onCancel = _this2.props.onCancel;

			onCancel && onCancel();
		};

		_this2.InterCodeFocus = function (values) {
			if (true) {
				_this2.setState({
					clearInterCodeStyle: {
						display: 'block'
					}
				});
			}
		};

		_this2.clearInterCode = function () {
			var detail = {};
			detail.interCode = "";
			_Redux.Store.dispatch((0, _reduxForm.initialize)('StartCardActivation', detail));
			_this2.setState({
				clearInterCodeStyle: {
					display: 'none'
				}
			});
		};

		_this2.cardChange = function (value) {
			console.log("999");

			var cReg = new RegExp('[\\u4E00-\\u9FFF]+', "g");
			var reg = /^[0-9a-fA-F]{8}$/;
			if (value.length > 8) {
				value = value.slice(8, value.length + 1);
				var detail = {};
				detail.interCode = value;
				_Redux.Store.dispatch((0, _reduxForm.initialize)('StartCardActivation', detail));

				return;
			}
			if (cReg.test(value)) {
				_krUi.Message.error('卡内码内含有中文请切换英文输入法！');
				return;
			}
		};

		_this2.state = {
			detail: props.detail,
			accomplish: false,
			startNum: props.detail.endNum - props.detail.startNum,
			oldNum: props.detail.endNum - props.detail.startNum,
			closeMessageBar: {
				title: '',
				open: false,
				style: {},
				className: ''
			},
			clearInterCodeStyle: {
				display: 'none'
			},
			num: 0
		};
		return _this2;
	}
	//节点的暴露


	//数字处理

	//卡号增加

	//跳过号码


	//关闭窗口


	_createClass(StartCardActivation, [{
		key: 'render',
		value: function render() {
			var _props = this.props,
			    error = _props.error,
			    handleSubmit = _props.handleSubmit,
			    pristine = _props.pristine,
			    reset = _props.reset,
			    throwBack = _props.throwBack;

			var numbers = +this.state.detail.endNum == 0 ? 0 : +this.state.detail.endNum - +this.state.detail.startNum + 1;
			return _react2.default.createElement(
				'form',
				{ className: 'HeavilyActivation', onSubmit: handleSubmit(this.onSubmit) },
				_react2.default.createElement('div', { className: 'activeImg' }),
				_react2.default.createElement(
					'div',
					{ style: { textAlign: "right", width: 340, margin: "auto", marginTop: 10, marginLeft: 52 } },
					_react2.default.createElement(
						'label',
						null,
						"会员卡数量:" + numbers + "张"
					),
					_react2.default.createElement(
						'div',
						{ style: { height: '60px', marginTop: "15px", marginLeft: "4px" } },
						_react2.default.createElement(
							'span',
							{ className: 'cardNum' },
							this.numhandle(this.state.detail.startNum, 0, 4)
						),
						_react2.default.createElement(
							'span',
							{ className: 'cardNum', style: { padding: "0 10px" } },
							this.numhandle(this.state.detail.startNum, 4, 6)
						),
						_react2.default.createElement(
							'span',
							{ className: 'cardNum normal' },
							this.numhandle(this.state.detail.startNum, 6, 10)
						)
					),
					_react2.default.createElement(
						'label',
						{ className: 'jump', onClick: this.skipCard, style: { fontSize: "14px" } },
						'\u8DF3\u8FC7\u8BE5\u53F7\u7801'
					)
				),
				_react2.default.createElement(
					'div',
					{ className: 'clearInterCode', style: { marginLeft: "-4px", marginRight: "4px" } },
					_react2.default.createElement(_krUi.KrField, { left: 71, right: 71, name: 'interCode', type: 'text', onFocus: this.InterCodeFocus, onChange: this.cardChange, autoFocus: true }),
					_react2.default.createElement('div', { className: 'startX', style: this.state.clearInterCodeStyle, onClick: this.clearInterCode })
				),
				_react2.default.createElement(
					_krUi.Grid,
					{ style: { marginTop: 18, marginBottom: 5 } },
					_react2.default.createElement(
						_krUi.Row,
						null,
						_react2.default.createElement(
							_krUi.Col,
							{ md: 12, align: 'center' },
							_react2.default.createElement(
								_krUi.ButtonGroup,
								null,
								this.state.accomplish && _react2.default.createElement(
									'div',
									{ className: 'ui-btn-center', style: { marginLeft: 27 } },
									_react2.default.createElement(_krUi.Button, { label: '\u5B8C\u6210', type: 'submit', backgroundColor: this.state.accomplish ? "#499df1" : "#cccccc", onTouchTap: this.onCancel })
								),
								!this.state.accomplish && _react2.default.createElement(_krUi.Button, { label: '\u8FD4\u56DE', type: 'button', cancle: true, onTouchTap: throwBack })
							)
						)
					)
				)
			);
		}
	}]);

	return StartCardActivation;
}(_react.Component);

StartCardActivation.defaultProps = {
	stage: 'importNum'

};
StartCardActivation.PropTypes = {
	onSubmit: _react2.default.PropTypes.func,
	onCancel: _react2.default.PropTypes.func,
	detail: _react2.default.PropTypes.object,
	/**
  * stage表示批量修改所处的阶段
  * 允许填入的值为 importNum|| activeCard
  */
	stage: _react2.default.PropTypes.string
};

var validate = function validate(values) {

	var errors = {};
	var reg = /^[0-9a-fA-F]{8}$/;
	console.log("1233");
	if (!reg.test(values.interCode)) {
		errors.interCode = '内码为8位16进制数';
	}

	return errors;
};
var selector = (0, _reduxForm.formValueSelector)('StartCardActivation');

var _default = (0, _reduxForm.reduxForm)({ form: 'StartCardActivation', validate: validate, enableReinitialize: true, keepDirtyOnReinitialize: true })(StartCardActivation);

exports.default = _default;
;

var _temp = function () {
	if (typeof __REACT_HOT_LOADER__ === 'undefined') {
		return;
	}

	__REACT_HOT_LOADER__.register(StartCardActivation, 'StartCardActivation', '/Users/tmac_zc/Code/kr-admin/src/Containers/Member/MemberManage/Setting/StartCardActivation.js');

	__REACT_HOT_LOADER__.register(validate, 'validate', '/Users/tmac_zc/Code/kr-admin/src/Containers/Member/MemberManage/Setting/StartCardActivation.js');

	__REACT_HOT_LOADER__.register(selector, 'selector', '/Users/tmac_zc/Code/kr-admin/src/Containers/Member/MemberManage/Setting/StartCardActivation.js');

	__REACT_HOT_LOADER__.register(_default, 'default', '/Users/tmac_zc/Code/kr-admin/src/Containers/Member/MemberManage/Setting/StartCardActivation.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db250YWluZXJzL01lbWJlci9NZW1iZXJNYW5hZ2UvU2V0dGluZy9TdGFydENhcmRBY3RpdmF0aW9uLmpzIl0sIm5hbWVzIjpbIlN0YXJ0Q2FyZEFjdGl2YXRpb24iLCJwcm9wcyIsIm9uU3VibWl0IiwidmFsdWVzIiwiX3RoaXMiLCJuYXZpZ2F0b3IiLCJvbkxpbmUiLCJlcnJvciIsImlzRXJyIiwicGFyYW1zIiwiZm9yZWlnbkNvZGUiLCJzdGF0ZSIsImRldGFpbCIsInN0YXJ0TnVtIiwiaW50ZXJDb2RlIiwiYWNjb21wbGlzaCIsInJlZyIsInRlc3QiLCJkaXNwYXRjaCIsImNhbGxBUEkiLCJ0aGVuIiwicmVzcG9uc2UiLCJvbkZsdXNoIiwidGl0bGUiLCJvcGVuTWVzc2FnZUJhciIsImVuZE51bSIsImNhcmROdW1BZGQiLCJzZXRUaW1lb3V0IiwiY2xvc2VNZXNzYWdlQmFyIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwibnVtaGFuZGxlIiwibnVtIiwic3RhcnQiLCJlbmQiLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsImxlbiIsInBhcnNlSW50IiwibGVuZ3RoIiwiaSIsIm9sZE51bSIsInNldFN0YXRlIiwic3VjY2VzcyIsIm9uQ2FuY2VsIiwic2tpcENhcmQiLCJJbnRlckNvZGVGb2N1cyIsImNsZWFySW50ZXJDb2RlU3R5bGUiLCJkaXNwbGF5IiwiY2xlYXJJbnRlckNvZGUiLCJjYXJkQ2hhbmdlIiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwiY1JlZyIsIlJlZ0V4cCIsInNsaWNlIiwib3BlbiIsInN0eWxlIiwiY2xhc3NOYW1lIiwiaGFuZGxlU3VibWl0IiwicHJpc3RpbmUiLCJyZXNldCIsInRocm93QmFjayIsIm51bWJlcnMiLCJ0ZXh0QWxpZ24iLCJ3aWR0aCIsIm1hcmdpbiIsIm1hcmdpblRvcCIsIm1hcmdpbkxlZnQiLCJoZWlnaHQiLCJwYWRkaW5nIiwiZm9udFNpemUiLCJtYXJnaW5SaWdodCIsIm1hcmdpbkJvdHRvbSIsImRlZmF1bHRQcm9wcyIsInN0YWdlIiwiUHJvcFR5cGVzIiwiZnVuYyIsIm9iamVjdCIsInN0cmluZyIsInZhbGlkYXRlIiwiZXJyb3JzIiwic2VsZWN0b3IiLCJmb3JtIiwiZW5hYmxlUmVpbml0aWFsaXplIiwia2VlcERpcnR5T25SZWluaXRpYWxpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7O0FBRUE7O0FBRUE7O0FBV0E7Ozs7Ozs7Ozs7SUFFT0EsbUI7OztBQWlCTjtBQUNBLDhCQUFZQyxLQUFaLEVBQWtCO0FBQUE7O0FBQUEseUlBQ1hBLEtBRFc7O0FBQUEsU0FtQmpCQyxRQW5CaUIsR0FtQlIsVUFBQ0MsTUFBRCxFQUFVO0FBQ25CLE9BQUlDLGNBQUo7QUFDQyxPQUFJQyxVQUFVQyxNQUFkLEVBQ0QsQ0FBRTtBQUNELElBRkEsTUFHSTtBQUFFO0FBQ0osa0JBQVFDLEtBQVIsQ0FBYyxPQUFkO0FBQ0E7QUFDRjs7QUFFQSxPQUFJQyxRQUFNLEtBQVY7QUFDQSxPQUFNQyxTQUFPLEVBQWI7QUFDQUEsVUFBT0MsV0FBUCxHQUFtQixPQUFLQyxLQUFMLENBQVdDLE1BQVgsQ0FBa0JDLFFBQXJDO0FBQ0FKLFVBQU9LLFNBQVAsR0FBaUJYLE9BQU9XLFNBQXhCOztBQUVBLE9BQUcsQ0FBQ1gsT0FBT1csU0FBWCxFQUFxQjs7QUFFcEI7QUFDQTtBQUNELE9BQUcsT0FBS0gsS0FBTCxDQUFXSSxVQUFkLEVBQXlCOztBQUV4QjtBQUNBOztBQUVGLE9BQUlDLE1BQUksa0JBQVI7QUFDQSxPQUFJYixPQUFPVyxTQUFQLElBQWtCLENBQUNFLElBQUlDLElBQUosQ0FBU2QsT0FBT1csU0FBaEIsQ0FBdkIsRUFBbUQ7O0FBR2xELGtCQUFRUCxLQUFSLENBQWMsWUFBZDtBQUNBO0FBQ0E7O0FBRUEsZ0JBQU1XLFFBQU4sQ0FBZSxlQUFRQyxPQUFSLENBQWdCLGdCQUFoQixFQUFrQyxFQUFsQyxFQUFzQ1YsTUFBdEMsQ0FBZixFQUE4RFcsSUFBOUQsQ0FBbUUsVUFBU0MsUUFBVCxFQUFt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RSxNQUFJLGtCQUFSO0FBQ0FxQyxTQUFRQyxHQUFSLENBQVksTUFBWjtBQUNBLEtBQUksQ0FBQ3RDLElBQUlDLElBQUosQ0FBU2QsT0FBT1csU0FBaEIsQ0FBTCxFQUFpQztBQUNoQ3FFLFNBQU9yRSxTQUFQLEdBQWlCLFlBQWpCO0FBQ0E7O0FBRUQsUUFBT3FFLE1BQVA7QUFDQSxDQVZGO0FBV0EsSUFBTUMsV0FBVyxrQ0FBa0IscUJBQWxCLENBQWpCOztlQUllLDBCQUFVLEVBQUVDLE1BQU0scUJBQVIsRUFBK0JILGtCQUEvQixFQUF3Q0ksb0JBQW1CLElBQTNELEVBQWlFQyx5QkFBd0IsSUFBekYsRUFBVixFQUEyR3ZGLG1CQUEzRyxDOzs7Ozs7Ozs7OytCQXZRUkEsbUI7OytCQXdQRGtGLFE7OytCQVdBRSxRIiwiZmlsZSI6IlN0YXJ0Q2FyZEFjdGl2YXRpb24uanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL3RtYWNfemMvQ29kZS9rci1hZG1pbiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUHJvcFR5cGVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge2Nvbm5lY3R9IGZyb20gJ2tyL1JlZHV4JztcblxuaW1wb3J0IHtyZWR1eEZvcm0sZm9ybVZhbHVlU2VsZWN0b3IsaW5pdGlhbGl6ZSxjaGFuZ2Usc3VibWl0fSBmcm9tICdyZWR1eC1mb3JtJztcbmltcG9ydCB7QWN0aW9ucyxTdG9yZX0gZnJvbSAna3IvUmVkdXgnO1xuaW1wb3J0IHtcblx0S3JGaWVsZCxcblx0R3JpZCxcblx0Um93LFxuXHRDb2wsXG5cdEJ1dHRvbixcblx0Tm90aWZ5LFxuXHRCdXR0b25Hcm91cCxcblx0U25hY2tUaXAsXG5cdE1lc3NhZ2Vcbn0gZnJvbSAna3ItdWknO1xuaW1wb3J0ICcuL2luZGV4Lmxlc3MnO1xuXG4gY2xhc3MgU3RhcnRDYXJkQWN0aXZhdGlvbiBleHRlbmRzIENvbXBvbmVudHtcblxuXHQgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcblx0IFx0XHRzdGFnZTonaW1wb3J0TnVtJ1xuXG5cdCBcdH1cblx0IC8v6IqC54K555qE5pq06ZyyXG5cdCBzdGF0aWMgUHJvcFR5cGVzID0ge1xuXHRcdCBvblN1Ym1pdDpSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcblx0XHQgb25DYW5jZWw6UmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG5cdFx0IGRldGFpbDpSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LFxuXHRcdCAvKipcblx0XHQgICogc3RhZ2XooajnpLrmibnph4/kv67mlLnmiYDlpITnmoTpmLbmrrVcblx0XHQgICog5YWB6K645aGr5YWl55qE5YC85Li6IGltcG9ydE51bXx8IGFjdGl2ZUNhcmRcblx0XHQgICovXG5cdFx0IHN0YWdlOlJlYWN0LlByb3BUeXBlcy5zdHJpbmcsXG5cdCB9XG5cdC8v5pWw5o2u55qE5Yid5aeL5YyW6K6+5a6aXG5cdGNvbnN0cnVjdG9yKHByb3BzKXtcblx0XHRzdXBlcihwcm9wcyk7XG5cdCAgICB0aGlzLnN0YXRlPXtcblx0XHRcdFx0XHRkZXRhaWw6cHJvcHMuZGV0YWlsLFxuXHRcdFx0XHRcdGFjY29tcGxpc2g6ZmFsc2UsXG5cdFx0XHRcdFx0c3RhcnROdW06cHJvcHMuZGV0YWlsLmVuZE51bS1wcm9wcy5kZXRhaWwuc3RhcnROdW0sXG5cdFx0XHRcdFx0b2xkTnVtOnByb3BzLmRldGFpbC5lbmROdW0tcHJvcHMuZGV0YWlsLnN0YXJ0TnVtLFxuXHRcdFx0XHRcdGNsb3NlTWVzc2FnZUJhcjp7XG5cdFx0XHRcdFx0XHR0aXRsZTonJyxcblx0XHRcdFx0XHRcdG9wZW46ZmFsc2UsXG5cdFx0XHRcdFx0XHRzdHlsZTp7fSxcblx0XHRcdFx0XHRcdGNsYXNzTmFtZTonJ1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Y2xlYXJJbnRlckNvZGVTdHlsZTp7XG5cdFx0XHRcdFx0XHRkaXNwbGF5Oidub25lJ1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0bnVtOjAsXG5cdCAgICB9XG5cdH1cblx0IG9uU3VibWl0PSh2YWx1ZXMpPT57XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblx0IFx0aWYgKG5hdmlnYXRvci5vbkxpbmUpIFxuXHRcdHsgLy/mraPluLjlt6XkvZxcblx0XHR9IFxuXHRcdGVsc2UgeyAvL+aJp+ihjOemu+e6v+eKtuaAgeaXtueahOS7u+WKoVxuXHRcdCBcdFx0TWVzc2FnZS5lcnJvcihcIue9kee7nOW3suaWreW8gFwiKVxuXHRcdCBcdFx0cmV0dXJuO1xuXHRcdH0gXG5cblx0XHQgdmFyIGlzRXJyPWZhbHNlO1xuXHRcdCBjb25zdCBwYXJhbXM9e307XG5cdFx0IHBhcmFtcy5mb3JlaWduQ29kZT10aGlzLnN0YXRlLmRldGFpbC5zdGFydE51bTtcblx0XHQgcGFyYW1zLmludGVyQ29kZT12YWx1ZXMuaW50ZXJDb2RlO1xuXG5cdFx0IGlmKCF2YWx1ZXMuaW50ZXJDb2RlKXtcblxuXHRcdCBcdHJldHVybjtcblx0XHQgfVxuXHRcdCBpZih0aGlzLnN0YXRlLmFjY29tcGxpc2gpe1xuXG5cdFx0XHQgcmV0dXJuO1xuXHRcdCB9XG5cblx0XHR2YXIgcmVnPS9eWzAtOWEtZkEtRl17OH0kLztcblx0XHRpZiAodmFsdWVzLmludGVyQ29kZSYmIXJlZy50ZXN0KHZhbHVlcy5pbnRlckNvZGUpKSB7XG5cblxuXHRcdFx0TWVzc2FnZS5lcnJvcign5YaF56CB5Li6OOS9jTE26L+b5Yi25pWwJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0IFN0b3JlLmRpc3BhdGNoKEFjdGlvbnMuY2FsbEFQSSgnQ2FyZEFjdGl2YXRpb24nLCB7fSwgcGFyYW1zKSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRcdC8vICBNZXNzYWdlLnN1Y2Nlc3MoXCLmiJDlip9cIik7XG5cdFx0XHRcdFx0IGNvbnN0IGRldGFpbD17fTtcblx0XHRcdFx0XHQgZGV0YWlsLmludGVyQ29kZT1cIlwiO1xuXHRcdFx0XHRcdCBTdG9yZS5kaXNwYXRjaChpbml0aWFsaXplKCdTdGFydENhcmRBY3RpdmF0aW9uJyxkZXRhaWwpKTtcblx0XHRcdFx0XHQgX3RoaXMucHJvcHMub25GbHVzaCgpO1xuXHRcdFx0XHRcdCB2YXIgdGl0bGU9XCLkvJrlkZjljaFcIit2YWx1ZXMuaW50ZXJDb2RlK1wi5r+A5rS75oiQ5YqfXCI7XG5cdFx0XHRcdFx0X3RoaXMucHJvcHMub3Blbk1lc3NhZ2VCYXIodGl0bGUsXCJva1wiKTtcblx0XHRcdFx0XHRcblxuXHRcdFx0XHRcdCBpZiAoX3RoaXMuc3RhdGUuZGV0YWlsLnN0YXJ0TnVtPD1fdGhpcy5zdGF0ZS5kZXRhaWwuZW5kTnVtKSB7XG5cblx0XHRcdFx0XHRcdFx0IF90aGlzLmNhcmROdW1BZGQoNCk7XG5cdFx0XHRcdFx0IH1cblx0XHRcdFx0XHQgc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0X3RoaXMucHJvcHMuY2xvc2VNZXNzYWdlQmFyKCk7XG5cdFx0XHRcdFx0IH0sMTAwMClcblxuXHRcdCB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHQgXHRpZiAoZXJyLm1lc3NhZ2U9PVwi6K+l5Lya5ZGY5Y2h5bey6KKr5b2V5YWlXCIpIHtcblx0XHQgXHRcdGVyci5tZXNzYWdlPVwi5Y2h5Y+3XCIrX3RoaXMuc3RhdGUuZGV0YWlsLnN0YXJ0TnVtK1wi5bey5a2Y5Zyo6K+36Lez6L+H77yBXCJcblx0XHQgXHR9ZWxzZSBpZihlcnIubWVzc2FnZT09XCLor6XljaHlt7Looqvmv4DmtLss6K+36YeN5Yi3XCIpe1xuXHRcdCBcdFx0ZXJyLm1lc3NhZ2U9XCLkvJrlkZjljaFcIit2YWx1ZXMuaW50ZXJDb2RlK1wi5bey6KKr5r+A5rS777yM6K+35o2i5Y2h6YeN5Yi377yBXCJcblx0XHQgXHR9XG5cdFx0IFx0aWYoZXJyLm1lc3NhZ2U9PVwiRmFpbGVkIHRvIGZldGNoXCIpe1xuXHRcdCBcdFx0ZXJyLm1lc3NhZ2U9XCLov57mjqXkuI3liLDmnI3liqHlmaghXCI7XG5cdFx0IFx0XHRNZXNzYWdlLmVycm9yKGVyci5tZXNzYWdlKTtcblx0XHQgXHRcdHJldHVybjtcblx0XHQgXHR9XG5cdFx0XHRcblx0XHQgXHRfdGhpcy5wcm9wcy5vcGVuTWVzc2FnZUJhcihlcnIubWVzc2FnZSxcImVycm9yXCIpO1xuXHRcdCBcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdFx0X3RoaXMucHJvcHMuY2xvc2VNZXNzYWdlQmFyKCk7XG5cdFx0XHR9LDMwMDApXG5cdFx0IH0pXG5cdCB9XG5cblx0IC8v5pWw5a2X5aSE55CGXG5cdCBudW1oYW5kbGU9KG51bSxzdGFydCxlbmQpPT57XG5cdFx0IFx0bnVtPW51bS50b1N0cmluZygpO1xuXHRcdFx0bnVtPW51bS5zdWJzdHJpbmcoc3RhcnQsZW5kKTtcblx0XHRcdHJldHVybiBudW1cblx0IH1cblx0IC8v5Y2h5Y+35aKe5YqgXG5cdCBjYXJkTnVtQWRkPShsZW4pPT57XG5cdFx0IGxldCBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHt9LHRoaXMucHJvcHMuZGV0YWlsKTtcblx0XHQgdmFyIHN0YXJ0PXRoaXMuc3RhdGUuZGV0YWlsLnN0YXJ0TnVtLnN1YnN0cmluZygwLDYpLnRvU3RyaW5nKCk7XG5cdFx0IHZhciBudW09cGFyc2VJbnQodGhpcy5zdGF0ZS5kZXRhaWwuc3RhcnROdW0uc3Vic3RyaW5nKDYsMTApKTtcblx0XHQgXHRcdCBudW09bnVtKzE7XG5cdFx0IFx0XHQgbnVtPW51bS50b1N0cmluZygpO1xuXHRcdFx0XHQgaWYgKG51bS5sZW5ndGg8bGVuKSB7XG5cdFx0XHRcdCBcdGZvciAodmFyIGkgPSBudW0ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0bnVtPScwJytudW07XG5cdFx0XHRcdCBcdH1cblx0XHRcdFx0IH1cblx0XHRcdFx0IGlmICh0aGlzLnN0YXRlLmRldGFpbC5zdGFydE51bT09dGhpcy5zdGF0ZS5kZXRhaWwuZW5kTnVtKSB7XG5cdFx0XHRcdCBcdFxuXHRcdFx0XHQgXHR2YXIgb2xkTnVtPXRoaXMuc3RhdGUub2xkTnVtKzE7XG5cdFx0XHRcdCBcdGlmKHRoaXMuc3RhdGUuc3RhcnROdW09PXRoaXMuc3RhdGUubnVtKXtcblx0XHRcdFx0IFx0XHRvbGROdW09MDtcblx0XHRcdFx0IFx0fVxuXHRcdFx0XHRcdHRoaXMuc2V0U3RhdGUoe1xuXHQgXHRcdFx0XHQgXHRhY2NvbXBsaXNoOnRydWVcblx0IFx0XHRcdCBcdH0pXG5cdCBcdFx0XHQgXHRNZXNzYWdlLnN1Y2Nlc3Mob2xkTnVtK1wi5byg5Lya5ZGY5Y2h5r+A5rS75oiQ5Yqf77yBXCIpXG5cdCBcdFx0XHQgXHR0aGlzLm9uQ2FuY2VsKCk7XG5cdFx0XHRcdFx0ZGV0YWlsLnN0YXJ0TnVtPWRldGFpbC5lbmROdW09XCIwMDAwMDAwMDAwXCJcblxuXHRcdFx0XHQgfWVsc2V7XG5cdFx0XHRcdCBcdGRldGFpbC5zdGFydE51bT1zdGFydCtudW07XG5cdFx0XHRcdFx0ZGV0YWlsLmVuZE51bT10aGlzLnN0YXRlLmRldGFpbC5lbmROdW07XG5cdFx0XHRcdCB9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnNldFN0YXRlKHtcblx0XHRcdFx0XHRkZXRhaWw6ZGV0YWlsXG5cdFx0XHRcdH0pXG5cdCB9XG5cdCAvL+i3s+i/h+WPt+eggVxuXHQgc2tpcENhcmQ9KCk9Pntcblx0IFx0aWYgKCt0aGlzLnN0YXRlLmRldGFpbC5lbmROdW0hPTApIHtcblx0IFx0XHRjb25zdCBkZXRhaWw9e307XG5cdFx0XHRkZXRhaWwuaW50ZXJDb2RlPVwiXCI7XG5cdFx0XHR2YXIgbnVtPXRoaXMuc3RhdGUubnVtKzE7XG5cdFx0XHRTdG9yZS5kaXNwYXRjaChpbml0aWFsaXplKCdTdGFydENhcmRBY3RpdmF0aW9uJyxkZXRhaWwpKTtcblx0IFx0XHQgdGhpcy5zZXRTdGF0ZSh7XG5cdCBcdFx0IFx0b2xkTnVtOigrdGhpcy5zdGF0ZS5vbGROdW0pLTEsXG5cdCBcdFx0IFx0bnVtOm51bVxuXHQgXHRcdCB9KVxuXHRcdCBcdHRoaXMuY2FyZE51bUFkZCg0KTtcblx0XHQgfVxuXHQgfVxuXG5cdCAvL+WFs+mXreeql+WPo1xuXHQgb25DYW5jZWw9KCk9Pntcblx0XHQgY29uc3Qge29uQ2FuY2VsfSA9IHRoaXMucHJvcHM7XG5cdFx0b25DYW5jZWwgJiYgb25DYW5jZWwoKTtcblx0IH1cblx0IEludGVyQ29kZUZvY3VzPSh2YWx1ZXMpPT57XG5cdFx0aWYodHJ1ZSl7XG5cdFx0XHR0aGlzLnNldFN0YXRlKHtcblx0XHRcdFx0Y2xlYXJJbnRlckNvZGVTdHlsZTp7XG5cdFx0XHRcdFx0ZGlzcGxheTonYmxvY2snXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fVxuXHR9XG5cblx0Y2xlYXJJbnRlckNvZGU9KCk9Pntcblx0XHRjb25zdCBkZXRhaWw9e307XG5cdFx0ZGV0YWlsLmludGVyQ29kZT1cIlwiO1xuXHRcdFN0b3JlLmRpc3BhdGNoKGluaXRpYWxpemUoJ1N0YXJ0Q2FyZEFjdGl2YXRpb24nLGRldGFpbCkpO1xuXHRcdHRoaXMuc2V0U3RhdGUoe1xuXHRcdFx0XHRjbGVhckludGVyQ29kZVN0eWxlOntcblx0XHRcdFx0XHRkaXNwbGF5Oidub25lJ1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHR9XG5cdGNhcmRDaGFuZ2U9KHZhbHVlKT0+e1xuXHRcdFx0Y29uc29sZS5sb2coXCI5OTlcIilcblxuXHRcdHZhciBjUmVnPW5ldyBSZWdFeHAoXCJbXFxcXHU0RTAwLVxcXFx1OUZGRl0rXCIsXCJnXCIpO1xuXHRcdHZhciByZWc9L15bMC05YS1mQS1GXXs4fSQvO1xuXHRcdGlmKHZhbHVlLmxlbmd0aD44KXtcblx0XHRcdHZhbHVlPXZhbHVlLnNsaWNlKDgsdmFsdWUubGVuZ3RoKzEpO1xuXHRcdFx0Y29uc3QgZGV0YWlsPXt9O1xuXHRcdFx0ZGV0YWlsLmludGVyQ29kZT12YWx1ZTtcblx0XHRcdFN0b3JlLmRpc3BhdGNoKGluaXRpYWxpemUoJ1N0YXJ0Q2FyZEFjdGl2YXRpb24nLGRldGFpbCkpO1xuXG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmKGNSZWcudGVzdCh2YWx1ZSkpe1xuXHRcdFx0TWVzc2FnZS5lcnJvcign5Y2h5YaF56CB5YaF5ZCr5pyJ5Lit5paH6K+35YiH5o2i6Iux5paH6L6T5YWl5rOV77yBJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHR9XG5cblx0cmVuZGVyKCl7XG5cdFx0Y29uc3Qge1xuXHRcdFx0ZXJyb3IsXG5cdFx0XHRoYW5kbGVTdWJtaXQsXG5cdFx0XHRwcmlzdGluZSxcblx0XHRcdHJlc2V0LFxuXHRcdFx0dGhyb3dCYWNrXG5cdFx0fSA9IHRoaXMucHJvcHM7XG5cdFx0dmFyIG51bWJlcnM9K3RoaXMuc3RhdGUuZGV0YWlsLmVuZE51bT09MD8wOigrdGhpcy5zdGF0ZS5kZXRhaWwuZW5kTnVtKS0oK3RoaXMuc3RhdGUuZGV0YWlsLnN0YXJ0TnVtKSsxO1xuXHRcdHJldHVybiAoXG5cdFx0XHQ8Zm9ybSBjbGFzc05hbWU9XCJIZWF2aWx5QWN0aXZhdGlvblwiIG9uU3VibWl0PXtoYW5kbGVTdWJtaXQodGhpcy5vblN1Ym1pdCl9PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cImFjdGl2ZUltZ1wiID48L2Rpdj5cblx0XHRcdFx0PGRpdiBzdHlsZT17e3RleHRBbGlnbjpcInJpZ2h0XCIsd2lkdGg6MzQwLG1hcmdpbjpcImF1dG9cIixtYXJnaW5Ub3A6MTAsbWFyZ2luTGVmdDo1Mn19PlxuXHRcdFx0XHRcdFx0PGxhYmVsID57XCLkvJrlkZjljaHmlbDph486XCIrbnVtYmVycytcIuW8oFwifTwvbGFiZWw+XG5cdFx0XHRcdFx0XHQ8ZGl2IHN0eWxlPXt7aGVpZ2h0Oic2MHB4JyxtYXJnaW5Ub3A6XCIxNXB4XCIsbWFyZ2luTGVmdDpcIjRweFwifX0+XG5cdFx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3NOYW1lPVwiY2FyZE51bVwiPnt0aGlzLm51bWhhbmRsZSh0aGlzLnN0YXRlLmRldGFpbC5zdGFydE51bSwwLDQpfTwvc3Bhbj5cblx0XHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzc05hbWU9XCJjYXJkTnVtXCIgc3R5bGU9e3twYWRkaW5nOlwiMCAxMHB4XCJ9fT57dGhpcy5udW1oYW5kbGUodGhpcy5zdGF0ZS5kZXRhaWwuc3RhcnROdW0sNCw2KX08L3NwYW4+XG5cdFx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3NOYW1lPVwiY2FyZE51bSBub3JtYWxcIj57dGhpcy5udW1oYW5kbGUodGhpcy5zdGF0ZS5kZXRhaWwuc3RhcnROdW0sNiwxMCl9PC9zcGFuPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8bGFiZWwgY2xhc3NOYW1lPVwianVtcFwiIG9uQ2xpY2s9e3RoaXMuc2tpcENhcmR9IHN0eWxlPXt7Zm9udFNpemU6XCIxNHB4XCJ9fSA+6Lez6L+H6K+l5Y+356CBPC9sYWJlbD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3NOYW1lPVwiY2xlYXJJbnRlckNvZGVcIiBzdHlsZT17e21hcmdpbkxlZnQ6XCItNHB4XCIsbWFyZ2luUmlnaHQ6XCI0cHhcIn19PlxuXHRcdFx0XHRcdDxLckZpZWxkICBsZWZ0PXs3MX0gcmlnaHQ9ezcxfSBuYW1lPVwiaW50ZXJDb2RlXCIgIHR5cGU9XCJ0ZXh0XCIgb25Gb2N1cz17dGhpcy5JbnRlckNvZGVGb2N1c30gb25DaGFuZ2U9e3RoaXMuY2FyZENoYW5nZX0gYXV0b0ZvY3VzPXt0cnVlfS8+XG5cdFx0XHRcdFx0PGRpdiBjbGFzc05hbWU9XCJzdGFydFhcIiBzdHlsZT17dGhpcy5zdGF0ZS5jbGVhckludGVyQ29kZVN0eWxlfSBvbkNsaWNrPXt0aGlzLmNsZWFySW50ZXJDb2RlfT48L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cblxuXHRcdFx0XHQ8R3JpZCBzdHlsZT17e21hcmdpblRvcDoxOCxtYXJnaW5Cb3R0b206NX19PlxuXHRcdFx0XHRcdDxSb3c+XG5cdFx0XHRcdFx0XHQ8Q29sIG1kPXsxMn0gYWxpZ249XCJjZW50ZXJcIj5cblx0XHRcdFx0XHRcdFx0PEJ1dHRvbkdyb3VwPlxuXHRcdFx0XHRcdFx0XHR7dGhpcy5zdGF0ZS5hY2NvbXBsaXNoJiY8ZGl2ICBjbGFzc05hbWU9J3VpLWJ0bi1jZW50ZXInIHN0eWxlPXt7bWFyZ2luTGVmdDoyN319PjxCdXR0b24gIGxhYmVsPVwi5a6M5oiQXCIgdHlwZT1cInN1Ym1pdFwiIGJhY2tncm91bmRDb2xvcj17dGhpcy5zdGF0ZS5hY2NvbXBsaXNoP1wiIzQ5OWRmMVwiOlwiI2NjY2NjY1wifSBvblRvdWNoVGFwPXt0aGlzLm9uQ2FuY2VsfSAvPjwvZGl2Pn1cblx0XHRcdFx0XHRcdFx0eyF0aGlzLnN0YXRlLmFjY29tcGxpc2gmJjxCdXR0b24gIGxhYmVsPVwi6L+U5ZueXCIgdHlwZT1cImJ1dHRvblwiIGNhbmNsZT17dHJ1ZX0gb25Ub3VjaFRhcD17dGhyb3dCYWNrfSAvPn1cblx0XHRcdFx0XHRcdFx0PC9CdXR0b25Hcm91cD5cblx0XHRcdFx0XHRcdDwvQ29sPlxuXHRcdFx0XHRcdDwvUm93PlxuXHRcdFx0XHQ8L0dyaWQ+XG5cdFx0XHRcdFxuXHRcdFx0XHRcblx0XHRcdDwvZm9ybT5cblx0XHQpO1xuXHR9XG59XG5jb25zdCB2YWxpZGF0ZSA9IHZhbHVlcyA9Pntcblx0XHRcblx0XHRjb25zdCBlcnJvcnMgPSB7fVxuXHRcdHZhciByZWc9L15bMC05YS1mQS1GXXs4fSQvO1xuXHRcdGNvbnNvbGUubG9nKFwiMTIzM1wiKVxuXHRcdGlmICghcmVnLnRlc3QodmFsdWVzLmludGVyQ29kZSkpIHtcblx0XHRcdGVycm9ycy5pbnRlckNvZGU9J+WGheeggeS4ujjkvY0xNui/m+WItuaVsCc7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBlcnJvcnNcblx0fVxuY29uc3Qgc2VsZWN0b3IgPSBmb3JtVmFsdWVTZWxlY3RvcignU3RhcnRDYXJkQWN0aXZhdGlvbicpO1xuXG5cblxuZXhwb3J0IGRlZmF1bHQgcmVkdXhGb3JtKHsgZm9ybTogJ1N0YXJ0Q2FyZEFjdGl2YXRpb24nLCB2YWxpZGF0ZSxlbmFibGVSZWluaXRpYWxpemU6dHJ1ZSwga2VlcERpcnR5T25SZWluaXRpYWxpemU6dHJ1ZSB9KShTdGFydENhcmRBY3RpdmF0aW9uKTtcbiJdfQ==