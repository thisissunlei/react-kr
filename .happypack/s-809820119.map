{"version":3,"sources":["src/Containers/Operation/CommunityManage/Detail/Schedule/ItemTable.js"],"names":["ItemTable","props","context","onStation","bind","onDismantlingDialog","renderOrder","onhref","state","detail","Dismantling","currentYear","contractTypeVo","nextProps","isEqual","setState","onDismantling","activity","window","open","companyId","communityId","show","orderKind","type","name","kind","billId","billName","contractList","borderLeft","orderStaionNum","width","map","item","index","order","value","contractType","orderDetail","customId","id","valid","leaseBegindate","leaseEnddate","stationNum","meetingNum","_this","dispatch","callAPI","then","response","catch","err","message","communityids","getShowData","contractInstallmentplanVo","finaBluePointVo","finaRedPointVo","whiteBar","PropTypes","func","isLoading","bool"],"mappings":"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","file":"ItemTable.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, { Component, PropTypes } from 'react';\nimport { connect } from 'kr/Redux';\nimport { reduxForm, submitForm, change, reset } from 'redux-form';\nimport { Actions, Store } from 'kr/Redux';\n\nimport { Tabs, Tab, Dialog, Section, Grid, Button, Notify, BreadCrumbs, Tooltip } from 'kr-ui';\n\nimport './index.less';\nimport _ from 'lodash';\n\nimport { findDOMNode } from 'react-dom'\nimport ReactTooltip from 'react-tooltip'\nimport EmployessTable from './EmployessTable';\nimport D3Content from './D3Content';\nimport DismantlingForm from './DismantlingForm';\n\nimport dateFormat from 'dateformat';\n\nexport default class ItemTable extends Component {\n\n\n  static PropTypes = {\n    onDismantling: React.PropTypes.func,\n    onStation: React.PropTypes.func,\n    isLoading: React.PropTypes.bool,\n  }\n\n\n  constructor(props, context) {\n    super(props, context);\n    this.onStation = this.onStation.bind(this);\n    this.onDismantlingDialog = this.onDismantlingDialog.bind(this);\n    // this.onDismantling = this.onDismantling.bind(this);\n    this.renderOrder = this.renderOrder.bind(this);\n    this.onhref = this.onhref.bind(this);\n    this.state = {\n      detail: this.props.detail,\n      //activity: false,\n      Dismantling: false,\n      currentYear: '2016',\n      contractTypeVo:[]\n\n    }\n\n  }\n\n\n  componentWillReceiveProps(nextProps) {\n    if (!_.isEqual(this.props.detail, nextProps.detail)) {\n      this.setState({\n        detail: nextProps.detail\n      });\n    }\n  }\n\n  componentDidMount() {\n\n    }\n    //撤场\n  onDismantling(detail) {\n      const {\n        onDismantling\n      } = this.props;\n      onDismantling && onDismantling(detail);\n    }\n    //分配工位\n  onStation() {\n    let {detail} = this.state;\n    detail.activity = !detail.activity;\n    this.setState({\n      detail\n    })\n    let {onStation} = this.props;\n    onStation && onStation()\n\n\n  }\n  onDismantlingDialog() {\n    this.setState({\n      Dismantling: !this.state.Dismantling\n    })\n\n  }\n\n\n  //查看员工跳转地址\n  onhref() {\n    window.open(\"/new/#/community/companyMembers/\" + this.state.detail.companyId + \"/list/\" + this.state.detail.communityId);\n  }\n\n  renderOrder() {\n\n    let {show, detail, contractTypeVo} = this.state;\n    let orderKind= [\n      {type:'INTENTION',name:'意向协议书',kind:'admit'},\n      {type:'ENTER',name:'入驻协议书',kind:'join'},\n      {type:'ADDRENT',name:'增租协议书',kind:'increase'},\n      {type:'RENEW',name:'续租租协议书',kind:'renew'},\n      {type:'LESSRENT',name:'减租协议书',kind:'reduce'},\n      {type:'QUITRENT',name:'退租协议书',kind:'exit'},\n    ]\n    return (\n        <Tooltip place=\"right\" type=\"dark\" effect=\"solid\" offsetRight={10} id={`${detail.billId}${detail.billName}`}>\n          <ul>\n            {contractTypeVo.contractList?<li style={{borderLeft:'none'}}>所有工位数：{contractTypeVo.orderStaionNum}个</li>:<div style={{width:'220px'}}>数据加载中...请耐心等候</div>}\n           {contractTypeVo.contractList && contractTypeVo.contractList.map((item, index) => {\n                let order = {};\n                orderKind.map((value)=>{\n                  if(value.type == item.contractType){\n                    return order = value;\n                  }\n                })\n                let orderDetail = `#/operation/customerManage/${item.customId}/order/${detail.billId}/agreement/${order.kind}/${item.id}/detail`\n                if (!item.valid) {\n                  return (\n                        <li key={index} className=\"company-order-zero\" key={index}>\n                         <p className=\"name\">{order.name}</p>\n                         <p className=\"zero-circle\">{dateFormat(item.leaseBegindate,'yyyy.mm.dd')}-{dateFormat(item.leaseEnddate ,'yyyy.mm.dd')} <a href={orderDetail} target=\"_blank\">查看详情</a></p>\n                         <p>工位：{item.stationNum}个 &nbsp;&nbsp;会议室：{item.meetingNum}个</p>\n                        </li>\n                      \n                  )\n                } else {\n                  return (\n                      <li key={index} className=\"company-order\" key={index}>\n                        <p className=\"name\">{order.name}</p>\n                        <p className=\"zero-circle\">{dateFormat(item.leaseBegindate,'yyyy.mm.dd')}-{dateFormat(item.leaseEnddate ,'yyyy.mm.dd')} <a href={orderDetail} target=\"_blank\">查看详情</a></p>\n                        <p>工位：{item.stationNum}个 &nbsp;&nbsp;会议室：{item.meetingNum}个</p>\n                      </li>\n                  )\n                }\n              })\n          }\n          </ul>\n        </Tooltip>\n      )\n  }\n  getShowData(billId){\n    let _this =this;\n    Store.dispatch(Actions.callAPI('getBillContract',{billId:billId}))\n      .then(function(response) {\n      _this.setState({\n        contractTypeVo:response,\n      },function(){\n        this.renderOrder()\n      });\n    }).catch(function(err) {\n      Notify.show([{\n        message: err.message,\n        type: 'danger',\n      }]);\n    });\n  }\n\n  \n  render() {\n    let {show, detail, contractTypeVo} = this.state;\n    let {communityids, activity, width, currentYear} = this.props;\n    var _this = this;\n    var id = communityids;\n    return (\n      <tr className=\"last-td\"   >\n\t\t\t\t\t\t<td className=\"company-list\">\n\t\t\t\t\t\t\t<div className=\"company-name\" onMouseOver={this.getShowData.bind(this,detail.billId)}> \n              {\n                detail.billName\n              }\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.renderOrder()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td colSpan=\"12\">\n              <D3Content detail={detail.contractInstallmentplanVo} finaBluePointVo={detail.finaBluePointVo} finaRedPointVo={detail.finaRedPointVo} whiteBar={detail.whiteBar} id={detail.billId} currentYear={currentYear}/>\n              <EmployessTable  activity={detail.activity} detail={detail} id={id} />\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td className=\"btnlist\">\n                 <div className=\"btnCon\">\n      \t\t\t\t\t\t\t<div className=\"Station\"  onTouchTap={this.onStation}   >\n                      <div className=\"tip hide  hover\">\n                         分配工位 < span className = \"bArrow\" > < /span>\n                      </div>\n                    </div>\n                      \n      \t\t\t\t\t    <div className=\"Dismantling\" onClick={this.onDismantling.bind(this,detail)}> \n                        <div className=\"tip hide hover \">\n                             撤场日期 <span className = \"bArrow\"></span>\n                       </div>\n                    </div>\n                        \n        \t\t\t\t\t\t<div className=\"Preson\"  onTouchTap={this.onhref}>\n                      <div className=\"tip hide  hover\">\n                            查看员工 <span className = \"bArrow\"></span>\n                      </div>\n                    </div>\n                  </div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n    );\n  }\n}"]}