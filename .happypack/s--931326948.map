{"version":3,"sources":["src/Containers/Member/MemberManage/Card/UsingCard.js"],"names":["ImportCard","props","onCancel","onSubmit","values","params","startForeignCode","begin","endForeignCode","end","receiveId","user","communityId","community","dispatch","callAPI","then","response","console","log","catch","err","error","message","setBeginCard","person","endCard","state","count","warntimeout","setState","beginCard","setEndCard","communityText","companyText","selectSourceOption","searchForm","searchParams","handleSubmit","pristine","reset","content","filter","margin","marginTop","width","textAlign","padding","paddingRight","paddingLeft","validate","errors","length","isNaN","form","enableReinitialize","keepDirtyOnReinitialize"],"mappings":"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","file":"UsingCard.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["\nimport React, {Component, PropTypes} from 'react';\nimport {connect} from 'kr/Redux';\nimport {reduxForm,formValueSelector,change,initialize,arrayPush,arrayInsert,FieldArray,reset} from 'redux-form';\nimport {Actions,Store} from 'kr/Redux';\nimport {\n\tKrField,\n\tGrid,\n\tRow,\n\tCol,\n\tButton,\n\tNotify,\n\tButtonGroup,\n  ListGroup,\n  ListGroupItem,\n\tSearchForm,\n\tMessage,\n} from 'kr-ui';\nimport dateFormat from 'dateformat';\nimport $ from 'jquery'\nclass ImportCard extends Component{\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.state={\n\t\t\tbeginCard:0,\n\t\t\tendCard:0,\n\t\t\tcount:'0',\n\t\t\tcommunityText:'',\n\t\t\tcompanyText:'',\n\t\t\tselectSourceOption:[],\n\t\t\tsearchForm:false,\n\t\t\tsearchParams:{\n\n\t\t\t},\n\t\t}\n\t}\n\tonCancel=()=>{\n\t\tlet {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t}\n\t onSubmit=(values)=>{\n\t \tlet params = {\n\t \t\tstartForeignCode:values.begin,\n\t \t\tendForeignCode:values.end,\n\t \t\treceiveId:values.user,\n\t \t\tcommunityId:values.community\n\t \t}\n\t \tconst {onSubmit} = this.props;\n\t \tStore.dispatch(Actions.callAPI('memberCardUse',{}, params)).then(function(response) {\n\t\t\tconsole.log('response',response);\n\t\t\tonSubmit && onSubmit(values);\n\t\t}).catch(function(err) {\n\t\t \tMessage.error(err.message);\n\t\t});\n\t\t \n\t\t \n\t }\n\t setBeginCard=(person)=>{\n\t \tlet {endCard} = this.state;\n\t \tlet count = '0';\n\t \tif(endCard){\n\t \t\tcount = endCard - person;\n\t \t}\n\t \tif(count<0){\n\t \t\tcount = '0';\n\t \t\tMessage.warntimeout('起始号码不能小于终止号码','error');\n\t \t\t\n\t \t}\n\t \tthis.setState({\n\t \t\tbeginCard:person,\n\t \t\tcount:count\n\t \t})\n\t }\n\t setEndCard=(person)=>{\n\t \tlet {beginCard} = this.state;\n\t \tlet count = '0';\n\t \tif(beginCard){\n\t \t\tcount = person - beginCard;\n\t \t}\n\t \tif(count<0){\n\t \t\tcount = '0';\n\t \t\tMessage.warntimeout('起始号码不能小于终止号码','error');\n\t \t\t\n\t \t}\n\t \tthis.setState({\n\t \t\tendCard:person,\n\t \t\tcount:count\n\t \t})\n\t }\n\n\trender(){\n\t\tconst { error, handleSubmit, pristine, reset,content,filter} = this.props;\n\t\tlet communityText = '';\n\t\tlet {count} =this.state;\n\t\tcount = count === '0'?'0':count+1;\n\t\treturn (\n\t\t\t<form onSubmit={handleSubmit(this.onSubmit)} style={{margin:'0 40px',marginTop:'37px'}}>\n\t\t\t\t<KrField name=\"community\" component=\"searchCommunity\" label=\"社区\"/>\n\t\t\t\t<KrField name=\"user\" component=\"searchPersonel\" label=\"领用人\"/>\n\t\t\t\t<KrField name=\"begin\" type=\"text\" component=\"input\" label=\"起始号码\" onBlur={this.setBeginCard}/>\n\t\t\t\t<KrField name=\"end\" type=\"text\"  grid={1/1} component=\"input\" label=\"终止号码\" onBlur={this.setEndCard}/>\n\t\t\t\t<KrField name=\"count\"  grid={1/1} component=\"labelText\" label=\"数量\" value={count}/>\n\t\t\t\t<Grid style={{margin:\"20px 0 3px -10px\"}}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t<ListGroupItem style={{width:'165px',textAlign:'right',padding:0,paddingRight:15}}><Button  label=\"确定\" type=\"submit\"/></ListGroupItem>\n\t\t\t\t\t\t\t<ListGroupItem style={{width:'150px',textAlign:'left',padding:0,paddingLeft:15}}><Button  label=\"取消\" type=\"button\"  cancle={true} onTouchTap={this.onCancel} /></ListGroupItem>\n\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t</Row>\n\t\t\t\t</Grid>\n\t\t  </form>\n\t\t);\n\t}\n}\nconst validate = values => {\n\n\tconst errors = {}\n\n\t\n\tif (!values.community) {\n\t\terrors.community = '请选择社区';\n\t}\n\tif (!values.user) {\n\t\terrors.user = '请选择领用人';\n\t}\n\tif(values.begin && values.begin.length!=10){\n\t\terrors.begin = '请输入10位会员卡号';\n\t}\n\tif (isNaN(+values.begin) ) {\n\t\terrors.begin = '请输入数字';\n\n\t}\n\tif (!values.begin) {\n\t\terrors.begin = '请填写起始号码';\n\t}\n\n\n\t\n\tif(values.end && values.end.length!=10){\n\t\terrors.end = '请输入10位会员卡号';\n\t}\n\tif (isNaN(+values.end) ) {\n\t\terrors.end = '请输入数字';\n\n\t}\n\tif (!values.end) {\n\t\terrors.end = '请填写终止号码';\n\t}\n\n\t\n\n\treturn errors\n}\n\nexport default ImportCard = reduxForm({\n\tform: 'ImportCardForm',\n\tvalidate,\n\tenableReinitialize: true,\n\tkeepDirtyOnReinitialize: true,\n})(ImportCard);\n"]}