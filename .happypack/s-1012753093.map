{"version":3,"sources":["src/Containers/Member/MemberManage/Card/ImportCard.js"],"names":["ImportCard","props","onCancel","onSubmit","values","params","startForeignCode","begin","endForeignCode","end","dispatch","callAPI","then","response","catch","err","error","message","setBeginCard","person","endCard","state","count","warntimeout","setState","beginCard","setEndCard","communityText","companyText","selectSourceOption","searchForm","searchParams","handleSubmit","pristine","reset","content","filter","margin","marginTop","width","textAlign","padding","paddingRight","paddingLeft","fontSize","color","marginLeft","validate","errors","length","isNaN","form","enableReinitialize","keepDirtyOnReinitialize"],"mappings":"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","file":"ImportCard.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["\nimport React, {Component, PropTypes} from 'react';\nimport {connect} from 'kr/Redux';\nimport {reduxForm,formValueSelector,change,initialize,arrayPush,arrayInsert,FieldArray,reset} from 'redux-form';\nimport {Actions,Store} from 'kr/Redux';\nimport {\n\tKrField,\n\tGrid,\n\tRow,\n\tCol,\n\tButton,\n\tNotify,\n\tButtonGroup,\n  ListGroup,\n  ListGroupItem,\n\tSearchForm,\n\tMessage,\n} from 'kr-ui';\nimport dateFormat from 'dateformat';\nimport $ from 'jquery'\nclass ImportCard extends Component{\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.state={\n\t\t\tbeginCard:0,\n\t\t\tendCard:0,\n\t\t\tcount:'0',\n\t\t\tcommunityText:'',\n\t\t\tcompanyText:'',\n\t\t\tselectSourceOption:[],\n\t\t\tsearchForm:false,\n\t\t\tsearchParams:{\n\n\t\t\t},\n\t\t}\n\t}\n\tonCancel=()=>{\n\t\tlet {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t}\n\t onSubmit=(values)=>{\n\t \tlet params = {\n\t \t\tstartForeignCode:values.begin,\n\t \t\tendForeignCode:values.end\n\t \t};\n\t \tconst {onSubmit} = this.props;\n\t \tStore.dispatch(Actions.callAPI('memberCardImport' , params)).then(function(response) {\n\t\t \tonSubmit && onSubmit(values);\n\t\t}).catch(function(err) {\n\t\t \tMessage.error(err.message);\n\t\t});\n\t }\n\t setBeginCard=(person)=>{\n\t \tlet {endCard} = this.state;\n\t \tlet count = '0';\n\t \tif(endCard){\n\t \t\tcount = endCard - person;\n\t \t}\n\t \tif(count<0){\n\t \t\tcount = '0';\n\t \t\tMessage.warntimeout('起始号码不能小于终止号码','error');\n\t \t\t\n\t \t}\n\t \tthis.setState({\n\t \t\tbeginCard:person,\n\t \t\tcount:count\n\t \t})\n\t }\n\t setEndCard=(person)=>{\n\t \tlet {beginCard} = this.state;\n\t \tlet count = '0';\n\t \tif(beginCard){\n\t \t\tcount = person - beginCard;\n\t \t}\n\t \tif(count<0){\n\t \t\tcount = '0';\n\t \t\tMessage.warntimeout('起始号码不能小于终止号码','error');\n\t \t\t\n\t \t}\n\t \tthis.setState({\n\t \t\tendCard:person,\n\t \t\tcount:count\n\t \t})\n\t }\n\n\trender(){\n\t\tconst { error, handleSubmit, pristine, reset,content,filter} = this.props;\n\t\tlet communityText = '';\n\t\tlet {count} =this.state;\n\t\tcount = count==='0'?'0':count+1;\n\n\t\treturn (\n\t\t\t<form onSubmit={handleSubmit(this.onSubmit)} style={{margin:'0 40px',marginTop:'37px'}}>\n\t\t\t\t<KrField name=\"begin\" type=\"text\" component=\"input\" component=\"input\" label=\"起始号码\" onBlur={this.setBeginCard}/>\n\t\t\t\t<KrField name=\"end\"  grid={1/1} type=\"text\" component=\"input\" label=\"终止号码\" onBlur={this.setEndCard}/>\n\t\t\t\t<KrField name=\"count\"  grid={1/1} component=\"labelText\" label=\"数量\" value={count}/>\n\t\t\t\t<Grid style={{margin:\"20px 0 3px -10px\"}}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t<ListGroupItem style={{width:'180px',textAlign:'right',padding:0,paddingRight:15}}><Button  label=\"确定\" type=\"submit\"/></ListGroupItem>\n\t\t\t\t\t\t\t\t<ListGroupItem style={{width:'150px',textAlign:'left',padding:0,paddingLeft:15}}><Button  label=\"取消\" type=\"button\"  cancle={true} onTouchTap={this.onCancel} /></ListGroupItem>\n\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t</Row>\n\t\t\t\t</Grid>\n\t\t\t\t<div style={{fontSize:'12px',color:'#333',marginTop:15,marginLeft:10}}>\n\t\t\t\t\t<p>注意：</p>\n\t\t\t\t\t<p>1.导入会员卡必须连号导入，已导入的会员卡不能重复导入</p>\n\t\t\t\t\t<p>2.已导入并未领用的会员卡，可在会员卡管理中进行删除操作</p>\n\t\t\t\t</div>\n\t\t  </form>\n\t\t);\n\t}\n}\nconst validate = values => {\n\n\tconst errors = {}\n\n\t\n\tif(values.begin && values.begin.length!=10){\n\t\terrors.begin = '请输入10位会员卡号';\n\t}\n\tif (isNaN(+values.begin) ) {\n\t\terrors.begin = '请输入数字';\n\n\t}\n\tif (!values.begin) {\n\t\terrors.begin = '请填写起始号码';\n\t}\n\n\n\t\n\tif(values.end && values.end.length!=10){\n\t\terrors.end = '请输入10位会员卡号';\n\t}\n\tif (isNaN(+values.end) ) {\n\t\terrors.end = '请输入数字';\n\n\t}\n\tif (!values.end) {\n\t\terrors.end = '请填写终止号码';\n\t}\n\n\t\n\n\treturn errors\n}\n\nexport default ImportCard = reduxForm({\n\tform: 'ImportCardForm',\n\tvalidate,\n\tenableReinitialize: true,\n\tkeepDirtyOnReinitialize: true,\n})(ImportCard);\n"]}