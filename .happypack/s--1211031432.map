{"version":3,"sources":["src/Containers/Operation/CustomerManage/Agreement/Renew/Edit/index.js"],"names":["JoinCreate","props","context","openConfirmCreateDialog","bind","onCreateSubmit","onCancel","state","stationVos","initialValues","optionValues","formValues","openConfirmCreate","dispatch","params","console","log","callAPI","then","response","show","message","type","location","href","customerId","orderId","contractId","catch","err","window","setState","_this","mainBillId","communityId","contractstate","mainbillid","signdate","Date","getTime","communityAddress","customer","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","customerName","communityName","communityid","mainbillCommunityId","lessorContactName","contractFileList","leaseId","contractcode","leaseContact","leaseContacttel","lessorContactid","firstpaydate","paymodel","totaldeposit","paytype","rentaluse","contractmark","totalrent","contractVersionType","contractVersion","rentamount","lessorContacttel","leaseBegindate","leaseEnddate","onConfrimSubmit","contextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["import React, {\n  Component,\n  PropTypes\n} from 'react';\nimport {\n  reduxForm,\n  submitForm,\n  change,\n  reset\n} from 'redux-form';\nimport {\n  Actions,\n  Store\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n  Dialog,\n  Section,\n  Grid,\n  Notify,\n  BreadCrumbs,\n  Title,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport ConfirmFormDetail from './ConfirmFormDetail';\nimport './index.less';\n\nexport default class JoinCreate extends Component {\n\n  static contextTypes = {\n    params: React.PropTypes.object.isRequired\n  }\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.openConfirmCreateDialog = this.openConfirmCreateDialog.bind(this);\n    this.onCreateSubmit = this.onCreateSubmit.bind(this);\n    this.onCancel = this.onCancel.bind(this);\n\n    this.state = {\n      stationVos: [],\n      initialValues: {},\n      optionValues: {},\n      formValues: {},\n      openConfirmCreate: false\n    }\n\n    Store.dispatch(reset('reduceCreateForm'));\n\n  }\n\n  onCreateSubmit(formValues) {\n    let {\n      params\n    } = this.props;\n    console.log('dasdasdasd');\n\n    Store.dispatch(Actions.callAPI('addOrEditContinueContract', {}, formValues)).then(function(response) {\n      Notify.show([{\n        message: '更新成功',\n        type: 'success',\n      }]);\n      location.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/renew/\" + response.contractId + \"/detail\";\n\n    }).catch(function(err) {\n      Notify.show([{\n        message: err.message,\n        type: 'danger',\n      }]);\n    });\n  }\n\n  onCancel() {\n    let {\n      params\n    } = this.context;\n    window.location.href = `./#/operation/customerManage/${params.customerId}/order/${params.orderId}/detail`;\n  }\n\n  openConfirmCreateDialog() {\n    this.setState({\n      openConfirmCreate: !this.state.openConfirmCreate\n    });\n  }\n\n  componentDidMount() {\n\n    var _this = this;\n    const {\n      params\n    } = this.props;\n    let initialValues = {};\n    let optionValues = {};\n    let stationVos = [];\n\n    Store.dispatch(Actions.callAPI('fina-contract-intention', {\n      customerId: params.customerId,\n      mainBillId: params.orderId,\n      communityId: 1\n    })).then(function(response) {\n\n      initialValues.contractstate = 'UNSTART';\n      initialValues.mainbillid = params.orderId;\n\n      initialValues.signdate = +new Date((new Date()).getTime() - 24 * 60 * 60 * 1000);\n\n      optionValues.communityAddress = response.customer.communityAddress;\n      optionValues.leaseAddress = response.customer.customerAddress;\n      //合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n      initialValues.contracttype = 'RENEW';\n\n      optionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.corporationName;\n        return item;\n      });\n      optionValues.paymentList = response.payment.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.dicName;\n        return item;\n      });\n      optionValues.payTypeList = response.payType.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.dicName;\n        return item;\n      });\n\n      optionValues.floorList = response.customer.floor;\n      optionValues.customerName = response.customer.customerName;\n      optionValues.leaseAddress = response.customer.customerAddress;\n      optionValues.communityName = response.customer.communityName;\n      optionValues.communityId = response.customer.communityid;\n      optionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n      Store.dispatch(Actions.callAPI('renewshow', {\n        id: params.id\n      })).then(function(response) {\n\n\n        optionValues.lessorContactName = response.lessorContactName;\n\n        optionValues.contractFileList = response.contractFileList;\n\n        initialValues.id = response.id;\n        initialValues.leaseId = response.leaseId;\n        initialValues.contractcode = response.contractcode;\n        initialValues.leaseAddress = response.leaseAddress;\n        initialValues.lessorContactName = response.lessorContactName;\n        initialValues.leaseContact = response.leaseContact;\n        initialValues.leaseContacttel = response.leaseContacttel;\n        initialValues.lessorContactid = response.lessorContactid;\n        initialValues.firstpaydate = response.firstpaydate;\n        initialValues.payType = response.payType.id\n        initialValues.paymodel = response.payment.id;\n        initialValues.totaldeposit = response.totaldeposit;\n        initialValues.paytype = response.payType.id;\n        initialValues.rentaluse = response.rentaluse;\n        initialValues.contractmark = response.contractmark;\n        initialValues.totalrent = response.totalrent;\n        initialValues.contractVersionType = response.contractVersion;\n        if (response.rentamount) {\n          rentamount = response.rentamount;\n          _this.setState({\n            rentamount\n          });\n\n        }\n        initialValues.lessorContacttel = response.lessorContacttel;\n\n        //时间\n        initialValues.firstpaydate = new Date(response.firstpaydate);\n        initialValues.signdate = new Date(response.signdate);\n        initialValues.leaseBegindate = new Date(response.leaseBegindate);\n        initialValues.leaseEnddate = new Date(response.leaseEnddate);\n\n        console.log('时间', initialValues);\n\n\n        //处理stationvos\n        stationVos = response.stationVos;\n\n        console.log(stationVos, '---->>>>', response);\n\n        _this.setState({\n          initialValues,\n          optionValues,\n          stationVos,\n        });\n\n      }).catch(function(err) {\n        console.log(err);\n        Notify.show([{\n          message: '后台出错请联系管理员',\n          type: 'danger',\n        }]);\n      });\n\n\n    }).catch(function(err) {\n      console.log('------', err);\n      Notify.show([{\n        message: '后台出错请联系管理员',\n        type: 'danger',\n      }]);\n    });\n\n  }\n\n\n  render() {\n\n    let {\n      initialValues,\n      optionValues,\n      stationVos\n    } = this.state;\n\n    return (\n\n      <div>\n        \t<Title value=\"编辑续租协议书_财务管理\"/>\n      <BreadCrumbs children={['系统运营','客户管理','续租协议']}/>\n      <Section title=\"续租协议书\" description=\"\">\n          <NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos}/>\n      </Section>\n\n      <Dialog\n        title=\"确定新建\"\n        modal={true}\n        autoScrollBodyContent={true}\n        autoDetectWindowHeight={true}\n        open={this.state.openConfirmCreate} onClose={this.openConfirmCreateDialog}>\n            <ConfirmFormDetail detail={this.state.formValues} onSubmit={this.onConfrimSubmit} onCancel={this.openConfirmCreateDialog} />\n        </Dialog>\n    </div>\n    );\n  }\n}"]}