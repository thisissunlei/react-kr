{"version":3,"sources":["src/Containers/Operation/CommunityManage/Detail/FloorPlan/index.js"],"names":["FloorPlan","props","context","firstDate","personel","Date","date","state","dateend","endDate","start","getTime","end","setState","show","message","type","dispatch","secondDate","_this","getStationUrl","bind","onSubmit","scrollLoad","onLoad","iframeWindow","form","floors","community","communityIdList","communityInfoFloorList","url","getcommunity","selectCommunity","getCommunityFloors","selectFloors","nextProps","formList","params","communityId","wherefloor","Object","keys","length","item","hasOwnProperty","replace","that","datastart","parse","dataend","window","top","scrollTop","height","num","document","scrollBottom","isOutBoundary","pagequery","callAPI","then","response","communityInfoList","map","index","value","id","label","name","unshift","catch","err","parseInt","obj","communityLabel","tab","handleSubmit","unbind","margin","paddingBottom","textAlign","display","lineHeight","maxWidth","marginTop","minWidth","width","marginLeft","getState","defaultProps"],"mappings":"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","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\tconnect\n} from 'kr/Redux';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\nimport $ from 'jquery';\nimport dateFormat from 'dateformat';\nimport DatePicker from 'material-ui/DatePicker';\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tForm,\n\tNotify,\n\tKrField,\n\tBreadCrumbs,\n\tIframeContent,\n\tButton,\n\tRow,\n\tCol,\n\tListGroup,\n\tListGroupItem\n} from 'kr-ui';\nimport {\n\treduxForm,\n\tformValueSelector,\n\tinitialize,\n\tarrayPush,\n\tarrayInsert,\n\tFieldArray,\n\tchange\n} from 'redux-form';\n\n\nexport default class FloorPlan extends Component {\n\t// static contextTypes = {\n\t// \tonSetCommunity: React.PropTypes.func.isRequired,\n\t// \tcommunityId: React.PropTypes.string.isRequired,\n\t// }\n\tstatic defaultProps = {\n\t\ttab: '',\n\t}\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\t\tlet _this = this;\n\t\tthis.getStationUrl = this.getStationUrl.bind(this);\n\t\tthis.onSubmit = this.onSubmit.bind(this);\n\t\tthis.scrollLoad = this.scrollLoad.bind(this);\n\t\tthis.onLoad = this.onLoad.bind(this);\n\t\tthis.iframeWindow = null;\n\t\tthis.state = {\n\n\t\t\tform: {},\n\t\t\tfloors: '',\n\t\t\tcommunity: '',\n\t\t\tcommunityIdList: [],\n\t\t\tcommunityInfoFloorList: [],\n\t\t\turl: '',\n\t\t\tdateend: dateFormat(new Date(), \"yyyy-mm-dd\"),\n\t\t\tdate: dateFormat(new Date(), \"yyyy-mm-dd\")\n\t\t}\n\n\t\tthis.getcommunity = this.getcommunity.bind(this);\n\t\tthis.selectCommunity = this.selectCommunity.bind(this);\n\t\tthis.getcommunity();\n\t\tthis.getCommunityFloors = this.getCommunityFloors.bind(this);\n\t\tthis.selectFloors = this.selectFloors.bind(this);\n\t\tStore.dispatch(change('FloorPlan', 'start', dateFormat(new Date(), \"yyyy-mm-dd\")));\n\t\tStore.dispatch(change('FloorPlan', 'end', dateFormat(new Date(), \"yyyy-mm-dd\")));\n\n\n\t}\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (nextProps.url != this.props.url) {\n\t\t\tthis.setState({\n\t\t\t\turl: nextProps.url\n\t\t\t}, function() {\n\t\t\t\tthis.getStationUrl();\n\t\t\t});\n\t\t}\n\t}\n\n\n\tonLoad(iframeWindow) {\n\t\tthis.iframeWindow = iframeWindow;\n\n\t}\n\n\n\n\tcomponentDidMount() {\n\t\tthis.setState({\n\t\t\turl: this.getStationUrl()\n\t\t})\n\n\n\t}\n\n\tgetStationUrl(form) {\n\n\n\t\tlet url = \"/krspace_operate_web/commnuity/communityFloorPlan/toCommunityFloorPlanList?communityId={communityId}&wherefloor={wherefloor}&date={date}&dateend={dateend}\";\n\n\t\tvar formList = form || {};\n\t\tlet params;\n\t\tlet {\n\t\t\tcommunity,\n\t\t\tfloors,\n\t\t\tdate,\n\t\t\tdateend\n\n\t\t} = this.state;\n\t\tif (community == 0) {\n\t\t\tcommunity = '';\n\t\t}\n\n\t\tparams = {\n\t\t\tcommunityId: community,\n\t\t\twherefloor: floors,\n\t\t\tdate: date,\n\t\t\tdateend: dateend,\n\t\t}\n\n\t\tif (Object.keys(params).length) {\n\t\t\tfor (let item in params) {\n\t\t\t\tif (params.hasOwnProperty(item)) {\n\t\t\t\t\turl = url.replace('{' + item + '}', params[item]);\n\t\t\t\t\tdelete params[item];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn url;\n\t}\n\tonSubmit(form) {\n\t\t\tform = Object.assign({}, form);\n\n\t\t\tlet {\n\t\t\t\tfloors,\n\t\t\t\tcommunity\n\t\t\t} = this.state;\n\t\t\tvar that = this;\n\t\t\tvar params = {\n\t\t\t\tcommunityId: community,\n\t\t\t\twherefloor: floors,\n\t\t\t\tdate: dateFormat(form.start, \"yyyy-mm-dd\") || dateFormat(new Date(), \"yyyy-mm-dd\"),\n\t\t\t\tdateend: dateFormat(form.end, \"yyyy-mm-dd\") || dateFormat(new Date(), \"yyyy-mm-dd\"),\n\t\t\t};\n\t\t\tif (form.start && form.end) {\n\t\t\t\tvar datastart = Date.parse(form.start),\n\t\t\t\t\tdataend = Date.parse(form.end);\n\t\t\t\tif (datastart > dataend) {\n\t\t\t\t\tNotify.show([{\n\t\t\t\t\t\tmessage: '开始时间不能大于结束时间',\n\t\t\t\t\t\ttype: 'danger',\n\t\t\t\t\t}]);\n\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tdate: dateFormat(form.start, \"yyyy-mm-dd\"),\n\t\t\t\t\t\tdateend: dateFormat(form.end, \"yyyy-mm-dd\"),\n\t\t\t\t\t\turl: this.getStationUrl(params)\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '注册时间不能为空',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t}\n\n\n\t\t}\n\t\t// 监听滚动事件\n\tscrollLoad() {\n\t\tvar that = this;\n\t\t$(window).bind('scroll', function() {\n\t\t\tvar top = $(window).scrollTop() || 0; //539滚出的距离\n\t\t\tvar height = $(window).height() || 0; //705浏览器高度\n\t\t\tvar num = $(document).height() - $(window).height(); //页面高-浏览器高度\n\t\t\t// var scrollBottom = $('#planTable').offset().top +1000 - top - height;\n\t\t\tvar scrollBottom = top - num;\n\t\t\tvar isOutBoundary = scrollBottom >= 0;\n\t\t\tif (isOutBoundary) {\n\t\t\t\tthat.iframeWindow.pagequery();\n\n\t\t\t}\n\t\t})\n\n\n\t}\n\tgetcommunity() {\n\t\tlet _this = this;\n\t\tlet {\n\t\t\tcommunityIdList\n\t\t} = this.state;\n\t\tStore.dispatch(Actions.callAPI('getCommunity')).then(function(response) {\n\t\t\tcommunityIdList = response.communityInfoList.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.name;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\tcommunityIdList.unshift({\n\t\t\t\tlabel: '请选择',\n\t\t\t\tvalue: '0',\n\t\t\t\tid: '0',\n\t\t\t});\n\t\t\t_this.setState({\n\t\t\t\tcommunityIdList,\n\t\t\t});\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\tselectCommunity(personel) {\n\t\tlet id = '';\n\t\tif (personel) {\n\t\t\tid = personel.id;\n\t\t\tthis.getCommunityFloors(personel.id);\n\t\t}\n\n\t\tStore.dispatch(change('FloorPlan', 'floor', ''));\n\n\t\tthis.setState({\n\t\t\tcommunity: id,\n\t\t\tfloors: '',\n\n\t\t})\n\n\t}\n\n\tgetCommunityFloors(id) {\n\t\tlet communityId = {\n\t\t\tcommunityId: parseInt(id)\n\t\t};\n\t\tvar communityInfoFloorList;\n\t\tvar that = this;\n\t\tStore.dispatch(Actions.callAPI('getCommunityFloors', communityId)).then(function(response) {\n\t\t\tcommunityInfoFloorList = response.floors.map(function(item, index) {\n\t\t\t\tvar obj = {};\n\t\t\t\tobj.value = item;\n\t\t\t\tobj.label = item;\n\t\t\t\treturn obj;\n\t\t\t});\n\t\t\tthat.setState({\n\t\t\t\tcommunityInfoFloorList\n\t\t\t});\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\tselectFloors(personel) {\n\t\tlet value = '';\n\t\tif (personel) {\n\t\t\tvalue = personel.value;\n\t\t}\n\t\tthis.setState({\n\t\t\tfloors: value\n\t\t})\n\t}\n\tfirstDate = (personel) => {\n\n\t\t// Store.dispatch(change('FloorPlan', 'start', dateFormat(new Date(), \"yyyy-mm-dd\")));\n\t\tlet firstDate = new Date(personel);\n\t\tlet {date} = this.state;\n\t\tif (this.state.dateend) {\n\t\t\tlet endDate = new Date(this.state.dateend);\n\t\t\tlet start = firstDate.getTime();\n\t\t\tlet end = endDate.getTime();\n\t\t\tif (start <= end) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tdate: personel\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '结束时间不能小于开始时间',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t\tStore.dispatch(change('FloorPlan', 'start', dateFormat(date, \"yyyy-mm-dd\")));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tdate: personel\n\t\t\t})\n\t\t}\n\t}\n\tsecondDate = (personel) => {\n\t\tlet {dateend}= this.state;\n\n\t\tlet secondDate = new Date(personel);\n\t\tlet end = this.state.dateend;\n\t\tif (this.state.date) {\n\t\t\tlet firstDate = new Date(this.state.date);\n\t\t\tlet start = firstDate.getTime();\n\t\t\tlet end = secondDate.getTime();\n\t\t\tif (start <= end) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tdateend: personel\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '结束时间不能小于开始时间',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t\tStore.dispatch(change('FloorPlan', 'end', dateFormat(dateend, \"yyyy-mm-dd\")));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tdateend: personel\n\t\t\t})\n\t\t}\n\n\n\n\t}\n\n\trender() {\n\n\t\tconst {\n\t\t\theight,\n\t\t\tcommunityLabel,\n\t\t\tcommunityIdList,\n\t\t\tcommunityId,\n\t\t\tcommunityInfoFloorList,\n\t\t\tdateend,\n\t\t\tdate\n\t\t} = this.state;\n\t\tlet url = this.getStationUrl();\n\n\t\tlet {\n\t\t\ttab,\n\t\t\thandleSubmit\n\t\t} = this.props;\n\n\t\tif (tab === 'floorplan') {\n\t\t\t$(window).bind('scroll.floorplan', this.scrollLoad());\n\n\t\t} else {\n\t\t\t$(window).unbind('scroll.floorplan', this.scrollLoad());\n\t\t}\n\n\t\treturn (\n\n\t\t\t<div id=\"planTable\" style={{margin:20,paddingBottom:30}}>\n\t\t \t<form name=\"planTable\" onSubmit={handleSubmit(this.onSubmit)} className=\"form-list\" style={{textAlign:'right'}}>\n\t\t\t\t\n\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t<ListGroupItem><span style={{display:'inline-block',lineHeight:'45px',textAlign:'left'}}>社区</span></ListGroupItem>\n\t\t\t\t\t\t<ListGroupItem style={{maxWidth:170,marginTop:'-6px',minWidth:110,width:'100%',textAlign:'left'}}><KrField grid={1/1} name=\"community\" component=\"select\"   options={communityIdList} onChange={this.selectCommunity} /></ListGroupItem>\n\t\t\t\t\t\t<ListGroupItem><span style={{display:'inline-block',lineHeight:'45px',textAlign:'left'}}>楼层</span></ListGroupItem>\n\t\t\t\t\t\t<ListGroupItem  style={{maxWidth:170,marginTop:'-6px',minWidth:100,width:'100%',textAlign:'left'}}><KrField name=\"floor\" grid={1/1} component=\"select\" options={communityInfoFloorList} onChange={this.selectFloors}/></ListGroupItem>\n\t\t\t\t\t\t<ListGroupItem style={{minWidth:100,marginTop:'-6px',marginLeft:'-3px',textAlign:'left'}}> <KrField name=\"start\"  component=\"date\"  simple={true} onChange={this.firstDate}/></ListGroupItem>\n\t\t\t\t\t\t<ListGroupItem style={{marginLeft:'10px',textAlign:'left'}}><span style={{display:'inline-block',lineHeight:'45px'}}>至</span></ListGroupItem>\n\t\t\t\t\t\t<ListGroupItem  style={{minWidth:100,marginTop:'-6px',textAlign:'left'}}> <KrField name=\"end\" component=\"date\" simple={true}  onChange={this.secondDate}/> </ListGroupItem>\n\t\t\t\t\t\t{/*<ListGroupItem style={{marginLeft:6,marginTop:4,textAlign:'left'}}> <Button  label=\"确定\" type=\"submit\" height={34}/></ListGroupItem>*/}\n\t\t\t\t\t</ListGroup>\n\t\t\t</form>\n\t\t\t<p style={{margin:10}}></p>\n\t\t\t<IframeContent src={url} onClose={this.getState} className=\"floorIframe\" onLoad={this.onLoad} width={'100%'} height={800} scrolling=\"no\"/>\n\n\t\t</div>\n\t\t);\n\t}\n}\n\nFloorPlan = reduxForm({\n\tform: 'FloorPlan'\n})(FloorPlan);"]}