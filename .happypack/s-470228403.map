{"version":3,"sources":["src/Components/IframeContent/index.js"],"names":["IframeContent","props","onClose","bind","onLoad","iframeElement","iframeWindow","state","isLoading","src","isInit","createIframe","_this","window","top","setReturnValue","data","nextProps","setState","width","height","contentWindow","ele","iframe","document","createElement","ifr","frameBorder","attachEvent","domain","onload","iframeWrap","innerHTML","appendChild","className","children","styles","c","Component","displayName","defaultProps","innerWidth","propTypes","PropTypes","string","oneOfType","number","func"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React from 'react';\nimport Loading from '../Loading';\n\nexport default class IframeContent extends React.Component {\n\n\tstatic displayName = 'IframeContent';\n\n\tstatic defaultProps = {\n\t\twidth:window.innerWidth,\n\t\theight:800\n\t}\n\n\tstatic propTypes = {\n\t\tclassName: React.PropTypes.string,\n\t\tsrc:React.PropTypes.string,\n\t\twidth: React.PropTypes.oneOfType([ React.PropTypes.string, React.PropTypes.number]),\n\t\theight: React.PropTypes.oneOfType([ React.PropTypes.string, React.PropTypes.number]),\n\t\tonClose:React.PropTypes.func,\n\t\tonLoad:React.PropTypes.func,\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.onClose = this.onClose.bind(this);\n\t\tthis.onLoad = this.onLoad.bind(this);\n\n\t\tthis.iframeElement = '';\n\t\tthis.iframeWindow = '';\n\n\t\tthis.state = {\n\t\t\tisLoading:false,\n\t\t\tsrc:this.props.src\n\t\t}\n\t\tthis.isInit = false;\n\n\t\tthis.createIframe = this.createIframe.bind(this);\n\n\t\tvar _this = this;\n\t\t//\tglobal.window = new Object();\n\t\twindow.top.setReturnValue = function(data){\n\t\t\t_this.onClose(data);\n\t\t}\n\t}\n\n\tcomponentDidMount(){\n\t\tthis.createIframe();\n\t}\n\n\tcomponentWillReceiveProps(nextProps){\n\t\tif (nextProps.src) {\n\t\t\tlet src = nextProps.src;\n\t\t\tthis.setState({\n\t\t\t\tsrc\n\t\t\t},function(){\n\t\t\t\tthis.createIframe();\n\t\t\t});\n\t\t}\n\t}\n\n\tonClose(data){\n\t\tconst {onClose} = this.props;\n\t\tonClose && onClose(data.data,data);\n\t}\n\n\tonLoad(){\n\n\t\tconst _this = this;\n\t\tconst {width,height,onLoad} = this.props;\n\t\tlet iframeElement = this.iframeElement;\n\n\t\tiframeElement.width = width;\n\t\tiframeElement.height = height;\n\t\t_this.iframeWindow =  iframeElement.contentWindow;\n\t\t\twindow.ele = _this.iframeWindow;\n\n\t\tonLoad && onLoad(iframeElement.contentWindow);\n\n\t}\n\n\tcreateIframe(){\n\t\t\tconst _this = this;\n\t\t\tconst {src} = this.state;\n\n\t\t\tvar iframe = document.createElement(\"iframe\");\n\t\t\tiframe.src = src;\n\n\t\t\twindow.ifr = iframe;\n\n\t\t\t//\t默认样式\n\t\t\tiframe.frameBorder = 0;\n\t\t\tiframe.width = 0;\n\t\t\tiframe.height = 0;\n\n\t\t\tthis.iframeElement = iframe;\n\n\t\t\tif (iframe.attachEvent){\n\t\t\t\tiframe.attachEvent(\"onload\", function(){\n\t\t\t\t\tthis.document.domain = \"krspace.cn\";\n\t\t\t\t\t_this.onLoad();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tiframe.onload = function(){\n\t\t\t\t\t_this.onLoad();\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.iframeWrap.innerHTML = '';\n\t\t\tthis.iframeWrap.appendChild(iframe);\n\t}\n\n\trender() {\n\n\t\tlet {className,children,src,width,height} = this.props;\n\t\tlet {isLoading} = this.state;\n\n\t\tlet styles = {\n\t\t\theight:height,\n\t\t}\n\n\t\treturn (\n\t\t\t<div style={styles}>\n\t\t\t\t{isLoading && <Loading />}\n\t\t\t\t<div ref={(c)=>this.iframeWrap = c} ></div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n// <iframe src={src} className=\"ui-iframe-content\" ref={(c)=>this.iframeElement=c} width={width} height={height} frameBorder=\"0\" />\n\n\n/*\n\n\n\trenderIframWidth(iframe){\n\n\t\tfunction autoFitIframe(iframe) {\n\t\t\tvar doc = iframe.contentDocument || iframe.contentWindow.document;\n\t\t\t// 设置iframe宽度\n\t\t\tiframe.style.width = '100%';\n\n\t\t\tfunction update() {\n\t\t\t\tvar containerWidth = iframe.parentNode.offsetWidth;\n\t\t\t\t// 在iphone、ipad等移动浏览器中，为iframe设置width和height样式起不了作用\n\t\t\t\t// iframe的高宽由其内容决定，故设置iframe中body的宽度来限制iframe高宽\n\t\t\t\tdoc.body.style.width =  + 'px';\n\t\t\t\tdoc.body.style.padding = '0';\n\t\t\t\tdoc.body.style.margin = '0';\n\t\t\t\tdoc.body.style.border = 'none';\n\n\t\t\t\t// 自适应iframe高度，确保没有纵向滚动条\n\t\t\t\t// iphone、ipad等移动浏览会器忽略width/height自适应高度\n\t\t\t\t// NOTE: 没有支持Quirks mode\n\n\t\t\t\t// 确保scrollHeight是iframe所需的最小高度\n\t\t\t\tiframe.style.height = '0';\n\t\t\t\tiframe.style.height = Math.max(\n\t\t\t\t\t// 其他浏览器\n\t\t\t\t\tdoc.body.scrollHeight,\n\t\t\t\t\t// IE7\n\t\t\t\t\tdoc.documentElement.scrollHeight\n\t\t\t\t) + 'px';\n\t\t\t}\n\t\t\tif (doc.readyState === 'complete') {\n\t\t\t\tupdate();\n\t\t\t}\n\n\t\t\tif (iframe.addEventListener) {\n\t\t\t\tiframe.addEventListener('load', update, false);\n\t\t\t}\n\t\t\telse if (iframe.attachEvent) {\n\t\t\t\tiframe.attachEvent('onload', update);\n\t\t\t}\n\t\t};\n\t}\n\n*/\n"]}