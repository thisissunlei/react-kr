{"version":3,"sources":["src/Containers/Operation/CustomerManage/Agreement/Reduce/Edit/index.js"],"names":["JoinCreate","props","context","openConfirmCreateDialog","bind","onCreateSubmit","onCancel","state","stationVos","initialValues","optionValues","openConfirmCreate","dispatch","formValues","params","callAPI","then","response","show","message","type","location","href","customerId","orderId","contractId","catch","err","window","setState","_this","rentamount","mainBillId","communityId","contractstate","mainbillid","signdate","Date","getTime","communityAddress","customer","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","customerName","communityName","communityid","mainbillCommunityId","lessorContactName","contractFileList","leaseEnddate","leaseBegindate","leaseId","contractcode","leaseContact","leaseContacttel","contractVersionType","contractVersion","lessorContactid","lessorContacttel","console","log","contextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\treduxForm,\n\tsubmitForm,\n\tchange,\n\treset\n} from 'redux-form';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tNotify,\n\tBreadCrumbs,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport ConfirmFormDetail from './ConfirmFormDetail';\nimport './index.less';\n\nexport default class JoinCreate extends Component {\n\tstatic contextTypes = {\n\t\tparams: React.PropTypes.object.isRequired\n\t}\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.openConfirmCreateDialog = this.openConfirmCreateDialog.bind(this);\n\t\tthis.onCreateSubmit = this.onCreateSubmit.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\n\t\tthis.state = {\n\t\t\tstationVos: [],\n\t\t\tinitialValues: {},\n\t\t\toptionValues: {},\n\t\t\topenConfirmCreate: false\n\t\t}\n\n\t\tStore.dispatch(reset('reduceCreateForm'));\n\n\t}\n\n\tonCreateSubmit(formValues) {\n\n\t\tlet {\n\t\t\tparams\n\t\t} = this.props;\n\t\tStore.dispatch(Actions.callAPI('getFnaContractRentController', {}, formValues)).then(function(response) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '更新成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\t\t\tlocation.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/reduce/\" + response.contractId + \"/detail\";\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t\t//this.openConfirmCreateDialog();\n\t}\n\n\tonCancel() {\n\t\tlet {\n\t\t\tparams\n\t\t} = this.context;\n\t\twindow.location.href = `./#/operation/customerManage/${params.customerId}/order/${params.orderId}/detail`;\n\t}\n\n\topenConfirmCreateDialog() {\n\t\tthis.setState({\n\t\t\topenConfirmCreate: !this.state.openConfirmCreate\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\n\t\tvar _this = this;\n\t\tconst {\n\t\t\tparams\n\t\t} = this.props;\n\t\tlet initialValues = {};\n\t\tlet optionValues = {};\n\t\tlet stationVos = [];\n\t\tlet rentamount = 0;\n\n\t\tStore.dispatch(Actions.callAPI('fina-contract-intention', {\n\t\t\tcustomerId: params.customerId,\n\t\t\tmainBillId: params.orderId,\n\t\t\tcommunityId: 1\n\t\t})).then(function(response) {\n\n\t\t\tinitialValues.contractstate = 'UNSTART';\n\t\t\tinitialValues.mainbillid = params.orderId;\n\n\t\t\tinitialValues.signdate = +new Date((new Date()).getTime() - 24 * 60 * 60 * 1000);\n\n\t\t\toptionValues.communityAddress = response.customer.communityAddress;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\t//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n\t\t\tinitialValues.contracttype = 'LESSRENT';\n\n\t\t\toptionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.corporationName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.paymentList = response.payment.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.payTypeList = response.payType.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.floorList = response.customer.floor;\n\t\t\toptionValues.customerName = response.customer.customerName;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\toptionValues.communityName = response.customer.communityName;\n\t\t\toptionValues.communityId = response.customer.communityid;\n\t\t\toptionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n\t\t\tStore.dispatch(Actions.callAPI('showFnaContractRentController', {\n\t\t\t\tid: params.id\n\t\t\t})).then(function(response) {\n\n\n\t\t\t\toptionValues.lessorContactName = response.lessorContactName;\n\t\t\t\toptionValues.contractFileList = response.contractFileList;\n\t\t\t\toptionValues.leaseEnddate = response.leaseEnddate;\n\t\t\t\toptionValues.leaseBegindate = response.leaseBegindate;\n\n\n\t\t\t\tinitialValues.leaseEnddate = response.leaseEnddate;\n\n\t\t\t\t// initialValues.id = response.id;\n\t\t\t\tinitialValues.id = response.id;\n\t\t\t\tinitialValues.leaseId = response.leaseId;\n\t\t\t\tinitialValues.contractcode = response.contractcode;\n\t\t\t\tinitialValues.leaseAddress = response.leaseAddress;\n\t\t\t\tinitialValues.lessorContactName = response.lessorContactName;\n\t\t\t\tinitialValues.leaseContact = response.leaseContact;\n\t\t\t\tinitialValues.leaseContacttel = response.leaseContacttel;\n        initialValues.contractVersionType = response.contractVersion;\n\t\t\t\tinitialValues.lessorContactid = response.lessorContactid;\n\t\t\t\t// initialValues.paymodel = response.payment.id;\n\t\t\t\t// initialValues.stationnum = response.stationnum;\n\t\t\t\t// initialValues.rentamount = response.rentamount;\n\t\t\t\t// initialValues.rentaluse = response.rentaluse;\n\t\t\t\t// initialValues.contractmark = response.contractmark;\n\t\t\t\t// initialValues.totalrent = response.totalrent;\n\t\t\t\tif (response.rentamount) {\n\t\t\t\t\tinitialValues.rentamount = response.rentamount;\n\t\t\t\t}\n\t\t\t\tinitialValues.lessorContacttel = response.lessorContacttel;\n\n\t\t\t\t//时间\n\t\t\t\t// initialValues.firstpaydate = new Date(response.firstpaydate);\n\t\t\t\tinitialValues.signdate = new Date(response.signdate);\n\t\t\t\t// initialValues.leaseBegindate = new Date(response.leaseBegindate);\n\t\t\t\tinitialValues.rentamount = response.rentamount;\n\n\t\t\t\tconsole.log('时间', initialValues);\n\n\n\t\t\t\t//处理stationvos\n\t\t\t\tstationVos = response.stationVos;\n\n\t\t\t\tconsole.log(stationVos, '---->>>>', response);\n\n\t\t\t\t_this.setState({\n\t\t\t\t\tinitialValues,\n\t\t\t\t\toptionValues,\n\t\t\t\t\tstationVos,\n\t\t\t\t});\n\n\t\t\t}).catch(function(err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t});\n\n\n\t\t}).catch(function(err) {\n\t\t\tconsole.log(err);\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\toptionValues,\n\t\t\tstationVos,\n\t\t\tparams\n\t\t} = this.state;\n\t\treturn (\n\n\t\t\t<div>\n\t\t \t<BreadCrumbs children={['系统运营','客户管理','入驻协议']}/>\n\t\t\t<Section title=\"减租协议书\" description=\"\">\n\t\t\t\t\t<NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos} params={this.props.params}/>\n\t\t\t</Section>\n\t\t</div>\n\t\t);\n\t}\n}"]}