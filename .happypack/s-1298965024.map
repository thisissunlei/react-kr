{"version":3,"sources":["src/Containers/Operation/BasicConfig/EquipmentDefinition/SingleUploadImgForm.js"],"names":["SingleUploadImgDefinitionForm","props","context","onCancel","onSubmit","values","_this","uploadImage","tipOpen","setState","submitValuesParams","picUrl","valuesParams","deviceId","detail","hardwareId","dispatch","callAPI","then","response","success","openSingleUploadDialog","submitCommunitys","submitNum","length","catch","err","error","message","openBatchUploadNum","batchUploadNum","state","confirmSubmit","submitParams","submitValues","openSchedule","selectedCommunitys","innerBoxWidth","uploadedNum","totalNum","requestURI","itemDetail","handleSubmit","marginTop","marginBottom","width","textAlign","padding","paddingRight","paddingLeft","form"],"mappings":"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","file":"SingleUploadImgForm.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {Component, PropTypes} from 'react';\nimport {connect} from 'kr/Redux';\nimport {reduxForm,formValueSelector,change,initialize,arrayPush,arrayInsert,FieldArray,reset} from 'redux-form';\nimport {Actions,Store} from 'kr/Redux';\nimport {\n\tUploadImage,\n\tKrField,\n\tGrid,\n\tRow,\n\tListGroup,\n\tListGroupItem,\n\tButton,\n\tDialog,\n\tNotify,\n\tMessage,\n} from 'kr-ui';\nimport \"./index.less\";\nclass SingleUploadImgDefinitionForm extends Component{\n\tconstructor(props,context){\n\t\tsuper(props,context);\n\t\tthis.detail = this.props.detail;\n\t\tthis.state={\n\t\t\tpicUrl:'',\n\t\t\tselectedCommunitys:[],\n\t\t\tbatchUploadNum :false,\n\t\t\topenSchedule : false,\n\t\t\tsubmitValues : '',\n\t\t\t// submitNum : 11,\n\t\t\tinnerBoxWidth :0,\n\t\t\tuploadedNum:0,\n\t\t\ttotalNum:0,\n\t\t\tsubmitValuesParams:{},\n\t\t\trequestURI:\"postEquipmentImg\",\n\t\t\titemDetail:''\n\t\t\t\n\t\t}\n\t}\n\t//首次加载，只执行一次\n\tcomponentWillMount() {\n\t}\n\tcomponentDidMount(){\n\t}\n\tonCancel=()=>{\n\t\tlet {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t}\n\t// 提交(获取总共上传社区个数)\n\tonSubmit=(values)=>{\n\t\tlet _this =this;\n\t\tif(!values.uploadImage){\n\t\t\tconst {tipOpen} = this.props;\n\t\t\ttipOpen && tipOpen();\n\t\t\treturn;\n\t\t};\n\t\tthis.setState({\n\t\t\tsubmitValuesParams : values,\n\t\t\tpicUrl : values.uploadImage\n\t\t})\n\t\tlet valuesParams = {\n\t\t\tdeviceId : this.detail.hardwareId,\n\t\t\tpicUrl : values.uploadImage\n\t\t}\n\t\t// console.log(\"valuesParams\",valuesParams);\n\t\t// 向指定社区推送图片\n\t\tStore.dispatch(Actions.callAPI('uploadImgToEquipmentSingle',{},valuesParams))\n\t      .then(function(response){\n\t      \tMessage.success(\"推送图片成功\");\n\t      \tconst {openSingleUploadDialog} = _this.props;\n\t      \topenSingleUploadDialog && openSingleUploadDialog();\n\t      \t_this.setState({\n\t      \t\tsubmitCommunitys : response,\n\t      \t\tsubmitNum : response.length\n\t      \t})\n\t      }).catch(function(err){\n\t      \tMessage.error(err.message);\n\t      \tconst {openSingleUploadDialog} = _this.props;\n\t      \topenSingleUploadDialog && openSingleUploadDialog();\n\t    });\n\t\tthis.openBatchUploadNum();\n\t}\n\t// 是否打开确定上传窗口\n\topenBatchUploadNum=()=>{\n\t\tthis.setState({\n\t\t\tbatchUploadNum : !this.state.batchUploadNum\n\t\t})\n\t}\n\t// 确定开始上传\n\tconfirmSubmit=()=>{\n\t\tlet _this = this;\n\t\tvar submitParams = this.state.submitValues;\n\t\tthis.openBatchUploadNum();\n\t\tthis.setState({\n\t\t\topenSchedule : !_this.state.openSchedule\n\t\t})\n\t}\n\trender(){\n\t\tconst {handleSubmit}=this.props;\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<form onSubmit={handleSubmit(this.onSubmit)}>\n\t\t\t\t\t<KrField name=\"uploadImage\" \n\t\t\t\t\t\tcomponent=\"uploadImage\" \n\t\t\t\t\t\tstyle={{marginTop:10}} \n\t\t\t\t\t\tphotoSize={'212*136'} \n\t\t\t\t\t\tpictureFormat={'JPG'} \n\t\t\t\t\t\tpictureMemory={'32K'}\n\t\t\t\t\t\trequestURI = {this.state.requestURI}\n\t\t\t\t\t/>\n\t\t\t\t\t<Grid style={{marginTop:25,marginBottom:'4px'}}>\n\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t<ListGroupItem style={{width:'171px',textAlign:'right',padding:0,paddingRight:15}}>\n\t\t\t\t\t\t\t\t\t<Button  label=\"开始上传\" type=\"submit\"/>\n\t\t\t\t\t\t\t\t</ListGroupItem>\n\t\t\t\t\t\t\t\t<ListGroupItem style={{width:'171px',textAlign:'left',padding:0,paddingLeft:15}}>\n\t\t\t\t\t\t\t\t\t<Button  label=\"取消\" type=\"button\"  cancle={true} onTouchTap={this.onCancel} />\n\t\t\t\t\t\t\t\t</ListGroupItem>\n\t\t\t\t\t\t\t</ListGroup>\t\t\t\t\t\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t);\n\t}\n}\n// const validate = values=>{\n// \tconst errors={};\n// \tif(!values.communityName){\n// \t\terrors.communityName = '社区名称为必填项';\n// \t}\n// \tif(!values.floor){\n// \t\terrors.floor = '楼层为必填项';\n// \t}\n// \tif(!values.showTitle){\n// \t\terrors.showTitle = '展示标题为必填项';\n// \t}\n// \treturn errors;\n// }\nexport default SingleUploadImgDefinitionForm = reduxForm({\n\tform: 'SingleUploadImgDefinitionForm',\n\t// validate,\n})(SingleUploadImgDefinitionForm);"]}