{"version":3,"sources":["src/Containers/Member/MemberManage/Card/ChangeCard.js"],"names":["ImportCard","props","onCancel","checkName","person","console","log","oldUser","state","value","warntimeout","onSubmit","values","params","fromId","originUser","toId","nowUser","_this","dispatch","callAPI","then","response","catch","err","error","message","changeName","selectOldUser","receiveId","setState","count","beginCard","endCard","communityText","companyText","options","selectSourceOption","searchForm","searchParams","handleSubmit","pristine","reset","content","filter","nameList","label","marginTop","margin","width","textAlign","padding","paddingRight","paddingLeft","validate","errors","form","enableReinitialize","keepDirtyOnReinitialize"],"mappings":";;;;;;;;AACA;;;;AACA;;AACA;;AAEA;;AACA;;;;AACA;;;;;;;;;;;;IACMA,U;;;AACL,qBAAYC,KAAZ,EAAkB;AAAA;;AAAA,uHACXA,KADW;;AAAA,SAuBlBC,QAvBkB,GAuBT,YAAI;AAAA,OACPA,QADO,GACK,OAAKD,KADV,CACPC,QADO;;AAEZA,eAAYA,UAAZ;AACA,GA1BiB;;AAAA,SA2BlBC,SA3BkB,GA2BR,UAACC,MAAD,EAAU;AACnBC,WAAQC,GAAR,CAAYF,MAAZ;AADmB,OAEdG,OAFc,GAEH,OAAKC,KAFF,CAEdD,OAFc;;AAGnB,OAAGA,WAAWH,OAAOK,KAAlB,IAA2BL,OAAOK,KAAP,IAAcF,OAA5C,EAAoD;AAChD,kBAAQG,WAAR,CAAoB,gBAApB,EAAqC,OAArC;AACA;AAEJ,GAlCiB;;AAAA,SAoClBC,QApCkB,GAoCP,UAACC,MAAD,EAAY;AACtBP,WAAQC,GAAR,CAAY,QAAZ,EAAqBM,MAArB;AACG,OAAIC,SAAS;AACZC,YAAOF,OAAOG,UADF;AAEZC,UAAKJ,OAAOK;AAFA,IAAb;AAIA,OAAGL,OAAOK,OAAP,IAAkBL,OAAOG,UAAzB,IAAuCH,OAAOK,OAAP,IAAgBL,OAAOG,UAAjE,EAA4E;AAC3E,kBAAQL,WAAR,CAAoB,gBAApB,EAAqC,OAArC;AACAL,YAAQC,GAAR,CAAY,gBAAZ;AACA;AACA;;AAID,OAAIY,cAAJ;AACA,gBAAMC,QAAN,CAAe,eAAQC,OAAR,CAAgB,oBAAhB,EAAsCP,MAAtC,CAAf,EACCQ,IADD,CACM,UAASC,QAAT,EAAmB;AAAA,QACdX,QADc,GACFO,MAAMjB,KADJ,CACdU,QADc;;AAExBA,gBAAYA,SAASC,MAAT,CAAZ;AAEA,IALD,EAKGW,KALH,CAKS,UAASC,GAAT,EAAc;AACnB,kBAAQC,KAAR,CAAcD,IAAIE,OAAlB;AACH,IAPD;AASH,GA5DiB;;AAAA,SA6DlBC,UA7DkB,GA6DP,UAACf,MAAD,EAAU;AACpBP,WAAQC,GAAR,CAAYM,MAAZ;AACA,GA/DiB;;AAAA,SAgElBgB,aAhEkB,GAgEJ,UAACnB,KAAD,EAAS;AACtB,OAAIS,cAAJ;AACA,gBAAMC,QAAN,CAAe,uBAAO,gBAAP,EAAyB,YAAzB,EAAuCV,KAAvC,CAAf;AACA,gBAAMU,QAAN,CAAe,eAAQC,OAAR,CAAgB,eAAhB,EAAiC,EAACS,WAAUpB,KAAX,EAAjC,CAAf,EAAoEY,IAApE,CAAyE,UAASC,QAAT,EAAmB;AACtFJ,UAAMY,QAAN,CAAe;AACbC,YAAMT,QADO;AAEbf,cAAQE;AAFK,KAAf;AAKF,IANJ,EAMMc,KANN,CAMY,UAASC,GAAT,EAAc;AACnB,kBAAQC,KAAR,CAAcD,IAAIE,OAAlB;AACH,IARJ;AASA,GA5EiB;;AAGjB,SAAKlB,KAAL,GAAW;AACVwB,cAAU,CADA;AAEVC,YAAQ,CAFE;AAGVF,UAAM,GAHI;AAIVG,kBAAc,EAJJ;AAKVC,gBAAY,EALF;AAMVC,YAAQ,EANE;AAOVC,uBAAmB,EAPT;AAQVC,eAAW,KARD;AASV/B,YAAQ,EATE;AAUVgC,iBAAa;AAVH,GAAX;;AAHiB;AAkBjB;;;;uCAEmB;AACnB;AACA;;;2BAyDO;AAAA,gBACwD,KAAKtC,KAD7D;AAAA,OACCwB,KADD,UACCA,KADD;AAAA,OACQe,YADR,UACQA,YADR;AAAA,OACsBC,QADtB,UACsBA,QADtB;AAAA,OACgCC,KADhC,UACgCA,KADhC;AAAA,OACsCC,OADtC,UACsCA,OADtC;AAAA,OAC8CC,MAD9C,UAC8CA,MAD9C;;AAEP,OAAIV,gBAAgB,EAApB;AAFO,OAGFH,KAHE,GAGM,KAAKvB,KAHX,CAGFuB,KAHE;;AAIP,OAAIc,WAAW,CAAC,EAACpC,OAAM,CAAP,EAASqC,OAAM,IAAf,EAAD,EAAsB,EAACrC,OAAM,CAAP,EAASqC,OAAM,IAAf,EAAtB,EAA2C,EAACrC,OAAM,CAAP,EAASqC,OAAM,IAAf,EAA3C,EAAgE,EAACrC,OAAM,CAAP,EAASqC,OAAM,IAAf,EAAhE,CAAf;AACA,UACC;AAAA;AAAA,MAAM,UAAUN,aAAa,KAAK7B,QAAlB,CAAhB,EAA6C,OAAO,EAACoC,WAAU,MAAX,EAApD;AACC,mDAAS,MAAK,YAAd,EAA2B,WAAU,YAArC,EAAkD,OAAM,0BAAxD,EAA+D,UAAU,KAAKpB,UAA9E,EAA0F,UAAU,KAAKC,aAAzG,GADD;AAEC,mDAAS,MAAK,SAAd,EAAwB,WAAU,gBAAlC,EAAmD,OAAM,oBAAzD,EAA+D,UAAU,KAAKzB,SAA9E,GAFD;AAGC,mDAAS,MAAK,OAAd,EAAsB,WAAU,WAAhC,EAA4C,OAAM,0BAAlD,EAAyD,OAAO4B,KAAhE,GAHD;AAKC;AAAA;AAAA,OAAM,OAAO,EAACiB,QAAO,kBAAR,EAAb;AACC;AAAA;AAAA;AACC;AAAA;AAAA;AACC;AAAA;AAAA,UAAe,OAAO,EAACC,OAAM,OAAP,EAAeC,WAAU,OAAzB,EAAiCC,SAAQ,CAAzC,EAA2CC,cAAa,EAAxD,EAAtB;AAAmF,sDAAS,OAAM,cAAf,EAAoB,MAAK,QAAzB;AAAnF,QADD;AAEC;AAAA;AAAA,UAAe,OAAO,EAACH,OAAM,OAAP,EAAeC,WAAU,MAAzB,EAAgCC,SAAQ,CAAxC,EAA0CE,aAAY,EAAtD,EAAtB;AAAiF,sDAAS,OAAM,cAAf,EAAoB,MAAK,QAAzB,EAAmC,QAAQ,IAA3C,EAAiD,YAAY,KAAKnD,QAAlE;AAAjF;AAFD;AADD;AADD;AALD,IADD;AAgBA;;;;;;AAEF,IAAMoD,WAAW,SAAXA,QAAW,SAAU;;AAE1B,KAAMC,SAAS,EAAf;;AAIA,KAAI,CAAC3C,OAAOG,UAAZ,EAAwB;AACvBwC,SAAOxC,UAAP,GAAoB,SAApB;AACA;AACD,KAAI,CAACH,OAAOK,OAAZ,EAAqB;AACpBsC,SAAOtC,OAAP,GAAiB,QAAjB;AACA;;AAID,QAAOsC,MAAP;AACA,CAhBD;;eAiBevD,aAAa,0BAAU;AACrCwD,OAAM,gBAD+B;AAErCF,mBAFqC;AAGrCG,qBAAoB,IAHiB;AAIrCC,0BAAyB;AAJY,CAAV,EAKzB1D,UALyB,C;;;;;;;;;;+BAxHtBA,U;;+BAuGAsD,Q","file":"ChangeCard.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["\nimport React, {Component, PropTypes} from 'react';\nimport {connect} from 'kr/Redux';\nimport {reduxForm,formValueSelector,change,initialize,arrayPush,arrayInsert,FieldArray,reset} from 'redux-form';\nimport {Actions,Store} from 'kr/Redux';\nimport { KrField, Grid, Row, Col, Button, Notify, ButtonGroup, ListGroup, ListGroupItem, SearchForm, Message, } from 'kr-ui';\nimport dateFormat from 'dateformat';\nimport $ from 'jquery'\nclass ImportCard extends Component{\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.state={\n\t\t\tbeginCard:0,\n\t\t\tendCard:0,\n\t\t\tcount:'0',\n\t\t\tcommunityText:'',\n\t\t\tcompanyText:'',\n\t\t\toptions:[],\n\t\t\tselectSourceOption:[],\n\t\t\tsearchForm:false,\n\t\t\toldUser:'',\n\t\t\tsearchParams:{\n\n\t\t\t},\n\t\t}\n\t\t\n\t}\n\n\tcomponentWillMount(){\n\t\t// this.getMenberList();\n\t}\n\tonCancel=()=>{\n\t\tlet {onCancel} = this.props;\n\t\tonCancel && onCancel();\n\t}\n\tcheckName=(person)=>{\n\t\tconsole.log(person);\n\t\tlet {oldUser} = this.state;\n\t\tif(oldUser && person.value && person.value==oldUser){\n\t    \tMessage.warntimeout('原领用人和领用人不能为同一人','error');\n\t    }\n\t\t\n\t}\n\t\t\n\tonSubmit = (values) => {\n\t\tconsole.log('values',values);\n\t    let params = {\n\t    \tfromId:values.originUser,\n\t    \ttoId:values.nowUser\n\t    }\n\t    if(values.nowUser && values.originUser && values.nowUser==values.originUser){\n\t    \tMessage.warntimeout('原领用人和领用人不能为同一人','error');\n\t    \tconsole.log('原领用人和领用人不能为同一人');\n\t    \treturn;\n\t    }\n\n\t    \n\n\t    let _this = this;\n\t    Store.dispatch(Actions.callAPI('transferMemberCard', params))\n\t    .then(function(response) {\n\t        const {onSubmit} = _this.props;\n\t\t    onSubmit && onSubmit(values);\n\t        \n\t    }).catch(function(err) {\n\t        Message.error(err.message);\n\t    });\n\t    \n\t}\n\tchangeName=(values)=>{\n\t\tconsole.log(values);\n\t}\n\tselectOldUser=(value)=>{\n\t\tlet _this = this;\n\t\tStore.dispatch(change('ImportCardForm', 'originUser', value));\n\t\tStore.dispatch(Actions.callAPI('memberCardNum', {receiveId:value})).then(function(response) {\n\t       _this.setState({\n\t       \t\tcount:response,\n\t       \t\toldUser:value\n\t       })\n\t        \n\t    }).catch(function(err) {\n\t        Message.error(err.message);\n\t    });\n\t}\n\t\n\n\trender(){\n\t\tconst { error, handleSubmit, pristine, reset,content,filter} = this.props;\n\t\tlet communityText = '';\n\t\tlet {count} =this.state;\n\t\tlet nameList = [{value:1,label:'aa'},{value:2,label:'bb'},{value:3,label:'ab'},{value:5,label:'cd'}]\n\t\treturn (\n\t\t\t<form onSubmit={handleSubmit(this.onSubmit)} style={{marginTop:'37px'}}>\n\t\t\t\t<KrField name=\"originUser\" component=\"SearchList\" label=\"原领用人\" onChange={this.changeName} onSubmit={this.selectOldUser}/>\n\t\t\t\t<KrField name=\"nowUser\" component=\"searchPersonel\" label=\"领用人\" onChange={this.checkName}/>\n\t\t\t\t<KrField name=\"count\" component=\"labelText\" label=\"转移数量\" value={count}/>\n\n\t\t\t\t<Grid style={{margin:\"20px 0 3px -10px\"}}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t<ListGroupItem style={{width:'165px',textAlign:'right',padding:0,paddingRight:15}}><Button  label=\"确定\" type=\"submit\"/></ListGroupItem>\n\t\t\t\t\t\t\t<ListGroupItem style={{width:'150px',textAlign:'left',padding:0,paddingLeft:15}}><Button  label=\"取消\" type=\"button\"  cancle={true} onTouchTap={this.onCancel} /></ListGroupItem>\n\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t</Row>\n\t\t\t\t</Grid>\n\t\t  </form>\n\t\t);\n\t}\n}\nconst validate = values => {\n\n\tconst errors = {}\n\n\t\n\t\n\tif (!values.originUser) {\n\t\terrors.originUser = '请选择原领用人';\n\t}\n\tif (!values.nowUser) {\n\t\terrors.nowUser = '请选择领用人';\n\t}\n\n\t\n\n\treturn errors\n}\nexport default ImportCard = reduxForm({\n\tform: 'ImportCardForm',\n\tvalidate,\n\tenableReinitialize: true,\n\tkeepDirtyOnReinitialize: true,\n})(ImportCard);\n"]}