{"version":3,"sources":["src/Components/InputDate/index.js"],"names":["window","calendars","InputDate","openCalendarDialog","onChange","props","setDefaultValue","value","setState","isNaN","nowTime","Date","year","getFullYear","month","getMonth","date","getDate","indexOf","replace","docClick","event","target","className","parentNode","openCalendar","closeCalendarDialog","state","document","addEventListener","closeOtherAllCalendar","_this","map","item","index","valueArr","split","removeEventListener","push","nextProps","placeholder","Component","displayName","defaultProps","defaultValue","propTypes","PropTypes","string","style","object","childContextTypes","func","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n\tComponent\n} from 'react';\n\nimport Input from '../Input';\nimport KrDate from '../KrDate';\n\nimport Calendar from './Calendar';\nimport ReactDOM from 'react-dom';\n\nimport './index.less';\nimport './animate.less';\n\nwindow.calendars = [];\n\nexport default class InputDate extends React.Component {\n\n\tstatic displayName = 'InputDate';\n\n\tstatic defaultProps = {\n\t\tplaceholder: '日期',\n\t\tdefaultValue: +new Date\n\t}\n\tstatic propTypes = {\n\t\t/**\n\t\t *样式class类名\n\t\t */\n\t\tclassName: React.PropTypes.string,\n\t\t/**\n\t\t * 样式\n\t\t */\n\t\tstyle: React.PropTypes.object,\n\t\tplaceholder: React.PropTypes.string,\n\t}\n\n\tstatic childContextTypes = {\n\t\topenCalendarDialog: React.PropTypes.func.isRequired,\n\t\tonChange: React.PropTypes.func.isRequired\n\t}\n\n\tgetChildContext() {\n\t\treturn {\n\t\t\topenCalendarDialog: this.openCalendarDialog,\n\t\t\tonChange: this.onChange\n\t\t};\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\topenCalendar: false,\n\t\t\tvalue: ''\n\t\t}\n\t}\n\n\n\tsetDefaultValue = (value) => {\n\n\t\tif (typeof value === 'undefined' || !value) {\n\t\t\tthis.setState({\n\t\t\t\tvalue: ''\n\t\t\t});\n\t\t\treturn '';\n\t\t}\n\n\t\tif (!isNaN(value)) {\n\t\t\tvar nowTime = new Date(value);\n\t\t\tvar year = nowTime.getFullYear();\n\t\t\tvar month = nowTime.getMonth() + 1;\n\t\t\tvar date = nowTime.getDate();\n\n\t\t\tthis.setState({\n\t\t\t\tvalue: `${year}-${month}-${date}`\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof value === 'string' && value.indexOf('-') !== -1) {\n\t\t\tthis.setState({\n\t\t\t\tvalue: value\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof value === 'string' && value.indexOf('/') !== -1) {\n\t\t\tthis.setState({\n\t\t\t\tvalue: value.replace('/', '-')\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t}\n\n\tdocClick = (event) => {\n\t\tevent = event || window.event;\n\t\tvar target = event.target;\n\n\t\twhile (target) {\n\t\t\tif (target && target.className && target.className.indexOf('calendar') !== -1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget = target.parentNode;\n\t\t}\n\n\t\tconst {\n\t\t\topenCalendar\n\t\t} = this.props;\n\n\t\tthis.closeCalendarDialog();\n\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.setDefaultValue(this.props.value);\n\t\twindow.calendars.push(this);\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (nextProps.value != this.props.value) {\n\t\t\tthis.setDefaultValue(nextProps.value);\n\t\t}\n\t}\n\n\topenCalendarDialog = () => {\n\n\t\tthis.setState({\n\t\t\topenCalendar: !this.state.openCalendar\n\t\t}, function() {\n\t\t\tif (this.state.openCalendar) {\n\t\t\t\tdocument.addEventListener('click', this.docClick);\n\t\t\t\tthis.closeOtherAllCalendar();\n\t\t\t}\n\t\t});\n\n\t}\n\n\tcloseOtherAllCalendar = () => {\n\n\t\tlet calendars = window.calendars;\n\t\tvar _this = this;\n\t\tcalendars.map(function(item, index) {\n\t\t\tif (item != _this) {\n\t\t\t\titem.closeCalendarDialog()\n\t\t\t}\n\t\t});\n\t}\n\n\tonChange = (value) => {\n\n\t\tvar year;\n\t\tvar month;\n\t\tvar date;\n\t\tvar valueArr = [];\n\n\t\t//校验格式\n\t\tif (value.indexOf('-') !== -1) {\n\t\t\tvalueArr = value.split('-');\n\t\t} else if (value.indexOf('/') !== -1) {\n\t\t\tvalueArr = value.split('/');\n\t\t}\n\n\t\tyear = valueArr[0];\n\t\tmonth = valueArr[1];\n\t\tdate = valueArr[2];\n\n\t\tif (!year) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!date || date > 31) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!month || month < -1 || month > 12) {\n\t\t\treturn;\n\t\t}\n\t\tvalue = `${year}-${month}-${date}`;\n\t\tthis.setState({\n\t\t\tvalue\n\t\t});\n\t\tlet {\n\t\t\tonChange\n\t\t} = this.props;\n\t\tonChange && onChange(value);\n\t}\n\n\tcloseCalendarDialog = () => {\n\t\tthis.setState({\n\t\t\topenCalendar: false\n\t\t}, function() {\n\t\t\tdocument.removeEventListener('click', this.docClick);\n\t\t});\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\topenCalendar\n\t\t} = this.state;\n\n\t\treturn (\n\t\t\t<div className=\"ui-calendar\" ref=\"calendar\">\n\t\t\t\t\t<div className=\"calendar-content\"  onClick={this.openCalendarDialog} >\n\t\t\t\t\t\t\t<div className=\"calendar-value\">{(this.state.value && <KrDate value={this.state.value} />) || this.props.placeholder} </div>\n\t\t\t\t\t\t\t<span className=\"icon\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t{openCalendar && <Calendar onChange={this.onChange} value={this.state.value}/>}\n\t\t\t\t</div>\n\t\t);\n\n\t}\n\n\n}\n"]}