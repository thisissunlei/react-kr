{"version":3,"sources":["src/Containers/Operation/CustomerManage/AgreementList/Exit/Edit/index.js"],"names":["EditCreate","props","context","onCreateSubmit","bind","onCancel","state","stationVos","initialValues","optionValues","formValues","openConfirmCreate","dispatch","params","callAPI","then","response","show","message","type","ajaxListData","cityName","communityName","createDateBegin","createDateEnd","createrName","customerName","page","pageSize","salerName","openEditAgreement","catch","err","_this","customerId","mainBillId","orderId","mainbillid","leaseBegindate","Date","leaseEnddate","communityAddress","customer","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","communityId","communityid","mainbillCommunityId","contractFileList","lessorContactName","contractstate","leaseId","contractcode","leaseContact","lessorContacttel","leaseContacttel","contractVersionType","contractVersion","paytype","paymodel","stationnum","wherefloor","rentaluse","contractmark","totalrent","totaldeposit","lessorContactid","depositamount","totalreturn","signdate","withdrawdate","setState","console","log","marginLeft","marginTop"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n  Component,\n  PropTypes\n} from 'react';\nimport {\n  reduxForm,\n  submitForm,\n  change,\n  reset\n} from 'redux-form';\nimport {\n  Actions,\n  Store\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n  Dialog,\n  Section,\n  Grid,\n  Notify,\n  BreadCrumbs,\n  Title,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport allState from \"../../State\";\n\n\nexport default class EditCreate extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.onCreateSubmit = this.onCreateSubmit.bind(this);\n    this.onCancel = this.onCancel.bind(this);\n\n    this.state = {\n      stationVos: [],\n      initialValues: {},\n      optionValues: {},\n      formValues: {},\n      openConfirmCreate: false\n    }\n\n    Store.dispatch(reset('exitEditForm'));\n  }\n\n  onCreateSubmit(formValues) {\n    const {params} = this.props;\n    Store.dispatch(Actions.callAPI('addFnaContractWithdrawal', {}, formValues)).then(function(response) {\n      Notify.show([{\n        message: '编辑成功',\n        type: 'success',\n      }]);\n      allState.ajaxListData({cityName:'',communityName:'',createDateBegin:'',createDateEnd:'',createrName:'',customerName:'',page:'',pageSize:'',salerName:''})\n      allState.openEditAgreement=false;\n      \n      //location.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/exit/\" + response.contractId + \"/detail\";\n\n    }).catch(function(err) {\n      Notify.show([{\n        message: err.message,\n        type: 'danger',\n      }]);\n    });\n  }\n\n  onCancel() {\n    //window.history.back();\n    allState.openEditAgreement=false;\n  }\n\n  componentDidMount() {\n\n    var _this = this;\n    const {\n      params\n    } = this.props;\n    let initialValues = {};\n    let optionValues = {};\n    let stationVos = [];\n\n    Store.dispatch(Actions.callAPI('fina-contract-intention', {\n      customerId: params.customerId,\n      mainBillId: params.orderId,\n    })).then(function(response) {\n\n      //initialValues.ContractStateType = 'EXECUTE';\n\n      initialValues.mainbillid = params.orderId;\n\n      initialValues.leaseBegindate = new Date;\n      initialValues.leaseEnddate = new Date;\n\n\n      optionValues.communityAddress = response.customer.communityAddress;\n      optionValues.leaseAddress = response.customer.customerAddress;\n      //合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n      initialValues.contracttype = 'QUITRENT';\n\n      optionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.corporationName;\n        return item;\n      });\n      optionValues.paymentList = response.payment.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.dicName;\n        return item;\n      });\n      optionValues.payTypeList = response.payType.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.dicName;\n        return item;\n      });\n\n      optionValues.floorList = response.customer.floor;\n      optionValues.customerName = response.customer.customerName;\n      optionValues.leaseAddress = response.customer.customerAddress;\n      optionValues.communityName = response.customer.communityName;\n      optionValues.communityId = response.customer.communityid;\n      optionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n      Store.dispatch(Actions.callAPI('getFnaContractWithdrawalById', {\n        id: params.id\n      })).then(function(response) {\n\n        optionValues.contractFileList = response.contractFileList;\n        optionValues.lessorContactName = response.lessorContactName;\n\n        initialValues.id = response.id;\n        initialValues.contractstate = response.contractstate;\n        initialValues.leaseId = response.leaseId;\n        initialValues.contractcode = response.contractcode;\n        initialValues.leaseAddress = response.leaseAddress;\n        initialValues.lessorContactName = response.lessorContactName;\n        initialValues.leaseContact = response.leaseContact;\n        initialValues.lessorContacttel = response.lessorContacttel;\n        initialValues.leaseContacttel = response.leaseContacttel;\n        initialValues.contractVersionType = response.contractVersion;\n        if (response.payType) {\n          initialValues.paytype = response.payType.id;\n\n        }\n        if (response.payment) {\n          initialValues.paymodel = response.payment.id;\n\n        }\n        initialValues.stationnum = response.stationnum;\n        initialValues.wherefloor = response.wherefloor;\n        initialValues.rentaluse = response.rentaluse;\n        initialValues.contractmark = response.contractmark;\n        initialValues.totalrent = response.totalrent;\n        initialValues.totaldeposit = response.totaldeposit;\n        initialValues.lessorContactid = response.lessorContactid;\n        initialValues.depositamount = response.depositamount;\n        initialValues.totalreturn = response.totalreturn;\n        //时间\n\n        initialValues.signdate = new Date(response.signdate);\n        initialValues.leaseBegindate = new Date(response.leaseBegindate);\n        initialValues.leaseEnddate = new Date(response.leaseEnddate);\n        initialValues.withdrawdate = response.withdrawdate;\n\n\n        //处理stationvos\n        stationVos = response.stationVos;\n\n\n        _this.setState({\n          initialValues,\n          optionValues,\n          stationVos\n        });\n\n      }).catch(function(err) {\n        Notify.show([{\n          message: '后台出错请联系管理员',\n          type: 'danger',\n        }]);\n      });\n\n\n    }).catch(function(err) {\n      Notify.show([{\n        message: '后台出错请联系管理员',\n        type: 'danger',\n      }]);\n    });\n\n  }\n\n\n  render() {\n\n    let {\n      initialValues,\n      optionValues,\n      stationVos\n    } = this.state;\n    console.log('stationVos', stationVos)\n    return (\n\n      <div style={{marginLeft:22}}>\n      <Title value=\"编辑退租协议书_财务管理\"/>\n      <BreadCrumbs children={['系统运营','客户管理','退租协议']}/>\n     <div style={{marginTop:10}}>\n          <NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos}/>\n      </div>\n    </div>\n    );\n  }\n}\n"]}