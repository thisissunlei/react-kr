'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _simpleAssign = require('simple-assign');

var _simpleAssign2 = _interopRequireDefault(_simpleAssign);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _shallowEqual = require('recompose/shallowEqual');

var _shallowEqual2 = _interopRequireDefault(_shallowEqual);

var _autoPrefix = require('../utils/autoPrefix');

var _autoPrefix2 = _interopRequireDefault(_autoPrefix);

var _transitions = require('../styles/transitions');

var _transitions2 = _interopRequireDefault(_transitions);

var _ScaleIn = require('./ScaleIn');

var _ScaleIn2 = _interopRequireDefault(_ScaleIn);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var pulsateDuration = 750;

var FocusRipple = function (_Component) {
  _inherits(FocusRipple, _Component);

  function FocusRipple() {
    var _ref;

    var _temp, _this, _ret;

    _classCallCheck(this, FocusRipple);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = FocusRipple.__proto__ || Object.getPrototypeOf(FocusRipple)).call.apply(_ref, [this].concat(args))), _this), _this.pulsate = function () {
      var innerCircle = _reactDom2.default.findDOMNode(_this.refs.innerCircle);
      if (!innerCircle) return;

      var startScale = 'scale(1)';
      var endScale = 'scale(0.85)';
      var currentScale = innerCircle.style.transform || startScale;
      var nextScale = currentScale === startScale ? endScale : startScale;

      _autoPrefix2.default.set(innerCircle.style, 'transform', nextScale);
      _this.timeout = setTimeout(_this.pulsate, pulsateDuration);
    }, _temp), _possibleConstructorReturn(_this, _ret);
  }

  _createClass(FocusRipple, [{
    key: 'componentDidMount',
    value: function componentDidMount() {
      if (this.props.show) {
        this.setRippleSize();
        this.pulsate();
      }
    }
  }, {
    key: 'shouldComponentUpdate',
    value: function shouldComponentUpdate(nextProps, nextState) {
      return !(0, _shallowEqual2.default)(this.props, nextProps) || !(0, _shallowEqual2.default)(this.state, nextState);
    }
  }, {
    key: 'componentDidUpdate',
    value: function componentDidUpdate() {
      if (this.props.show) {
        this.setRippleSize();
        this.pulsate();
      } else {
        if (this.timeout) clearTimeout(this.timeout);
      }
    }
  }, {
    key: 'componentWillUnmount',
    value: function componentWillUnmount() {
      clearTimeout(this.timeout);
    }
  }, {
    key: 'getRippleElement',
    value: function getRippleElement(props) {
      var color = props.color,
          innerStyle = props.innerStyle,
          opacity = props.opacity;
      var _context$muiTheme = this.context.muiTheme,
          prepareStyles = _context$muiTheme.prepareStyles,
          ripple = _context$muiTheme.ripple;


      var innerStyles = (0, _simpleAssign2.default)({
        position: 'absolute',
        height: '100%',
        width: '100%',
        borderRadius: '50%',
        opacity: opacity ? opacity : 0.16,
        backgroundColor: color || ripple.color,
        transition: _transitions2.default.easeOut(pulsateDuration + 'ms', 'transform', null, _transitions2.default.easeInOutFunction)
      }, innerStyle);

      return _react2.default.createElement('div', { ref: 'innerCircle', style: prepareStyles((0, _simpleAssign2.default)({}, innerStyles)) });
    }
  }, {
    key: 'setRippleSize',
    value: function setRippleSize() {
      var el = _reactDom2.default.findDOMNode(this.refs.innerCircle);
      var height = el.offsetHeight;
      var width = el.offsetWidth;
      var size = Math.max(height, width);

      var oldTop = 0;
      // For browsers that don't support endsWith()
      if (el.style.top.indexOf('px', el.style.top.length - 2) !== -1) {
        oldTop = parseInt(el.style.top);
      }
      el.style.height = size + 'px';
      el.style.top = height / 2 - size / 2 + oldTop + 'px';
    }
  }, {
    key: 'render',
    value: function render() {
      var _props = this.props,
          show = _props.show,
          style = _props.style;


      var mergedRootStyles = (0, _simpleAssign2.default)({
        height: '100%',
        width: '100%',
        position: 'absolute',
        top: 0,
        left: 0
      }, style);

      var ripple = show ? this.getRippleElement(this.props) : null;

      return _react2.default.createElement(
        _ScaleIn2.default,
        {
          maxScale: 0.85,
          style: mergedRootStyles
        },
        ripple
      );
    }
  }]);

  return FocusRipple;
}(_react.Component);

FocusRipple.propTypes = {
  color: _react.PropTypes.string,
  innerStyle: _react.PropTypes.object,
  opacity: _react.PropTypes.number,
  show: _react.PropTypes.bool,
  style: _react.PropTypes.object
};
FocusRipple.contextTypes = {
  muiTheme: _react.PropTypes.object.isRequired
};
var _default = FocusRipple;
exports.default = _default;
;

var _temp2 = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(pulsateDuration, 'pulsateDuration', '/Users/tmac_zc/Code/kr-admin/src/Components/DatePicker/internal/FocusRipple.js');

  __REACT_HOT_LOADER__.register(FocusRipple, 'FocusRipple', '/Users/tmac_zc/Code/kr-admin/src/Components/DatePicker/internal/FocusRipple.js');

  __REACT_HOT_LOADER__.register(_default, 'default', '/Users/tmac_zc/Code/kr-admin/src/Components/DatePicker/internal/FocusRipple.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db21wb25lbnRzL0RhdGVQaWNrZXIvaW50ZXJuYWwvRm9jdXNSaXBwbGUuanMiXSwibmFtZXMiOlsicHVsc2F0ZUR1cmF0aW9uIiwiRm9jdXNSaXBwbGUiLCJwdWxzYXRlIiwiaW5uZXJDaXJjbGUiLCJmaW5kRE9NTm9kZSIsInJlZnMiLCJzdGFydFNjYWxlIiwiZW5kU2NhbGUiLCJjdXJyZW50U2NhbGUiLCJzdHlsZSIsInRyYW5zZm9ybSIsIm5leHRTY2FsZSIsInNldCIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicHJvcHMiLCJzaG93Iiwic2V0UmlwcGxlU2l6ZSIsIm5leHRQcm9wcyIsIm5leHRTdGF0ZSIsInN0YXRlIiwiY2xlYXJUaW1lb3V0IiwiY29sb3IiLCJpbm5lclN0eWxlIiwib3BhY2l0eSIsImNvbnRleHQiLCJtdWlUaGVtZSIsInByZXBhcmVTdHlsZXMiLCJyaXBwbGUiLCJpbm5lclN0eWxlcyIsInBvc2l0aW9uIiwiaGVpZ2h0Iiwid2lkdGgiLCJib3JkZXJSYWRpdXMiLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0cmFuc2l0aW9uIiwiZWFzZU91dCIsImVhc2VJbk91dEZ1bmN0aW9uIiwiZWwiLCJvZmZzZXRIZWlnaHQiLCJvZmZzZXRXaWR0aCIsInNpemUiLCJNYXRoIiwibWF4Iiwib2xkVG9wIiwidG9wIiwiaW5kZXhPZiIsImxlbmd0aCIsInBhcnNlSW50IiwibWVyZ2VkUm9vdFN0eWxlcyIsImxlZnQiLCJnZXRSaXBwbGVFbGVtZW50IiwicHJvcFR5cGVzIiwic3RyaW5nIiwib2JqZWN0IiwibnVtYmVyIiwiYm9vbCIsImNvbnRleHRUeXBlcyIsImlzUmVxdWlyZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsa0JBQWtCLEdBQXhCOztJQUVNQyxXOzs7Ozs7Ozs7Ozs7OztnTUE4REpDLE8sR0FBVSxZQUFN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O0FBQ0RQLFNBQUc3QixLQUFILENBQVNzQixNQUFULEdBQXFCVSxJQUFyQjtBQUNBSCxTQUFHN0IsS0FBSCxDQUFTb0MsR0FBVCxHQUFtQmQsU0FBUyxDQUFWLEdBQWdCVSxPQUFPLENBQXZCLEdBQTZCRyxNQUEvQztBQUNEOzs7NkJBRVE7QUFBQSxtQkFJSCxLQUFLN0IsS0FKRjtBQUFBLFVBRUxDLElBRkssVUFFTEEsSUFGSztBQUFBLFVBR0xQLEtBSEssVUFHTEEsS0FISzs7O0FBTVAsVUFBTXdDLG1CQUFtQiw0QkFBYztBQUNyQ2xCLGdCQUFRLE1BRDZCO0FBRXJDQyxlQUFPLE1BRjhCO0FBR3JDRixrQkFBVSxVQUgyQjtBQUlyQ2UsYUFBSyxDQUpnQztBQUtyQ0ssY0FBTTtBQUwrQixPQUFkLEVBTXRCekMsS0FOc0IsQ0FBekI7O0FBUUEsVUFBTW1CLFNBQVNaLE9BQU8sS0FBS21DLGdCQUFMLENBQXNCLEtBQUtwQyxLQUEzQixDQUFQLEdBQTJDLElBQTFEOztBQUVBLGFBQ0U7QUFBQTtBQUFBO0FBQ0Usb0JBQVUsSUFEWjtBQUVFLGlCQUFPa0M7QUFGVDtBQUlHckI7QUFKSCxPQURGO0FBUUQ7Ozs7OztBQWxIRzNCLFcsQ0FDR21ELFMsR0FBWTtBQUNqQjlCLFNBQU8saUJBQVUrQixNQURBO0FBRWpCOUIsY0FBWSxpQkFBVStCLE1BRkw7QUFHakI5QixXQUFTLGlCQUFVK0IsTUFIRjtBQUlqQnZDLFFBQU0saUJBQVV3QyxJQUpDO0FBS2pCL0MsU0FBTyxpQkFBVTZDO0FBTEEsQztBQURmckQsVyxDQVNHd0QsWSxHQUFlO0FBQ3BCL0IsWUFBVSxpQkFBVTRCLE1BQVYsQ0FBaUJJO0FBRFAsQztlQTRHVHpELFc7Ozs7Ozs7OztnQ0F2SFRELGU7O2dDQUVBQyxXIiwiZmlsZSI6IkZvY3VzUmlwcGxlLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy90bWFjX3pjL0NvZGUva3ItYWRtaW4iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIFByb3BUeXBlc30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgc2hhbGxvd0VxdWFsIGZyb20gJ3JlY29tcG9zZS9zaGFsbG93RXF1YWwnO1xuaW1wb3J0IGF1dG9QcmVmaXggZnJvbSAnLi4vdXRpbHMvYXV0b1ByZWZpeCc7XG5pbXBvcnQgdHJhbnNpdGlvbnMgZnJvbSAnLi4vc3R5bGVzL3RyYW5zaXRpb25zJztcbmltcG9ydCBTY2FsZUluVHJhbnNpdGlvbkdyb3VwIGZyb20gJy4vU2NhbGVJbic7XG5cbmNvbnN0IHB1bHNhdGVEdXJhdGlvbiA9IDc1MDtcblxuY2xhc3MgRm9jdXNSaXBwbGUgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIGNvbG9yOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGlubmVyU3R5bGU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgb3BhY2l0eTogUHJvcFR5cGVzLm51bWJlcixcbiAgICBzaG93OiBQcm9wVHlwZXMuYm9vbCxcbiAgICBzdHlsZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgfTtcblxuICBzdGF0aWMgY29udGV4dFR5cGVzID0ge1xuICAgIG11aVRoZW1lOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIH07XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuc2hvdykge1xuICAgICAgdGhpcy5zZXRSaXBwbGVTaXplKCk7XG4gICAgICB0aGlzLnB1bHNhdGUoKTtcbiAgICB9XG4gIH1cblxuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICByZXR1cm4gKFxuICAgICAgIXNoYWxsb3dFcXVhbCh0aGlzLnByb3BzLCBuZXh0UHJvcHMpIHx8XG4gICAgICAhc2hhbGxvd0VxdWFsKHRoaXMuc3RhdGUsIG5leHRTdGF0ZSlcbiAgICApO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgIGlmICh0aGlzLnByb3BzLnNob3cpIHtcbiAgICAgIHRoaXMuc2V0UmlwcGxlU2l6ZSgpO1xuICAgICAgdGhpcy5wdWxzYXRlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLnRpbWVvdXQpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICB9XG5cbiAgZ2V0UmlwcGxlRWxlbWVudChwcm9wcykge1xuICAgIGNvbnN0IHtcbiAgICAgIGNvbG9yLFxuICAgICAgaW5uZXJTdHlsZSxcbiAgICAgIG9wYWNpdHksXG4gICAgfSA9IHByb3BzO1xuXG4gICAgY29uc3Qge3ByZXBhcmVTdHlsZXMsIHJpcHBsZX0gPSB0aGlzLmNvbnRleHQubXVpVGhlbWU7XG5cbiAgICBjb25zdCBpbm5lclN0eWxlcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICBoZWlnaHQ6ICcxMDAlJyxcbiAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICBib3JkZXJSYWRpdXM6ICc1MCUnLFxuICAgICAgb3BhY2l0eTogb3BhY2l0eSA/IG9wYWNpdHkgOiAwLjE2LFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBjb2xvciB8fCByaXBwbGUuY29sb3IsXG4gICAgICB0cmFuc2l0aW9uOiB0cmFuc2l0aW9ucy5lYXNlT3V0KGAke3B1bHNhdGVEdXJhdGlvbn1tc2AsICd0cmFuc2Zvcm0nLCBudWxsLCB0cmFuc2l0aW9ucy5lYXNlSW5PdXRGdW5jdGlvbiksXG4gICAgfSwgaW5uZXJTdHlsZSk7XG5cbiAgICByZXR1cm4gPGRpdiByZWY9XCJpbm5lckNpcmNsZVwiIHN0eWxlPXtwcmVwYXJlU3R5bGVzKE9iamVjdC5hc3NpZ24oe30sIGlubmVyU3R5bGVzKSl9IC8+O1xuICB9XG5cbiAgcHVsc2F0ZSA9ICgpID0+IHtcbiAgICBjb25zdCBpbm5lckNpcmNsZSA9IFJlYWN0RE9NLmZpbmRET01Ob2RlKHRoaXMucmVmcy5pbm5lckNpcmNsZSk7XG4gICAgaWYgKCFpbm5lckNpcmNsZSkgcmV0dXJuO1xuXG4gICAgY29uc3Qgc3RhcnRTY2FsZSA9ICdzY2FsZSgxKSc7XG4gICAgY29uc3QgZW5kU2NhbGUgPSAnc2NhbGUoMC44NSknO1xuICAgIGNvbnN0IGN1cnJlbnRTY2FsZSA9IGlubmVyQ2lyY2xlLnN0eWxlLnRyYW5zZm9ybSB8fCBzdGFydFNjYWxlO1xuICAgIGNvbnN0IG5leHRTY2FsZSA9IGN1cnJlbnRTY2FsZSA9PT0gc3RhcnRTY2FsZSA/IGVuZFNjYWxlIDogc3RhcnRTY2FsZTtcblxuICAgIGF1dG9QcmVmaXguc2V0KGlubmVyQ2lyY2xlLnN0eWxlLCAndHJhbnNmb3JtJywgbmV4dFNjYWxlKTtcbiAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMucHVsc2F0ZSwgcHVsc2F0ZUR1cmF0aW9uKTtcbiAgfTtcblxuICBzZXRSaXBwbGVTaXplKCkge1xuICAgIGNvbnN0IGVsID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcy5yZWZzLmlubmVyQ2lyY2xlKTtcbiAgICBjb25zdCBoZWlnaHQgPSBlbC5vZmZzZXRIZWlnaHQ7XG4gICAgY29uc3Qgd2lkdGggPSBlbC5vZmZzZXRXaWR0aDtcbiAgICBjb25zdCBzaXplID0gTWF0aC5tYXgoaGVpZ2h0LCB3aWR0aCk7XG5cbiAgICBsZXQgb2xkVG9wID0gMDtcbiAgICAvLyBGb3IgYnJvd3NlcnMgdGhhdCBkb24ndCBzdXBwb3J0IGVuZHNXaXRoKClcbiAgICBpZiAoZWwuc3R5bGUudG9wLmluZGV4T2YoJ3B4JywgZWwuc3R5bGUudG9wLmxlbmd0aCAtIDIpICE9PSAtMSkge1xuICAgICAgb2xkVG9wID0gcGFyc2VJbnQoZWwuc3R5bGUudG9wKTtcbiAgICB9XG4gICAgZWwuc3R5bGUuaGVpZ2h0ID0gYCR7c2l6ZX1weGA7XG4gICAgZWwuc3R5bGUudG9wID0gYCR7KGhlaWdodCAvIDIpIC0gKHNpemUgLyAyICkgKyBvbGRUb3B9cHhgO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHNob3csXG4gICAgICBzdHlsZSxcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IG1lcmdlZFJvb3RTdHlsZXMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgIGhlaWdodDogJzEwMCUnLFxuICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMCxcbiAgICB9LCBzdHlsZSk7XG5cbiAgICBjb25zdCByaXBwbGUgPSBzaG93ID8gdGhpcy5nZXRSaXBwbGVFbGVtZW50KHRoaXMucHJvcHMpIDogbnVsbDtcblxuICAgIHJldHVybiAoXG4gICAgICA8U2NhbGVJblRyYW5zaXRpb25Hcm91cFxuICAgICAgICBtYXhTY2FsZT17MC44NX1cbiAgICAgICAgc3R5bGU9e21lcmdlZFJvb3RTdHlsZXN9XG4gICAgICA+XG4gICAgICAgIHtyaXBwbGV9XG4gICAgICA8L1NjYWxlSW5UcmFuc2l0aW9uR3JvdXA+XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb2N1c1JpcHBsZTtcbiJdfQ==