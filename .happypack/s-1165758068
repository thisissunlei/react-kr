'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _Redux = require('kr/Redux');

var _reactBinding = require('react-binding');

var _dateformat = require('dateformat');

var _dateformat2 = _interopRequireDefault(_dateformat);

var _reduxForm = require('redux-form');

var _krUi = require('kr-ui');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var SelectStationForm = function (_Component) {
	_inherits(SelectStationForm, _Component);

	function SelectStationForm(props, context) {
		_classCallCheck(this, SelectStationForm);

		var _this2 = _possibleConstructorReturn(this, (SelectStationForm.__proto__ || Object.getPrototypeOf(SelectStationForm)).call(this, props, context));

		_this2.onSubmit = _this2.onSubmit.bind(_this2);
		_this2.onCancel = _this2.onCancel.bind(_this2);
		_this2.onSelect = _this2.onSelect.bind(_this2);
		_this2.getLoadData = _this2.getLoadData.bind(_this2);
		_this2.onChangeRentBeginDate = _this2.onChangeRentBeginDate.bind(_this2);

		_this2.state = {
			stationVos: [],
			selected: []
		};

		return _this2;
	}

	_createClass(SelectStationForm, [{
		key: 'componentDidMount',
		value: function componentDidMount() {
			this.getLoadData();
		}
	}, {
		key: 'onChangeRentBeginDate',
		value: function onChangeRentBeginDate(value) {
			var _state = this.state,
			    stationVos = _state.stationVos,
			    selected = _state.selected;


			if (!selected.length) {
				_krUi.Notify.show([{
					message: '请先选择工位!',
					type: 'danger'
				}]);
				return;
			}

			value = (0, _dateformat2.default)(value, 'yyyy-mm-dd');

			if (!selected.length) {
				_krUi.Notify.show([{
					message: '未选择减租工位',
					type: 'danger'
				}]);
				return;
			}
			stationVos = [].concat(stationVos);
			stationVos.map(function (item, index) {
				if (selected.indexOf(index) !== -1) {
					item.rentBeginDate = value;
				} else {
					item.rentBeginDate = '';
				}
				return item;
			});

			this.setState({
				stationVos: stationVos
			});
		}
	}, {
		key: 'getLoadData',
		value: function getLoadData() {
			var _this = this;
			var params = this.context.params;

			_Redux.Store.dispatch(_Redux.Actions.callAPI('getStationOrSettingList', {
				mainBillid: params.orderId,
				page: 1,
				pagesize: 100
			})).then(function (response) {
				console.log('response', response);

				_this.setState({
					stationVos: response.items
				});
			}).catch(function (err) {
				_krUi.Notify.show([{
					message: '后台出错请联系管理员',
					type: 'danger'
				}]);
			});
		}
	}, {
		key: 'onSelect',
		value: function onSelect(selected) {
			this.setState({
				selected: selected
			}, function () {});
		}
	}, {
		key: 'onSubmit',
		value: function onSubmit() {
			console.log('1223');
			var _state2 = this.state,
			    stationVos = _state2.stationVos,
			    selected = _state2.selected;

			var selectedStationVos = [];

			selectedStationVos = stationVos.filter(function (item, index) {
				if (selected.indexOf(index) !== -1) {
					return true;
				}
				return false;
			});

			if (!selectedStationVos.length) {
				_krUi.Notify.show([{
					message: '请选择工位',
					type: 'danger'
				}]);

				return;
			}

			//选中的必须要有租赁结束日期
			var someStartDate = true;

			selectedStationVos.forEach(function (item, index) {
				if (!item.rentBeginDate) {
					someStartDate = false;
				}
			});

			if (!someStartDate) {
				_krUi.Notify.show([{
					message: '选择的工位必须要有减租开始时间',
					type: 'danger'
				}]);
				return;
			}

			//工位结束时间相同
			var some = true;
			selectedStationVos.sort(function (pre, next) {
				var preDate = (0, _dateformat2.default)(pre.leaseEndDate, 'yyyy-mm-dd');
				var nextDate = (0, _dateformat2.default)(next.leaseEndDate, 'yyyy-mm-dd');
				if (preDate != nextDate) {
					some = false;
				}
				return -1;
			});

			if (!some) {
				_krUi.Notify.show([{
					message: '请选择相同日期',
					type: 'danger'
				}]);
				return false;
			}

			//修改日期
			var resultStationVos = [];
			selectedStationVos.forEach(function (item, index) {
				var obj = {};
				obj.id = item.id;
				obj.stationId = item.stationId;
				obj.stationName = item.stationName;
				obj.unitprice = item.unitprice;
				obj.whereFloor = item.whereFloor;
				obj.stationType = item.stationType;

				obj.stationBeginDate = (0, _dateformat2.default)(item.leaseBeginDate, 'yyyy-mm-dd');
				obj.stationEndDate = (0, _dateformat2.default)(item.leaseEndDate, 'yyyy-mm-dd');

				obj.leaseBeginDate = (0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd');
				obj.leaseEndDate = (0, _dateformat2.default)(item.leaseEndDate, 'yyyy-mm-dd');
				obj.rentBeginDate = (0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd');

				resultStationVos.push(obj);
			});

			selectedStationVos = resultStationVos;

			//选择的减租开始日期必须要在工位的起始日期和结束日期范围内
			var isOK = 1;
			selectedStationVos.map(function (item, index) {
				var stationBeginDate = Date.parse((0, _dateformat2.default)(item.stationBeginDate, 'yyyy-mm-dd') + ' 00:00:00');
				var stationEndDate = Date.parse((0, _dateformat2.default)(item.stationEndDate, 'yyyy-mm-dd') + ' 00:00:00');
				var rentBeginDate = Date.parse((0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd') + ' 00:00:00');

				if (stationBeginDate >= rentBeginDate || rentBeginDate >= stationEndDate) {
					isOK = 0;
				}
			});

			if (!isOK) {
				_krUi.Notify.show([{
					message: '减租开始时间必须要在选择工位的租赁开始日期和结束日期之内',
					type: 'danger'
				}]);
				return false;
			}
			console.log('---->>>>', selectedStationVos);

			_Redux.Store.dispatch((0, _reduxForm.change)('reduceCreateForm', 'leaseBegindate', selectedStationVos[0].leaseEndDate));

			var onSubmit = this.props.onSubmit;

			onSubmit && onSubmit(selectedStationVos);
		}
	}, {
		key: 'onCancel',
		value: function onCancel() {
			var onCancel = this.props.onCancel;

			onCancel && onCancel();
		}
	}, {
		key: 'render',
		value: function render() {
			var _props = this.props,
			    error = _props.error,
			    handleSubmit = _props.handleSubmit,
			    pristine = _props.pristine,
			    reset = _props.reset,
			    submitting = _props.submitting;
			var stationVos = this.state.stationVos;

			var overfolw = {
				'overflow': 'hidden',
				maxHeight: 510
			};
			var height = {
				height: stationVos.length * 45,
				maxHeight: 667
			};
			return _react2.default.createElement(
				'div',
				{ style: { height: 667, marginTop: 20 } },
				_react2.default.createElement(
					'form',
					{ onSubmit: handleSubmit(this.onSubmit) },
					_react2.default.createElement(_krUi.KrField, { grid: 1 / 1, name: 'rentBeginDate', component: 'date', label: '\u51CF\u79DF\u5F00\u59CB\u65F6\u95F4\uFF1A', onChange: this.onChangeRentBeginDate, inline: true }),
					_react2.default.createElement(
						_krUi.Table,
						{ onSelect: this.onSelect, style: overfolw },
						_react2.default.createElement(
							_krUi.TableHeader,
							null,
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7C7B\u522B'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7F16\u53F7\uFF0F\u540D\u79F0'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u5355\u4EF7\uFF08\u5143\uFF0F\u6708\uFF09'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u8D77\u59CB\u65E5\u671F'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7ED3\u675F\u65E5\u671F'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u51CF\u79DF\u5F00\u59CB\u65E5\u671F'
							)
						),
						_react2.default.createElement(
							_krUi.TableBody,
							null,
							stationVos && stationVos.map(function (item, index) {
								return _react2.default.createElement(
									_krUi.TableRow,
									{ key: index },
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.stationType == 1 ? '工位' : '会议室'
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.stationName
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.unitprice
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										_react2.default.createElement(_krUi.KrDate, { value: item.leaseBeginDate })
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										_react2.default.createElement(_krUi.KrDate, { value: item.leaseEndDate })
									),
									_react2.default.createElement(
										_krUi.TableRowColumn,
										null,
										item.rentBeginDate && (0, _dateformat2.default)(item.rentBeginDate, 'yyyy-mm-dd')
									)
								);
							})
						)
					),
					_react2.default.createElement(
						_krUi.Grid,
						null,
						_react2.default.createElement(
							_krUi.Row,
							{ style: { marginTop: 30, paddingBottom: 24 } },
							_react2.default.createElement(_krUi.Col, { md: 4 }),
							_react2.default.createElement(
								_krUi.Col,
								{ md: 2, align: 'center' },
								' ',
								_react2.default.createElement(_krUi.Button, { label: '\u786E\u5B9A', type: 'button', onClick: this.onSubmit }),
								' '
							),
							_react2.default.createElement(
								_krUi.Col,
								{ md: 2, align: 'center' },
								' ',
								_react2.default.createElement(_krUi.Button, { label: '\u53D6\u6D88', type: 'button', cancle: true, onClick: this.onCancel }),
								' '
							),
							_react2.default.createElement(_krUi.Col, { md: 4 })
						)
					)
				)
			);
		}
	}]);

	return SelectStationForm;
}(_react.Component);

SelectStationForm.PropTypes = {
	searchParams: _react2.default.PropTypes.object,
	onSubmit: _react2.default.PropTypes.func,
	onCancel: _react2.default.PropTypes.func
};
SelectStationForm.contextTypes = {
	params: _react2.default.PropTypes.object.isRequired
};

var _default = (0, _reduxForm.reduxForm)({
	form: 'selectStationForm',
	enableReinitialize: true,
	keepDirtyOnReinitialize: true
})(SelectStationForm);

exports.default = _default;
;

var _temp = function () {
	if (typeof __REACT_HOT_LOADER__ === 'undefined') {
		return;
	}

	__REACT_HOT_LOADER__.register(SelectStationForm, 'SelectStationForm', '/Users/liuyihao/Code/kr-admin/src/Containers/Operation/CustomerManage/Agreement/Reduce/Create/AllStation.js');

	__REACT_HOT_LOADER__.register(_default, 'default', '/Users/liuyihao/Code/kr-admin/src/Containers/Operation/CustomerManage/Agreement/Reduce/Create/AllStation.js');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db250YWluZXJzL09wZXJhdGlvbi9DdXN0b21lck1hbmFnZS9BZ3JlZW1lbnQvUmVkdWNlL0NyZWF0ZS9BbGxTdGF0aW9uLmpzIl0sIm5hbWVzIjpbIlNlbGVjdFN0YXRpb25Gb3JtIiwicHJvcHMiLCJjb250ZXh0Iiwib25TdWJtaXQiLCJiaW5kIiwib25DYW5jZWwiLCJvblNlbGVjdCIsImdldExvYWREYXRhIiwib25DaGFuZ2VSZW50QmVnaW5EYXRlIiwic3RhdGUiLCJzdGF0aW9uVm9zIiwic2VsZWN0ZWQiLCJ2YWx1ZSIsImxlbmd0aCIsInNob3ciLCJtZXNzYWdlIiwidHlwZSIsImNvbmNhdCIsIm1hcCIsIml0ZW0iLCJpbmRleCIsImluZGV4T2YiLCJyZW50QmVnaW5EYXRlIiwic2V0U3RhdGUiLCJfdGhpcyIsInBhcmFtcyIsImRpc3BhdGNoIiwiY2FsbEFQSSIsIm1haW5CaWxsaWQiLCJvcmRlcklkIiwicGFnZSIsInBhZ2VzaXplIiwidGhlbiIsInJlc3BvbnNlIiwiY29uc29sZSIsImxvZyIsIml0ZW1zIiwiY2F0Y2giLCJlcnIiLCJzZWxlY3RlZFN0YXRpb25Wb3MiLCJmaWx0ZXIiLCJzb21lU3RhcnREYXRlIiwiZm9yRWFjaCIsInNvbWUiLCJzb3J0IiwicHJlIiwibmV4dCIsInByZURhdGUiLCJsZWFzZUVuZERhdGUiLCJuZXh0RGF0ZSIsInJlc3VsdFN0YXRpb25Wb3MiLCJvYmoiLCJpZCIsInN0YXRpb25JZCIsInN0YXRpb25OYW1lIiwidW5pdHByaWNlIiwid2hlcmVGbG9vciIsInN0YXRpb25UeXBlIiwic3RhdGlvbkJlZ2luRGF0ZSIsImxlYXNlQmVnaW5EYXRlIiwic3RhdGlvbkVuZERhdGUiLCJwdXNoIiwiaXNPSyIsIkRhdGUiLCJwYXJzZSIsImVycm9yIiwiaGFuZGxlU3VibWl0IiwicHJpc3RpbmUiLCJyZXNldCIsInN1Ym1pdHRpbmciLCJvdmVyZm9sdyIsIm1heEhlaWdodCIsImhlaWdodCIsIm1hcmdpblRvcCIsInBhZGRpbmdCb3R0b20iLCJQcm9wVHlwZXMiLCJzZWFyY2hQYXJhbXMiLCJvYmplY3QiLCJmdW5jIiwiY29udGV4dFR5cGVzIiwiaXNSZXF1aXJlZCIsImZvcm0iLCJlbmFibGVSZWluaXRpYWxpemUiLCJrZWVwRGlydHlPblJlaW5pdGlhbGl6ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7OztBQUlBOztBQUdBOztBQUdBOzs7O0FBQ0E7O0FBZUE7Ozs7Ozs7Ozs7SUFrQk1BLGlCOzs7QUFVTCw0QkFBWUMsS0FBWixFQUFtQkMsT0FBbkIsRUFBNEI7QUFBQTs7QUFBQSxxSUFDckJELEtBRHFCLEVBQ2RDLE9BRGM7O0FBSTNCLFNBQUtDLFFBQUwsR0FBZ0IsT0FBS0EsUUFBTCxDQUFjQyxJQUFkLFFBQWhCO0FBQ0EsU0FBS0MsUUFBTCxHQUFnQixPQUFLQSxRQUFMLENBQWNELElBQWQsUUFBaEI7QUFDQSxTQUFLRSxRQUFMLEdBQWdCLE9BQUtBLFFBQUwsQ0FBY0YsSUFBZCxRQUFoQjtBQUNBLFNBQUtHLFdBQUwsR0FBbUIsT0FBS0EsV0FBTCxDQUFpQkgsSUFBakIsUUFBbkI7QUFDQSxTQUFLSSxxQkFBTCxHQUE2QixPQUFLQSxxQkFBTCxDQUEyQkosSUFBM0IsUUFBN0I7O0FBRUEsU0FBS0ssS0FBTCxHQUFhO0FBQ1pDLGVBQVksRUFEQTtBQUVaQyxhQUFVO0FBRkUsR0FBYjs7QUFWMkI7QUFlM0I7Ozs7c0NBRW1CO0FBQ25CLFFBQUtKLFdBQUw7QUFDQTs7O3dDQUdxQkssSyxFQUFPO0FBQUEsZ0JBS3hCLEtBQUtILEtBTG1CO0FBQUEsT0FHM0JDLFVBSDJCLFVBRzNCQSxVQUgyQjtBQUFBLE9BSTNCQyxRQUoyQixVQUkzQkEsUUFKMkI7OztBQU81QixPQUFJLENBQUNBLFNBQVNFLE1BQWQsRUFBc0I7QUFDckIsaUJBQU9DLElBQVAsQ0FBWSxDQUFDO0FBQ1pDLGNBQVMsU0FERztBQUVaQyxXQUFNO0FBRk0sS0FBRCxDQUFaO0FBSUE7QUFDQTs7QUFFREosV0FBUSwwQkFBV0EsS0FBWCxF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RUUyRSxTLEdBQVk7QUFDbEJDLGVBQWMsZ0JBQU1ELFNBQU4sQ0FBZ0JFLE1BRFo7QUFFbEIxRSxXQUFVLGdCQUFNd0UsU0FBTixDQUFnQkcsSUFGUjtBQUdsQnpFLFdBQVUsZ0JBQU1zRSxTQUFOLENBQWdCRztBQUhSLEM7QUFGZDlFLGlCLENBT0UrRSxZLEdBQWU7QUFDckJ0RCxTQUFRLGdCQUFNa0QsU0FBTixDQUFnQkUsTUFBaEIsQ0FBdUJHO0FBRFYsQzs7ZUE0UlIsMEJBQVU7QUFDeEJDLE9BQU0sbUJBRGtCO0FBRXhCQyxxQkFBb0IsSUFGSTtBQUd4QkMsMEJBQXlCO0FBSEQsQ0FBVixFQUlabkYsaUJBSlksQzs7Ozs7Ozs7OzsrQkFuU1RBLGlCIiwiZmlsZSI6IkFsbFN0YXRpb24uanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2xpdXlpaGFvL0NvZGUva3ItYWRtaW4iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtcblx0Q29tcG9uZW50LFxuXHRQcm9wVHlwZXNcbn0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcblx0Y29ubmVjdFxufSBmcm9tICdrci9SZWR1eCc7XG5pbXBvcnQge1xuXHRCaW5kZXJcbn0gZnJvbSAncmVhY3QtYmluZGluZyc7XG5pbXBvcnQgZGF0ZUZvcm1hdCBmcm9tICdkYXRlZm9ybWF0JztcbmltcG9ydCB7XG5cdHJlZHV4Rm9ybSxcblx0Zm9ybVZhbHVlU2VsZWN0b3IsXG5cdGNoYW5nZSxcblx0aW5pdGlhbGl6ZSxcblx0YXJyYXlQdXNoLFxuXHRhcnJheUluc2VydCxcblx0RmllbGRBcnJheVxufSBmcm9tICdyZWR1eC1mb3JtJztcblxuaW1wb3J0IHtcblx0QWN0aW9ucyxcblx0U3RvcmVcbn0gZnJvbSAna3IvUmVkdXgnO1xuXG5pbXBvcnQge1xuXHRGb3JtLFxuXHRUYWJsZSxcblx0VGFibGVCb2R5LFxuXHRUYWJsZUhlYWRlcixcblx0VGFibGVIZWFkZXJDb2x1bW4sXG5cdFRhYmxlUm93LFxuXHRUYWJsZVJvd0NvbHVtbixcblx0VGFibGVGb290ZXIsXG5cdEtyRmllbGQsXG5cdEdyaWQsXG5cdFJvdyxcblx0Q29sLFxuXHRCdXR0b24sXG5cdE5vdGlmeSxcblx0S3JEYXRlLFxufSBmcm9tICdrci11aSc7XG5cbmNsYXNzIFNlbGVjdFN0YXRpb25Gb3JtIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuXHRzdGF0aWMgUHJvcFR5cGVzID0ge1xuXHRcdHNlYXJjaFBhcmFtczogUmVhY3QuUHJvcFR5cGVzLm9iamVjdCxcblx0XHRvblN1Ym1pdDogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG5cdFx0b25DYW5jZWw6IFJlYWN0LlByb3BUeXBlcy5mdW5jLFxuXHR9XG5cdHN0YXRpYyBjb250ZXh0VHlwZXMgPSB7XG5cdFx0cGFyYW1zOiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcblx0fVxuXHRjb25zdHJ1Y3Rvcihwcm9wcywgY29udGV4dCkge1xuXHRcdHN1cGVyKHByb3BzLCBjb250ZXh0KTtcblxuXG5cdFx0dGhpcy5vblN1Ym1pdCA9IHRoaXMub25TdWJtaXQuYmluZCh0aGlzKTtcblx0XHR0aGlzLm9uQ2FuY2VsID0gdGhpcy5vbkNhbmNlbC5iaW5kKHRoaXMpO1xuXHRcdHRoaXMub25TZWxlY3QgPSB0aGlzLm9uU2VsZWN0LmJpbmQodGhpcyk7XG5cdFx0dGhpcy5nZXRMb2FkRGF0YSA9IHRoaXMuZ2V0TG9hZERhdGEuYmluZCh0aGlzKTtcblx0XHR0aGlzLm9uQ2hhbmdlUmVudEJlZ2luRGF0ZSA9IHRoaXMub25DaGFuZ2VSZW50QmVnaW5EYXRlLmJpbmQodGhpcyk7XG5cblx0XHR0aGlzLnN0YXRlID0ge1xuXHRcdFx0c3RhdGlvblZvczogW10sXG5cdFx0XHRzZWxlY3RlZDogW10sXG5cdFx0fVxuXG5cdH1cblxuXHRjb21wb25lbnREaWRNb3VudCgpIHtcblx0XHR0aGlzLmdldExvYWREYXRhKCk7XG5cdH1cblxuXG5cdG9uQ2hhbmdlUmVudEJlZ2luRGF0ZSh2YWx1ZSkge1xuXG5cdFx0bGV0IHtcblx0XHRcdHN0YXRpb25Wb3MsXG5cdFx0XHRzZWxlY3RlZFxuXHRcdH0gPSB0aGlzLnN0YXRlO1xuXG5cdFx0aWYgKCFzZWxlY3RlZC5sZW5ndGgpIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICfor7flhYjpgInmi6nlt6XkvY0hJyxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFsdWUgPSBkYXRlRm9ybWF0KHZhbHVlLCAneXl5eS1tbS1kZCcpO1xuXG5cdFx0aWYgKCFzZWxlY3RlZC5sZW5ndGgpIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICfmnKrpgInmi6nlh4/np5/lt6XkvY0nLFxuXHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdH1dKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0c3RhdGlvblZvcyA9IFtdLmNvbmNhdChzdGF0aW9uVm9zKTtcblx0XHRzdGF0aW9uVm9zLm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHRcdFx0aWYgKHNlbGVjdGVkLmluZGV4T2YoaW5kZXgpICE9PSAtMSkge1xuXHRcdFx0XHRpdGVtLnJlbnRCZWdpbkRhdGUgPSB2YWx1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW0ucmVudEJlZ2luRGF0ZSA9ICcnO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGl0ZW07XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNldFN0YXRlKHtcblx0XHRcdHN0YXRpb25Wb3Ncblx0XHR9KTtcblxuXHR9XG5cblxuXHRnZXRMb2FkRGF0YSgpIHtcblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdGxldCB7XG5cdFx0XHRwYXJhbXNcblx0XHR9ID0gdGhpcy5jb250ZXh0O1xuXHRcdFN0b3JlLmRpc3BhdGNoKEFjdGlvbnMuY2FsbEFQSSgnZ2V0U3RhdGlvbk9yU2V0dGluZ0xpc3QnLCB7XG5cdFx0XHRtYWluQmlsbGlkOiBwYXJhbXMub3JkZXJJZCxcblx0XHRcdHBhZ2U6IDEsXG5cdFx0XHRwYWdlc2l6ZTogMTAwXG5cdFx0fSkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdyZXNwb25zZScsIHJlc3BvbnNlKVxuXG5cdFx0XHRfdGhpcy5zZXRTdGF0ZSh7XG5cdFx0XHRcdHN0YXRpb25Wb3M6IHJlc3BvbnNlLml0ZW1zXG5cdFx0XHR9KTtcblx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICflkI7lj7Dlh7rplJnor7fogZTns7vnrqHnkIblkZgnLFxuXHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdH1dKTtcblx0XHR9KTtcblx0fVxuXG5cdG9uU2VsZWN0KHNlbGVjdGVkKSB7XG5cdFx0dGhpcy5zZXRTdGF0ZSh7XG5cdFx0XHRzZWxlY3RlZFxuXHRcdH0sIGZ1bmN0aW9uKCkge1xuXG5cdFx0fSk7XG5cdH1cblxuXHRvblN1Ym1pdCgpIHtcblx0XHRjb25zb2xlLmxvZygnMTIyMycpXG5cdFx0bGV0IHtcblx0XHRcdHN0YXRpb25Wb3MsXG5cdFx0XHRzZWxlY3RlZFxuXHRcdH0gPSB0aGlzLnN0YXRlO1xuXHRcdGxldCBzZWxlY3RlZFN0YXRpb25Wb3MgPSBbXTtcblxuXHRcdHNlbGVjdGVkU3RhdGlvblZvcyA9IHN0YXRpb25Wb3MuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0XHRpZiAoc2VsZWN0ZWQuaW5kZXhPZihpbmRleCkgIT09IC0xKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH0pO1xuXG5cblx0XHRpZiAoIXNlbGVjdGVkU3RhdGlvblZvcy5sZW5ndGgpIHtcblx0XHRcdE5vdGlmeS5zaG93KFt7XG5cdFx0XHRcdG1lc3NhZ2U6ICfor7fpgInmi6nlt6XkvY0nLFxuXHRcdFx0XHR0eXBlOiAnZGFuZ2VyJyxcblx0XHRcdH1dKTtcblxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8v6YCJ5Lit55qE5b+F6aG76KaB5pyJ56ef6LWB57uT5p2f5pel5pyfXG5cdFx0dmFyIHNvbWVTdGFydERhdGUgPSB0cnVlO1xuXG5cdFx0c2VsZWN0ZWRTdGF0aW9uVm9zLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcblx0XHRcdGlmICghaXRlbS5yZW50QmVnaW5EYXRlKSB7XG5cdFx0XHRcdHNvbWVTdGFydERhdGUgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGlmICghc29tZVN0YXJ0RGF0ZSkge1xuXHRcdFx0Tm90aWZ5LnNob3coW3tcblx0XHRcdFx0bWVzc2FnZTogJ+mAieaLqeeahOW3peS9jeW/hemhu+imgeacieWHj+enn+W8gOWni+aXtumXtCcsXG5cdFx0XHRcdHR5cGU6ICdkYW5nZXInLFxuXHRcdFx0fV0pO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8v5bel5L2N57uT5p2f5pe26Ze055u45ZCMXG5cdFx0dmFyIHNvbWUgPSB0cnVlO1xuXHRcdHNlbGVjdGVkU3RhdGlvblZvcy5zb3J0KGZ1bmN0aW9uKHByZSwgbmV4dCkge1xuXHRcdFx0dmFyIHByZURhdGUgPSBkYXRlRm9ybWF0KHByZS5sZWFzZUVuZERhdGUsICd5eXl5LW1tLWRkJyk7XG5cdFx0XHR2YXIgbmV4dERhdGUgPSBkYXRlRm9ybWF0KG5leHQubGVhc2VFbmREYXRlLCAneXl5eS1tbS1kZCcpO1xuXHRcdFx0aWYgKHByZURhdGUgIT0gbmV4dERhdGUpIHtcblx0XHRcdFx0c29tZSA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIC0xO1xuXHRcdH0pO1xuXG5cdFx0aWYgKCFzb21lKSB7XG5cdFx0XHROb3RpZnkuc2hvdyhbe1xuXHRcdFx0XHRtZXNzYWdlOiAn6K+36YCJ5oup55u45ZCM5pel5pyfJyxcblx0XHRcdFx0dHlwZTogJ2RhbmdlcicsXG5cdFx0XHR9XSk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly/kv67mlLnml6XmnJ9cblx0XHR2YXIgcmVzdWx0U3RhdGlvblZvcyA9IFtdO1xuXHRcdHNlbGVjdGVkU3RhdGlvblZvcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0XHR2YXIgb2JqID0ge307XG5cdFx0XHRvYmouaWQgPSBpdGVtLmlkO1xuXHRcdFx0b2JqLnN0YXRpb25JZCA9IGl0ZW0uc3RhdGlvbklkO1xuXHRcdFx0b2JqLnN0YXRpb25OYW1lID0gaXRlbS5zdGF0aW9uTmFtZTtcblx0XHRcdG9iai51bml0cHJpY2UgPSBpdGVtLnVuaXRwcmljZTtcblx0XHRcdG9iai53aGVyZUZsb29yID0gaXRlbS53aGVyZUZsb29yO1xuXHRcdFx0b2JqLnN0YXRpb25UeXBlID0gaXRlbS5zdGF0aW9uVHlwZTtcblxuXHRcdFx0b2JqLnN0YXRpb25CZWdpbkRhdGUgPSBkYXRlRm9ybWF0KGl0ZW0ubGVhc2VCZWdpbkRhdGUsICd5eXl5LW1tLWRkJyk7XG5cdFx0XHRvYmouc3RhdGlvbkVuZERhdGUgPSBkYXRlRm9ybWF0KGl0ZW0ubGVhc2VFbmREYXRlLCAneXl5eS1tbS1kZCcpO1xuXG5cdFx0XHRvYmoubGVhc2VCZWdpbkRhdGUgPSBkYXRlRm9ybWF0KGl0ZW0ucmVudEJlZ2luRGF0ZSwgJ3l5eXktbW0tZGQnKTtcblx0XHRcdG9iai5sZWFzZUVuZERhdGUgPSBkYXRlRm9ybWF0KGl0ZW0ubGVhc2VFbmREYXRlLCAneXl5eS1tbS1kZCcpO1xuXHRcdFx0b2JqLnJlbnRCZWdpbkRhdGUgPSBkYXRlRm9ybWF0KGl0ZW0ucmVudEJlZ2luRGF0ZSwgJ3l5eXktbW0tZGQnKTtcblxuXG5cblx0XHRcdHJlc3VsdFN0YXRpb25Wb3MucHVzaChvYmopO1xuXHRcdH0pO1xuXG5cdFx0c2VsZWN0ZWRTdGF0aW9uVm9zID0gcmVzdWx0U3RhdGlvblZvcztcblxuXG5cdFx0Ly/pgInmi6nnmoTlh4/np5/lvIDlp4vml6XmnJ/lv4XpobvopoHlnKjlt6XkvY3nmoTotbflp4vml6XmnJ/lkoznu5PmnZ/ml6XmnJ/ojIPlm7TlhoVcblx0XHR2YXIgaXNPSyA9IDE7XG5cdFx0c2VsZWN0ZWRTdGF0aW9uVm9zLm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHRcdFx0dmFyIHN0YXRpb25CZWdpbkRhdGUgPSBEYXRlLnBhcnNlKGRhdGVGb3JtYXQoaXRlbS5zdGF0aW9uQmVnaW5EYXRlLCAneXl5eS1tbS1kZCcpICsgJyAwMDowMDowMCcpO1xuXHRcdFx0dmFyIHN0YXRpb25FbmREYXRlID0gRGF0ZS5wYXJzZShkYXRlRm9ybWF0KGl0ZW0uc3RhdGlvbkVuZERhdGUsICd5eXl5LW1tLWRkJykgKyAnIDAwOjAwOjAwJyk7XG5cdFx0XHR2YXIgcmVudEJlZ2luRGF0ZSA9IERhdGUucGFyc2UoZGF0ZUZvcm1hdChpdGVtLnJlbnRCZWdpbkRhdGUsICd5eXl5LW1tLWRkJykgKyAnIDAwOjAwOjAwJyk7XG5cblx0XHRcdGlmIChzdGF0aW9uQmVnaW5EYXRlID49IHJlbnRCZWdpbkRhdGUgfHwgcmVudEJlZ2luRGF0ZSA+PSBzdGF0aW9uRW5kRGF0ZSkge1xuXHRcdFx0XHRpc09LID0gMDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGlmICghaXNPSykge1xuXHRcdFx0Tm90aWZ5LnNob3coW3tcblx0XHRcdFx0bWVzc2FnZTogJ+WHj+enn+W8gOWni+aXtumXtOW/hemhu+imgeWcqOmAieaLqeW3peS9jeeahOenn+i1geW8gOWni+aXpeacn+WSjOe7k+adn+aXpeacn+S5i+WGhScsXG5cdFx0XHRcdHR5cGU6ICdkYW5nZXInLFxuXHRcdFx0fV0pO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRjb25zb2xlLmxvZygnLS0tLT4+Pj4nLCBzZWxlY3RlZFN0YXRpb25Wb3MpXG5cblx0XHRTdG9yZS5kaXNwYXRjaChjaGFuZ2UoJ3JlZHVjZUNyZWF0ZUZvcm0nLCAnbGVhc2VCZWdpbmRhdGUnLCBzZWxlY3RlZFN0YXRpb25Wb3NbMF0ubGVhc2VFbmREYXRlKSk7XG5cblx0XHRjb25zdCB7XG5cdFx0XHRvblN1Ym1pdFxuXHRcdH0gPSB0aGlzLnByb3BzO1xuXHRcdG9uU3VibWl0ICYmIG9uU3VibWl0KHNlbGVjdGVkU3RhdGlvblZvcyk7XG5cdH1cblxuXG5cdG9uQ2FuY2VsKCkge1xuXHRcdGNvbnN0IHtcblx0XHRcdG9uQ2FuY2VsXG5cdFx0fSA9IHRoaXMucHJvcHM7XG5cdFx0b25DYW5jZWwgJiYgb25DYW5jZWwoKTtcblx0fVxuXG5cdHJlbmRlcigpIHtcblxuXHRcdGxldCB7XG5cdFx0XHRlcnJvcixcblx0XHRcdGhhbmRsZVN1Ym1pdCxcblx0XHRcdHByaXN0aW5lLFxuXHRcdFx0cmVzZXQsXG5cdFx0XHRzdWJtaXR0aW5nXG5cdFx0fSA9IHRoaXMucHJvcHM7XG5cdFx0bGV0IHtcblx0XHRcdHN0YXRpb25Wb3Ncblx0XHR9ID0gdGhpcy5zdGF0ZTtcblx0XHRjb25zdCBvdmVyZm9sdyA9IHtcblx0XHRcdCdvdmVyZmxvdyc6ICdoaWRkZW4nLFxuXHRcdFx0bWF4SGVpZ2h0OiA1MTAsXG5cdFx0fVxuXHRcdGNvbnN0IGhlaWdodCA9IHtcblx0XHRcdGhlaWdodDogc3RhdGlvblZvcy5sZW5ndGggKiA0NSxcblx0XHRcdG1heEhlaWdodDogNjY3LFxuXHRcdH1cblx0XHRyZXR1cm4gKFxuXHRcdFx0PGRpdiBzdHlsZT17e2hlaWdodDo2NjcsbWFyZ2luVG9wOjIwfX0+XG48Zm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0KHRoaXMub25TdWJtaXQpfT5cblx0XHRcdDxLckZpZWxkIGdyaWQ9ezEvMX0gIG5hbWU9XCJyZW50QmVnaW5EYXRlXCIgY29tcG9uZW50PVwiZGF0ZVwiIGxhYmVsPVwi5YeP56ef5byA5aeL5pe26Ze077yaXCIgb25DaGFuZ2U9e3RoaXMub25DaGFuZ2VSZW50QmVnaW5EYXRlfSBpbmxpbmU9e3RydWV9Lz5cbiAgICAgIDxUYWJsZSBvblNlbGVjdD17dGhpcy5vblNlbGVjdH0gc3R5bGU9e292ZXJmb2x3fT5cbiAgICAgICAgPFRhYmxlSGVhZGVyPlxuICAgICAgICAgIDxUYWJsZUhlYWRlckNvbHVtbj7nsbvliKs8L1RhYmxlSGVhZGVyQ29sdW1uPlxuICAgICAgICAgIDxUYWJsZUhlYWRlckNvbHVtbj7nvJblj7fvvI/lkI3np7A8L1RhYmxlSGVhZGVyQ29sdW1uPlxuICAgICAgICAgIDxUYWJsZUhlYWRlckNvbHVtbj7ljZXku7fvvIjlhYPvvI/mnIjvvIk8L1RhYmxlSGVhZGVyQ29sdW1uPlxuICAgICAgICAgIDxUYWJsZUhlYWRlckNvbHVtbj7otbflp4vml6XmnJ88L1RhYmxlSGVhZGVyQ29sdW1uPlxuICAgICAgICAgIDxUYWJsZUhlYWRlckNvbHVtbj7nu5PmnZ/ml6XmnJ88L1RhYmxlSGVhZGVyQ29sdW1uPlxuICAgICAgICAgIDxUYWJsZUhlYWRlckNvbHVtbj7lh4/np5/lvIDlp4vml6XmnJ88L1RhYmxlSGVhZGVyQ29sdW1uPlxuICAgICAgPC9UYWJsZUhlYWRlcj5cbiAgICAgIDxUYWJsZUJvZHk+XG4gICAgICB7c3RhdGlvblZvcyAmJiBzdGF0aW9uVm9zLm1hcCgoaXRlbSxpbmRleCk9PntcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8VGFibGVSb3cga2V5PXtpbmRleH0+XG5cdCAgICAgICAgICA8VGFibGVSb3dDb2x1bW4gPnsoaXRlbS5zdGF0aW9uVHlwZSA9PSAxKSA/J+W3peS9jSc6J+S8muiuruWupCd9PC9UYWJsZVJvd0NvbHVtbj5cblx0ICAgICAgICAgIDxUYWJsZVJvd0NvbHVtbiA+e2l0ZW0uc3RhdGlvbk5hbWV9PC9UYWJsZVJvd0NvbHVtbj5cblx0ICAgICAgICAgIDxUYWJsZVJvd0NvbHVtbiA+e2l0ZW0udW5pdHByaWNlfTwvVGFibGVSb3dDb2x1bW4+XG5cdCAgICAgICAgICA8VGFibGVSb3dDb2x1bW4gPjxLckRhdGUgdmFsdWU9e2l0ZW0ubGVhc2VCZWdpbkRhdGV9Lz48L1RhYmxlUm93Q29sdW1uPlxuXHQgICAgICAgICAgPFRhYmxlUm93Q29sdW1uID48S3JEYXRlIHZhbHVlPXtpdGVtLmxlYXNlRW5kRGF0ZX0vPjwvVGFibGVSb3dDb2x1bW4+XG5cdCAgICAgICAgICA8VGFibGVSb3dDb2x1bW4+XG5cdFx0XHRcdFx0e2l0ZW0ucmVudEJlZ2luRGF0ZSYmIGRhdGVGb3JtYXQoaXRlbS5yZW50QmVnaW5EYXRlLCd5eXl5LW1tLWRkJyl9XG5cdCAgICAgICAgICA8L1RhYmxlUm93Q29sdW1uPlxuICAgICAgICAgPC9UYWJsZVJvdz5cbiAgICAgICAgKTtcbiAgICAgIH0pfVxuICAgICAgPC9UYWJsZUJvZHk+XG4gICAgICA8L1RhYmxlPlxuICAgICAgPEdyaWQ+XG4gICAgICA8Um93IHN0eWxlPXt7bWFyZ2luVG9wOjMwLHBhZGRpbmdCb3R0b206MjR9fT5cbiAgICAgIDxDb2wgbWQ9ezR9PjwvQ29sPlxuICAgICAgPENvbCBtZD17Mn0gYWxpZ249XCJjZW50ZXJcIj4gPEJ1dHRvbiAgbGFiZWw9XCLnoa7lrppcIiB0eXBlPVwiYnV0dG9uXCIgb25DbGljaz17dGhpcy5vblN1Ym1pdH0gIC8+IDwvQ29sPlxuICAgICAgPENvbCBtZD17Mn0gYWxpZ249XCJjZW50ZXJcIj4gPEJ1dHRvbiAgbGFiZWw9XCLlj5bmtohcIiB0eXBlPVwiYnV0dG9uXCIgY2FuY2xlPXt0cnVlfSBvbkNsaWNrPXt0aGlzLm9uQ2FuY2VsfS8+IDwvQ29sPlxuICAgICAgPENvbCBtZD17NH0+PC9Db2w+XG4gICAgICAgPC9Sb3c+XG4gICAgICA8L0dyaWQ+XG48L2Zvcm0+XG5cdFx0XHQ8L2Rpdj4pO1xuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlZHV4Rm9ybSh7XG5cdGZvcm06ICdzZWxlY3RTdGF0aW9uRm9ybScsXG5cdGVuYWJsZVJlaW5pdGlhbGl6ZTogdHJ1ZSxcblx0a2VlcERpcnR5T25SZWluaXRpYWxpemU6IHRydWVcbn0pKFNlbGVjdFN0YXRpb25Gb3JtKTsiXX0=