{"version":3,"sources":["src/Components/KrField/FileUploadComponent/index.js"],"names":["FileUploadComponent","props","onChange","bind","onSuccess","onError","onTokenSuccess","onTokenError","onSetInputValue","setInitValue","defaultValue","state","isInit","form","files","isUploading","progress","setState","nextProps","length","_this","window","setTimeout","input","fileIds","forEach","item","index","push","id","toString","splice","message","show","type","response","fileUrl","sourceservicetoken","operater","fileName","filename","unshift","event","file","target","timer","setInterval","clearInterval","FormData","append","xhr","XMLHttpRequest","onreadystatechange","readyState","status","data","token","docTypeCode","xhrfile","fileResponse","code","msg","onerror","e","console","error","statusText","open","responseType","send","label","meta","touched","style","requireLabel","multiple","accept","inline","fileBgStyles","showList","visibility","display","width","map","onFileDelete","Component","defaultProps","PropTypes","bool","string","array","func"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React from 'react';\nimport Notify from '../../Notify';\nimport Promise from 'promise-polyfill';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\n\n\nimport WrapComponent from '../WrapComponent';\n\nimport './index.less';\n\nexport default class FileUploadComponent extends React.Component {\n\n\tstatic defaultProps = {\n\t\tmultiple: true,\n\t\tdefaultValue: []\n\t}\n\n\tstatic PropTypes = {\n\t\tmultiple: React.PropTypes.bool,\n\t\taccept: React.PropTypes.string,\n\t\tdefaultValue: React.PropTypes.array,\n\t\tonChange: React.PropTypes.func,\n\t\tinline: React.PropTypes.bool\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.onChange = this.onChange.bind(this);\n\t\tthis.onSuccess = this.onSuccess.bind(this);\n\t\tthis.onError = this.onError.bind(this);\n\t\tthis.onTokenSuccess = this.onTokenSuccess.bind(this);\n\t\tthis.onTokenError = this.onTokenError.bind(this);\n\n\t\tthis.onSetInputValue = this.onSetInputValue.bind(this);\n\t\tthis.setInitValue = this.setInitValue.bind(this);\n\n\t\tlet {\n\t\t\tdefaultValue\n\t\t} = this.props;\n\n\t\tthis.state = {\n\t\t\tisInit: true,\n\t\t\tform: {},\n\t\t\tfiles: defaultValue,\n\t\t\tisUploading: false,\n\t\t\tprogress: 10\n\t\t}\n\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.setState({\n\t\t\tfiles: []\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\t\tlet {\n\t\t\tdefaultValue\n\t\t} = this.props;\n\t}\n\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.setInitValue(nextProps.defaultValue);\n\t}\n\n\tsetInitValue(defaultValue) {\n\t\tlet {\n\t\t\tfiles,\n\t\t\tisInit\n\t\t} = this.state;\n\t\tif (!isInit) {\n\t\t\treturn;\n\t\t}\n\t\tif (!defaultValue.length) {\n\t\t\treturn;\n\t\t}\n\t\tfiles = defaultValue;\n\t\tthis.setState({\n\t\t\tfiles,\n\t\t\tisInit: false\n\t\t});\n\n\t\tvar _this = this;\n\t\twindow.setTimeout(function() {\n\t\t\t_this.onSetInputValue();\n\t\t}, 0);\n\t}\n\n\tonSetInputValue() {\n\t\tlet {\n\t\t\tfiles\n\t\t} = this.state;\n\t\tlet {\n\t\t\tinput\n\t\t} = this.props;\n\n\t\tlet fileIds = [];\n\t\tfiles.forEach(function(item, index) {\n\t\t\tfileIds.push(item.id);\n\t\t});\n\t\tinput.onChange(fileIds.toString());\n\t}\n\n\tonFileDelete(index) {\n\t\tlet {\n\t\t\tfiles\n\t\t} = this.state;\n\t\tlet {\n\t\t\tinput\n\t\t} = this.props;\n\n\t\tfiles.splice(index, 1);\n\n\t\tthis.setState({\n\t\t\tfiles\n\t\t});\n\n\t\tthis.onSetInputValue();\n\n\t}\n\n\tonError(message) {\n\t\tmessage = message || '上传文件失败';\n\t\tNotify.show([{\n\t\t\tmessage: message,\n\t\t\ttype: 'danger',\n\t\t}]);\n\n\t\tthis.setState({\n\t\t\tprogress: 0,\n\t\t\tisUploading: false\n\t\t});\n\t}\n\n\tonSuccess(response) {\n\t\tresponse = Object.assign({}, response);\n\n\t\tlet {\n\t\t\tform\n\t\t} = this.state;\n\n\t\tlet fileUrl = `/krspace_oa_web/doc/docFile/downFile?sourceservicetoken=${form.sourceservicetoken}&operater=${form.operater}&fileId=${response.id}`;\n\n\t\tresponse.fileUrl = fileUrl;\n\t\tresponse.fileName = response.filename;\n\n\t\tlet {\n\t\t\tinput,\n\t\t\tonChange\n\t\t} = this.props;\n\t\tlet {\n\t\t\tfiles\n\t\t} = this.state;\n\n\t\tfiles.unshift(response);\n        \n\t\tthis.setState({\n\t\t\tfiles,\n\t\t\tprogress: 0,\n\t\t\tisUploading: false\n\t\t});\n\n\t\tthis.onSetInputValue();\n\n\t\tNotify.show([{\n\t\t\tmessage: '上传文件成功',\n\t\t\ttype: 'success',\n\t\t}]);\n\t\tonChange && onChange(files);\n\t}\n\n\tonTokenSuccess(form) {\n\t\tthis.setState({\n\t\t\tform\n\t\t});\n\t}\n\n\tonTokenError() {\n\t\tNotify.show([{\n\t\t\tmessage: '初始化上传文件失败',\n\t\t\ttype: 'danger',\n\t\t}]);\n\t}\n\n\tonChange(event) {\n\n\t\tvar _this = this;\n\n\n\t\tlet file = event.target.files[0];\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState({\n\t\t\tisUploading: true\n\t\t});\n\n\n\t\tif (file) {\n\t\t\tvar progress = 10;\n\t\t\tvar timer = window.setInterval(function() {\n\t\t\t\tif (progress >= 90) {\n\t\t\t\t\twindow.clearInterval(timer);\n\t\t\t\t\t_this.setState({\n\t\t\t\t\t\tprogress: 10,\n\t\t\t\t\t\tisUploading: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tprogress += 10;\n\t\t\t\t_this.setState({\n\t\t\t\t\tprogress\n\t\t\t\t});\n\t\t\t}, 300);\n\n\n\t\t}\n\n\t\tvar form = new FormData();\n\t\tform.append('file', file);\n\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function() {\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif (xhr.status === 200) {\n\t\t\t\t\tvar response = xhr.response.data;\n\t\t\t\t\tform.append('sourceservicetoken', response.token);\n\t\t\t\t\tform.append('docTypeCode', response.docTypeCode);\n\t\t\t\t\tform.append('operater', response.operater);\n\n\t\t\t\t\t_this.onTokenSuccess({\n\t\t\t\t\t\tsourceservicetoken: response.token,\n\t\t\t\t\t\tdocTypeCode: response.docTypeCode,\n\t\t\t\t\t\toperater: response.operater\n\t\t\t\t\t});\n\n\t\t\t\t\tvar xhrfile = new XMLHttpRequest();\n\t\t\t\t\txhrfile.onreadystatechange = function() {\n\t\t\t\t\t\tif (xhrfile.readyState === 4) {\n\t\t\t\t\t\t\tvar fileResponse = xhrfile.response;\n\t\t\t\t\t\t\tif (xhrfile.status === 200) {\n\t\t\t\t\t\t\t\tif (fileResponse && fileResponse.code > 0) {\n\t\t\t\t\t\t\t\t\t_this.onSuccess(fileResponse.data);\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_this.onError(fileResponse.msg);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (xhrfile.status == 413) {\n\n\t\t\t\t\t\t\t\t_this.onError('您上传的文件过大！');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_this.onError('后台报错请联系管理员！');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\txhrfile.onerror = function(e) {\n\t\t\t\t\t\tconsole.error(xhr.statusText);\n\t\t\t\t\t};\n\n\t\t\t\t\txhrfile.open('POST', '/api-old/krspace_oa_web/doc/docFile/uploadSingleFile', true);\n\t\t\t\t\txhrfile.responseType = 'json';\n\t\t\t\t\txhrfile.send(form);\n\t\t\t\t} else {\n\t\t\t\t\t_this.onTokenError();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.onerror = function(e) {\n\t\t\tconsole.error(xhr.statusText);\n\t\t};\n\t\txhr.open('GET', '/api/krspace-finance-web/finacontractdetail/getSourceServiceToken', true);\n\t\txhr.responseType = 'json';\n\t\txhr.send(null);\n\t}\n\trender() {\n\n\t\tlet {\n\t\t\tinput,\n\t\t\tlabel,\n\t\t\ttype,\n\t\t\tmeta: {\n\t\t\t\ttouched,\n\t\t\t\terror\n\t\t\t},\n\t\t\tstyle,\n\t\t\trequireLabel,\n\t\t\tmultiple,\n\t\t\taccept,\n\t\t\tinline\n\t\t} = this.props;\n\t\tlet {\n\t\t\tfiles,\n\t\t\tprogress,\n\t\t\tisUploading\n\t\t} = this.state;\n\n\t\tlet fileBgStyles = {};\n\t\t// let showList = (files.length>=6)?'hidden':'visible';\n\t\tlet showList = (files.length>=6)?'none':'block';\n\n\t\treturn (\n\t\t\t<WrapComponent label={label} wrapStyle={style} requireLabel={requireLabel} inline={inline}>\n\t\t\t\t<div className=\"ui-file\" style={{visibility:'visible',display:showList}}>\n\t\t\t\t\t<div className=\"file-button\">\n\t\t\t\t\t\t<span className=\"file-icon\">+</span>\n\t\t\t\t\t\t<input type=\"file\" name=\"file\" onChange={this.onChange}  multiple={multiple?'multiple':null} accept={accept} />\n\t\t\t\t\t\t添加文件\n\t\t\t\t\t\t{isUploading && <span className=\"progress\" style={{width:progress}}>{progress}%</span>}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ul className=\"file-list\">\n\t\t\t\t\t{files && files.map((item,index)=>{\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li key={index}>\n\t\t\t\t\t\t\t\t<a href={item.fileUrl} target=\"_blank\">{item.fileName}</a>\n\t\t\t\t\t\t\t\t<span className=\"del\" onTouchTap={this.onFileDelete.bind(this,index)}>删除</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</ul>\n\t\t\t\t\t{touched && error && <div className=\"error-wrap\"> <span>{error}</span> </div>}\n\t\t\t\t</WrapComponent>\n\t\t);\n\n\n\t}\n}\n\n\n// <input type=\"file\" onChange={this.onChange} name={input.name}/>"]}