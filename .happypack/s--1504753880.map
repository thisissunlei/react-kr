{"version":3,"sources":["src/Containers/Operation/CustomerManage/Agreement/Exit/Edit/index.js"],"names":["EditCreate","props","context","onCreateSubmit","bind","onCancel","state","stationVos","initialValues","optionValues","formValues","openConfirmCreate","dispatch","params","callAPI","then","response","show","message","type","location","href","customerId","orderId","contractId","catch","err","window","history","back","_this","mainBillId","mainbillid","leaseBegindate","Date","leaseEnddate","communityAddress","customer","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","customerName","communityName","communityId","communityid","mainbillCommunityId","contractFileList","lessorContactName","contractstate","leaseId","contractcode","leaseContact","lessorContacttel","leaseContacttel","contractVersionType","contractVersion","paytype","paymodel","stationnum","wherefloor","rentaluse","contractmark","totalrent","totaldeposit","lessorContactid","depositamount","totalreturn","signdate","withdrawdate","setState","console","log"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n  Component,\n  PropTypes\n} from 'react';\nimport {\n  reduxForm,\n  submitForm,\n  change,\n  reset\n} from 'redux-form';\nimport {\n  Actions,\n  Store\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n  Dialog,\n  Section,\n  Grid,\n  Notify,\n  BreadCrumbs,\n  Title,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\n\n\nexport default class EditCreate extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.onCreateSubmit = this.onCreateSubmit.bind(this);\n    this.onCancel = this.onCancel.bind(this);\n\n    this.state = {\n      stationVos: [],\n      initialValues: {},\n      optionValues: {},\n      formValues: {},\n      openConfirmCreate: false\n    }\n\n    Store.dispatch(reset('exitEditForm'));\n  }\n\n  onCreateSubmit(formValues) {\n    const {params} = this.props;\n    Store.dispatch(Actions.callAPI('addFnaContractWithdrawal', {}, formValues)).then(function(response) {\n      Notify.show([{\n        message: '编辑成功',\n        type: 'success',\n      }]);\n      location.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/exit/\" + response.contractId + \"/detail\";\n\n    }).catch(function(err) {\n      Notify.show([{\n        message: err.message,\n        type: 'danger',\n      }]);\n    });\n  }\n\n  onCancel() {\n    window.history.back();\n  }\n\n  componentDidMount() {\n\n    var _this = this;\n    const {\n      params\n    } = this.props;\n    let initialValues = {};\n    let optionValues = {};\n    let stationVos = [];\n\n    Store.dispatch(Actions.callAPI('fina-contract-intention', {\n      customerId: params.customerId,\n      mainBillId: params.orderId,\n    })).then(function(response) {\n\n      //initialValues.ContractStateType = 'EXECUTE';\n\n      initialValues.mainbillid = params.orderId;\n\n      initialValues.leaseBegindate = new Date;\n      initialValues.leaseEnddate = new Date;\n\n\n      optionValues.communityAddress = response.customer.communityAddress;\n      optionValues.leaseAddress = response.customer.customerAddress;\n      //合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n      initialValues.contracttype = 'QUITRENT';\n\n      optionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.corporationName;\n        return item;\n      });\n      optionValues.paymentList = response.payment.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.dicName;\n        return item;\n      });\n      optionValues.payTypeList = response.payType.map(function(item, index) {\n        item.value = item.id;\n        item.label = item.dicName;\n        return item;\n      });\n\n      optionValues.floorList = response.customer.floor;\n      optionValues.customerName = response.customer.customerName;\n      optionValues.leaseAddress = response.customer.customerAddress;\n      optionValues.communityName = response.customer.communityName;\n      optionValues.communityId = response.customer.communityid;\n      optionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n      Store.dispatch(Actions.callAPI('getFnaContractWithdrawalById', {\n        id: params.id\n      })).then(function(response) {\n\n        optionValues.contractFileList = response.contractFileList;\n        optionValues.lessorContactName = response.lessorContactName;\n\n        initialValues.id = response.id;\n        initialValues.contractstate = response.contractstate;\n        initialValues.leaseId = response.leaseId;\n        initialValues.contractcode = response.contractcode;\n        initialValues.leaseAddress = response.leaseAddress;\n        initialValues.lessorContactName = response.lessorContactName;\n        initialValues.leaseContact = response.leaseContact;\n        initialValues.lessorContacttel = response.lessorContacttel;\n        initialValues.leaseContacttel = response.leaseContacttel;\n        initialValues.contractVersionType = response.contractVersion;\n        if (response.payType) {\n          initialValues.paytype = response.payType.id;\n\n        }\n        if (response.payment) {\n          initialValues.paymodel = response.payment.id;\n\n        }\n        initialValues.stationnum = response.stationnum;\n        initialValues.wherefloor = response.wherefloor;\n        initialValues.rentaluse = response.rentaluse;\n        initialValues.contractmark = response.contractmark;\n        initialValues.totalrent = response.totalrent;\n        initialValues.totaldeposit = response.totaldeposit;\n        initialValues.lessorContactid = response.lessorContactid;\n        initialValues.depositamount = response.depositamount;\n        initialValues.totalreturn = response.totalreturn;\n        //时间\n\n        initialValues.signdate = new Date(response.signdate);\n        initialValues.leaseBegindate = new Date(response.leaseBegindate);\n        initialValues.leaseEnddate = new Date(response.leaseEnddate);\n        initialValues.withdrawdate = response.withdrawdate;\n\n\n        //处理stationvos\n        stationVos = response.stationVos;\n\n\n        _this.setState({\n          initialValues,\n          optionValues,\n          stationVos\n        });\n\n      }).catch(function(err) {\n        Notify.show([{\n          message: '后台出错请联系管理员',\n          type: 'danger',\n        }]);\n      });\n\n\n    }).catch(function(err) {\n      Notify.show([{\n        message: '后台出错请联系管理员',\n        type: 'danger',\n      }]);\n    });\n\n  }\n\n\n  render() {\n\n    let {\n      initialValues,\n      optionValues,\n      stationVos\n    } = this.state;\n    console.log('stationVos', stationVos)\n    return (\n\n      <div>\n      <Title value=\"编辑退租协议书_财务管理\"/>\n      <BreadCrumbs children={['系统运营','客户管理','退租协议']}/>\n      <Section title=\"退租协议书\" description=\"\">\n          <NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos}/>\n      </Section>\n    </div>\n    );\n  }\n}\n"]}