'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _simpleAssign = require('simple-assign');

var _simpleAssign2 = _interopRequireDefault(_simpleAssign);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactRedux = require('react-redux');

var _redux = require('redux');

var _Actions = require('kr-ui/../Redux/Actions');

var actionCreators = _interopRequireWildcard(_Actions);

var _reactAddonsPureRenderMixin = require('react-addons-pure-render-mixin');

var _reactAddonsPureRenderMixin2 = _interopRequireDefault(_reactAddonsPureRenderMixin);

var _Redux = require('kr/Redux');

var _krUi = require('kr-ui');

require('./index.less');

var _SearchUpperForm = require('./SearchUpperForm');

var _SearchUpperForm2 = _interopRequireDefault(_SearchUpperForm);

var _SearchForm = require('./SearchForm');

var _SearchForm2 = _interopRequireDefault(_SearchForm);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
//高级查询

//搜索


var AttributeSetting = function (_Component) {
	_inherits(AttributeSetting, _Component);

	function AttributeSetting(props, context) {
		_classCallCheck(this, AttributeSetting);

		var _this = _possibleConstructorReturn(this, (AttributeSetting.__proto__ || Object.getPrototypeOf(AttributeSetting)).call(this, props, context));

		_this.onExport = function (values) {
			var searchParams = _this.state.searchParams;
			var idList = [];
			if (values.length != 0) {
				values.map(function (item, value) {
					idList.push(item.id);
				});
			}
			var url = '/api/krspace-finance-web/finaccount/data/exportExcel?searchParams=' + searchParams + '&idList=' + idList;
			window.location.href = url;
		};

		_this.onOperation = function (type, itemDetail) {

			_this.setState({
				itemDetail: itemDetail
			});

			if (type == 'view') {
				var orderId = itemDetail.id;
				window.open('./#/finance/Manage/orderbill/' + orderId + '/detail', orderId);
			}
		};

		_this.onSearchSubmit = function (searchParams) {
			var obj = {
				mainbillname: searchParams.content,
				pageSize: 15
			};
			_this.setState({
				searchParams: obj
			});
		};

		_this.openSearchUpperDialog = function () {
			_this.setState({
				openSearch: !_this.state.openSearch,
				searchParams: {
					pageSize: '15'
				}
			});
		};

		_this.onSearchUpperSubmit = function (searchParams) {
			searchParams = (0, _simpleAssign2.default)({}, _this.state.searchParams, searchParams);
			_this.setState({
				searchParams: searchParams,
				openSearch: !_this.state.openSearch
			});
		};

		_this.onLoaded = function (response) {
			var list = response;
			_this.setState({
				list: list
			});
		};

		_this.state = {
			openSearch: false,
			itemDetail: {},
			list: {},
			searchParams: {
				page: 1,
				pageSize: 15
			}

		};
		return _this;
	}

	//导出


	//操作相关(查看)


	//搜索


	//高级查询


	//高级搜索提交


	//加载完将所有的table数据都获取过来了


	_createClass(AttributeSetting, [{
		key: 'render',
		value: function render() {
			var list = this.state.list;


			if (!list.totalCount) {
				list.sumcome = 0;
			}
			if (!list.totalCount) {
				list.sumAmount = 0;
			}

			return _react2.default.createElement(
				'div',
				{ className: 'm-order-list' },
				_react2.default.createElement(_krUi.Title, { value: '\u8BA2\u5355\u8D26\u5355\u5217\u8868_\u8D22\u52A1\u7BA1\u7406' }),
				_react2.default.createElement(
					_krUi.Section,
					{ title: '\u8BA2\u5355\u8D26\u5355\u5217\u8868', description: '', style: { marginBottom: -5, minHeight: 910 } },
					_react2.default.createElement(
						'div',
						{ className: 'ui-orderList' },
						_react2.default.createElement(
							_krUi.Grid,
							{ style: { marginTop: -5 } },
							_react2.default.createElement(
								_krUi.Row,
								null,
								_react2.default.createElement(
									_krUi.Col,
									{ md: 7, align: 'left' },
									_react2.default.createElement(
										_krUi.ListGroup,
										null,
										_react2.default.createElement(
											'div',
											{ className: 'list-name' },
											_react2.default.createElement('span', { className: 'ui-incomeMoney' }),
											_react2.default.createElement(
												'span',
												{ className: 'font-width' },
												'\u6536\u5165\u603B\u989D:'
											),
											_react2.default.createElement(
												'span',
												{ className: 'font-width font-num' },
												list.sumcome
											)
										),
										_react2.default.createElement(
											'div',
											{ className: 'list-name' },
											_react2.default.createElement('span', { className: 'ui-receiveMoney' }),
											_react2.default.createElement(
												'span',
												{ className: 'font-width' },
												'\u56DE\u6B3E\u603B\u989D:'
											),
											_react2.default.createElement(
												'span',
												{ className: 'font-width font-num' },
												list.sumAmount
											)
										),
										_react2.default.createElement(
											'div',
											{ className: 'list-name' },
											_react2.default.createElement('span', { className: 'ui-selfMoney' }),
											_react2.default.createElement(
												'span',
												{ className: 'font-width' },
												'\u4F59\u989D:'
											),
											_react2.default.createElement(
												'span',
												{ className: 'font-width font-num' },
												list.summount
											)
										)
									)
								),
								_react2.default.createElement(
									_krUi.Col,
									{ md: 5, align: 'right', style: { marginTop: 7 } },
									_react2.default.createElement(
										_krUi.ListGroup,
										null,
										_react2.default.createElement(
											_krUi.ListGroupItem,
											null,
											' ',
											_react2.default.createElement(_SearchForm2.default, { onSubmit: this.onSearchSubmit, onCancel: this.onSearchCancel })
										),
										_react2.default.createElement(
											_krUi.ListGroupItem,
											null,
											' ',
											_react2.default.createElement(_krUi.Button, { searchClick: this.openSearchUpperDialog, type: 'search', searchStyle: { marginLeft: '20', marginTop: '5' } })
										)
									)
								)
							)
						)
					),
					_react2.default.createElement(
						_krUi.Table,
						{ style: { marginTop: 10 },
							displayCheckbox: true,
							onLoaded: this.onLoaded,
							ajax: true,
							ajaxFieldListName: 'finaContractMainbillVOList',
							ajaxUrlName: 'getFinaDataByList',
							ajaxParams: this.state.searchParams,
							onOperation: this.onOperation,
							exportSwitch: true,
							onExport: this.onExport
						},
						_react2.default.createElement(
							_krUi.TableHeader,
							null,
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u8BA2\u5355\u540D\u79F0'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u8BA2\u5355\u7C7B\u578B'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u6240\u5728\u793E\u533A'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u5DE5\u4F4D'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u8D77\u59CB\u65E5\u671F'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u7ED3\u675F\u65E5\u671F'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u6536\u5165\u603B\u989D'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u56DE\u6B3E\u603B\u989D'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u4F59\u989D'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u5B9A\u91D1/\u62BC\u91D1'
							),
							_react2.default.createElement(
								_krUi.TableHeaderColumn,
								null,
								'\u64CD\u4F5C'
							)
						),
						_react2.default.createElement(
							_krUi.TableBody,
							null,
							_react2.default.createElement(
								_krUi.TableRow,
								{ displayCheckbox: true },
								_react2.default.createElement(_krUi.TableRowColumn, { style: { width: 160, overflow: "visible" }, name: 'mainbillname', component: function component(value, oldValue) {
										var TooltipStyle = "";
										if (value.length == "") {
											TooltipStyle = "none";
										} else {
											TooltipStyle = "block";
										}
										return _react2.default.createElement(
											'div',
											{ style: { display: TooltipStyle, paddingTop: 5 }, className: 'financeDetail-hover' },
											_react2.default.createElement(
												'span',
												{ className: 'tableOver', style: { maxWidth: 160, display: "inline-block" } },
												value
											),
											_react2.default.createElement(
												_krUi.Tooltip,
												{ offsetTop: 5, place: 'top' },
												value
											)
										);
									} }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'mainBillTypeName', options: [{ label: '工位入驻订单', value: 'STATION' }] }),
								_react2.default.createElement(_krUi.TableRowColumn, { style: { width: 160, overflow: "visible" }, name: 'community', component: function component(value, oldValue) {
										var TooltipStyle = "";
										if (value.length == "") {
											TooltipStyle = "none";
										} else {
											TooltipStyle = "block";
										}
										return _react2.default.createElement(
											'div',
											{ style: { display: TooltipStyle, paddingTop: 5 }, className: 'financeDetail-hover' },
											_react2.default.createElement(
												'span',
												{ className: 'tableOver', style: { maxWidth: 160, display: "inline-block" } },
												value
											),
											_react2.default.createElement(
												_krUi.Tooltip,
												{ offsetTop: 5, place: 'top' },
												value
											)
										);
									} }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'stationnum' }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'contractEntrydate', type: 'date', format: 'yyyy-mm-dd' }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'contractLeavedate', type: 'date', format: 'yyyy-mm-dd' }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'come' }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'backMount' }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'mount' }),
								_react2.default.createElement(_krUi.TableRowColumn, { name: 'rentOrDeposit' }),
								_react2.default.createElement(
									_krUi.TableRowColumn,
									null,
									_react2.default.createElement(_krUi.Button, { label: '\u67E5\u770B', type: 'operation', operation: 'view' })
								)
							)
						),
						_react2.default.createElement(_krUi.TableFooter, null)
					)
				),
				_react2.default.createElement(
					_krUi.Dialog,
					{
						title: '\u9AD8\u7EA7\u67E5\u8BE2',
						modal: true,
						open: this.state.openSearch,
						onClose: this.openSearchUpperDialog,
						bodyStyle: { paddingTop: 34 },
						contentStyle: { width: 687 }
					},
					_react2.default.createElement(_SearchUpperForm2.default, { onSubmit: this.onSearchUpperSubmit, onCancel: this.openSearchUpperDialog })
				)
			);
		}
	}]);

	return AttributeSetting;
}(_react.Component);

exports.default = AttributeSetting;