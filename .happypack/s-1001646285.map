{"version":3,"sources":["src/Containers/Operation/CustomerManage/Agreement/Join/Edit/index.js"],"names":["JoinCreate","props","context","onCreateSubmit","bind","onCancel","state","stationVos","initialValues","optionValues","formValues","openConfirmCreate","isConfirmSubmiting","dispatch","params","_this","callAPI","then","response","show","message","type","window","setTimeout","location","href","customerId","orderId","contractId","catch","err","mainBillId","communityId","contractstate","mainbillid","communityAddress","customer","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","customerName","communityName","communityid","mainbillCommunityId","lessorContactName","contractFileList","leaseId","contractcode","lessorContactid","lessorContacttel","contractVersionType","contractVersion","leaseContact","leaseContacttel","paytype","paymodel","stationnum","boardroomnum","wherefloor","rentaluse","contractmark","totalrent","totaldeposit","firstpaydate","signdate","leaseBegindate","leaseEnddate","setState","contextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\treduxForm,\n\tsubmitForm,\n\tchange,\n\treset\n} from 'redux-form';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tNotify,\n\tBreadCrumbs,\n\tTitle,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport './index.less';\n\nexport default class JoinCreate extends Component {\n\n\n\tstatic contextTypes = {\n\t\tparams: React.PropTypes.object.isRequired\n\t}\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.onCreateSubmit = this.onCreateSubmit.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\n\t\tthis.state = {\n\t\t\tstationVos: [],\n\t\t\tinitialValues: {},\n\t\t\toptionValues: {},\n\t\t\tformValues: {},\n\t\t\topenConfirmCreate: false\n\t\t}\n\n\t\tthis.isConfirmSubmiting = false;\n\n\t\tStore.dispatch(reset('joinEditForm'));\n\t}\n\n\tonCreateSubmit(formValues) {\n\n\t\tif (this.isConfirmSubmiting) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet {\n\t\t\tparams\n\t\t} = this.props;\n\n\t\tvar _this = this;\n\t\tStore.dispatch(Actions.callAPI('addOrEditEnterContract', {}, formValues)).then(function(response) {\n\n\t\t\t_this.isConfirmSubmiting = false;\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '更新成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\n\t\t\twindow.setTimeout(function() {\n\t\t\t\twindow.location.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/join/\" + response.contractId + \"/detail\";\n\t\t\t}, 0);\n\n\n\t\t}).catch(function(err) {\n\t\t\t_this.isConfirmSubmiting = false;\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\n\n\tonCancel() {\n\t\tlet {\n\t\t\tparams\n\t\t} = this.context;\n\t\twindow.location.href = `./#/operation/customerManage/${params.customerId}/order/${params.orderId}/detail`;\n\t}\n\n\tcomponentDidMount() {\n\n\t\tvar _this = this;\n\t\tconst {\n\t\t\tparams\n\t\t} = this.props;\n\t\tlet initialValues = {};\n\t\tlet optionValues = {};\n\t\tlet stationVos = [];\n\n\t\tStore.dispatch(Actions.callAPI('fina-contract-intention', {\n\t\t\tcustomerId: params.customerId,\n\t\t\tmainBillId: params.orderId,\n\t\t\tcommunityId: 1\n\t\t})).then(function(response) {\n\n\t\t\tinitialValues.contractstate = 'UNSTART';\n\t\t\tinitialValues.mainbillid = params.orderId;\n\n\t\t\toptionValues.communityAddress = response.customer.communityAddress;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\t//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n\t\t\tinitialValues.contracttype = 'ENTER';\n\n\t\t\toptionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.corporationName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.paymentList = response.payment.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.payTypeList = response.payType.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.floorList = response.customer.floor;\n\t\t\toptionValues.customerName = response.customer.customerName;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\toptionValues.communityName = response.customer.communityName;\n\t\t\toptionValues.communityId = response.customer.communityid;\n\t\t\toptionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n\n\t\t\tStore.dispatch(Actions.callAPI('show-checkin-agreement', {\n\t\t\t\tid: params.id\n\t\t\t})).then(function(response) {\n\n\t\t\t\toptionValues.lessorContactName = response.lessorContactName;\n\t\t\t\toptionValues.contractFileList = response.contractFileList;\n\n\t\t\t\tinitialValues.id = response.id;\n\t\t\t\tinitialValues.leaseId = response.leaseId;\n\t\t\t\tinitialValues.contractcode = response.contractcode;\n\t\t\t\tinitialValues.leaseAddress = response.leaseAddress;\n\t\t\t\tinitialValues.lessorContactid = response.lessorContactid;\n\t\t\t\tinitialValues.lessorContactName = response.lessorContactName;\n\t\t\t\tinitialValues.lessorContacttel = response.lessorContacttel;\n\t\t\t\tinitialValues.contractVersionType = response.contractVersion;\n\n\t\t\t\tinitialValues.leaseContact = response.leaseContact;\n\t\t\t\tinitialValues.leaseContacttel = response.leaseContacttel;\n\t\t\t\tinitialValues.paytype = response.payType.id;\n\t\t\t\tinitialValues.paymodel = response.payment.id;\n\n\t\t\t\tinitialValues.stationnum = response.stationnum;\n\t\t\t\tinitialValues.boardroomnum = response.boardroomnum;\n\t\t\t\tinitialValues.wherefloor = response.wherefloor;\n\t\t\t\tinitialValues.rentaluse = response.rentaluse;\n\t\t\t\tinitialValues.contractmark = response.contractmark || '';\n\t\t\t\tinitialValues.totalrent = response.totalrent;\n\t\t\t\tinitialValues.totaldeposit = response.totaldeposit;\n\n\t\t\t\t//时间\n\t\t\t\tinitialValues.firstpaydate = response.firstpaydate;\n\t\t\t\tinitialValues.signdate = response.signdate;\n\t\t\t\tinitialValues.leaseBegindate = response.leaseBegindate;\n\t\t\t\tinitialValues.leaseEnddate = response.leaseEnddate;\n\n\t\t\t\t//处理stationvos\n\t\t\t\tstationVos = response.stationVos;\n\n\t\t\t\t_this.setState({\n\t\t\t\t\tinitialValues,\n\t\t\t\t\toptionValues,\n\t\t\t\t\tstationVos\n\t\t\t\t});\n\n\t\t\t}).catch(function(err) {\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t});\n\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\toptionValues,\n\t\t\tstationVos\n\t\t} = this.state;\n\n\t\treturn (\n\n\t\t\t<div>\n\t\t\t<Title value=\"编辑入驻协议书_财务管理\"/>\n\t\t \t<BreadCrumbs children={['系统运营','客户管理','入驻协议']}/>\n\t\t\t<Section title=\"入驻协议书\" description=\"\">\n\t\t\t\t\t<NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos}/>\n\t\t\t</Section>\n\t\t</div>\n\t\t);\n\t}\n}"]}