{"version":3,"sources":["src/Containers/Operation/CustomerManage/AgreementList/Increase/Edit/index.js"],"names":["JoinCreate","console","log","props","params","context","onCreateSubmit","bind","onCancel","state","stationVos","initialValues","optionValues","formValues","dispatch","callAPI","then","response","show","message","type","ajaxListData","cityName","communityName","createDateBegin","createDateEnd","createrName","customerName","page","pageSize","salerName","openEditAgreement","catch","err","_this","customerId","mainBillId","orderId","communityId","contractstate","mainbillid","leaseContact","customer","customerMember","leaseContacttel","customerPhone","signdate","Date","getTime","communityAddress","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","communityid","mainbillCommunityId","lessorContactName","contractFileList","leaseId","contractcode","contractVersionType","contractVersion","lessorContactid","paytype","paymodel","stationnum","wherefloor","rentaluse","contractmark","totalrent","totaldeposit","lessorContacttel","firstpaydate","leaseBegindate","leaseEnddate","setState","marginTop","childContextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\treduxForm,\n\tsubmitForm,\n\tchange,\n\treset\n} from 'redux-form';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tNotify,\n\tBreadCrumbs,\n\tTitle,\n} from 'kr-ui';\n\nimport './index.less';\nimport NewCreateForm from './NewCreateForm';\nimport allState from \"../../State\";\n\n\nexport default class JoinCreate extends Component {\n\n\tstatic childContextTypes = {\n        params: React.PropTypes.object.isRequired\n     }\n\n\n\n\t\tgetChildContext() {\n\t\t\tconsole.log(this.props.params,)\n\t    return {\n\t        params: this.props.params\n\t      }\n\n\t    }\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.onCreateSubmit = this.onCreateSubmit.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\n\t\tthis.state = {\n\t\t\tstationVos: [],\n\t\t\tinitialValues: {},\n\t\t\toptionValues: {},\n\t\t\tformValues: {},\n\t\t}\n\n\t\tStore.dispatch(reset('increaseCreateForm'));\n\t}\n\n\tonCreateSubmit(formValues) {\n\t\tformValues = Object.assign({}, formValues);\n\t\tlet {\n\t\t\tparams\n\t\t} = this.props;\n\t\tStore.dispatch(Actions.callAPI('addOrEditIncreaseContract', {}, formValues)).then(function(response) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '更新成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\t\t\tallState.ajaxListData({cityName:'',communityName:'',createDateBegin:'',createDateEnd:'',createrName:'',customerName:'',page:'',pageSize:'',salerName:''})\n\t\t\tallState.openEditAgreement=false;\n\t\t\t\n\t\t\t//location.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/increase/\" + response.contractId + \"/detail\";\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\n\tonCancel() {\n\t\tlet {\n\t\t\tparams\n\t\t} = this.context;\n\t\tallState.openEditAgreement=false;\n\t\t//window.location.href = `./#/operation/customerManage/${params.customerId}/order/${params.orderId}/detail`;\n\t}\n\n\tcomponentDidMount() {\n\n\t\tvar _this = this;\n\t\tconst {\n\t\t\tparams\n\t\t} = this.props;\n\t\tlet initialValues = {};\n\t\tlet optionValues = {};\n\t\tlet stationVos = [];\n\n\t\tStore.dispatch(Actions.callAPI('fina-contract-intention', {\n\t\t\tcustomerId: params.customerId,\n\t\t\tmainBillId: params.orderId,\n\t\t\tcommunityId: 1\n\t\t})).then(function(response) {\n\n\t\t\tinitialValues.contractstate = 'UNSTART';\n\t\t\tinitialValues.mainbillid = params.orderId;\n\t\t\tinitialValues.leaseContact = response.customer.customerMember;\n\t\t\tinitialValues.leaseContacttel = response.customer.customerPhone;\n\t\t\tinitialValues.signdate = +new Date((new Date()).getTime() - 24 * 60 * 60 * 1000);\n\n\t\t\toptionValues.communityAddress = response.customer.communityAddress;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\t//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n\t\t\tinitialValues.contracttype = 'ADDRENT';\n\n\t\t\toptionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.corporationName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.paymentList = response.payment.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.payTypeList = response.payType.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.floorList = response.customer.floor;\n\t\t\toptionValues.customerName = response.customer.customerName;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\toptionValues.communityName = response.customer.communityName;\n\t\t\toptionValues.communityId = response.customer.communityid;\n\t\t\toptionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n\n\t\t\tStore.dispatch(Actions.callAPI('show-checkin-agreement', {\n\t\t\t\tid: params.id\n\t\t\t})).then(function(response) {\n\t\t\t\tconsole.log('response',response);\n\n\n\t\t\t\toptionValues.lessorContactName = response.lessorContactName;\n\n\t\t\t\toptionValues.contractFileList = response.contractFileList;\n\n\t\t\t\tinitialValues.id = response.id;\n\t\t\t\tinitialValues.leaseId = response.leaseId;\n\t\t\t\tinitialValues.contractcode = response.contractcode;\n\t\t\t\tinitialValues.contractVersionType = response.contractVersion;\n\n\t\t\t\tinitialValues.lessorContactid = response.lessorContactid;\n\t\t\t\tinitialValues.lessorContactName = response.lessorContactName;\n\n\t\t\t\tinitialValues.leaseId = response.leaseId;\n\t\t\t\tinitialValues.leaseAddress = response.leaseAddress;\n\t\t\t\tinitialValues.leaseContact = response.leaseContact;\n\t\t\t\tinitialValues.leaseContacttel = response.leaseContacttel;\n\t\t\t\tinitialValues.paytype = response.payType.id;\n\t\t\t\tinitialValues.paymodel = response.payment.id;\n\t\t\t\tinitialValues.stationnum = response.stationnum;\n\t\t\t\tinitialValues.wherefloor = response.wherefloor;\n\t\t\t\tinitialValues.rentaluse = response.rentaluse;\n\t\t\t\tinitialValues.contractmark = response.contractmark || '';\n\t\t\t\tinitialValues.totalrent = response.totalrent;\n\t\t\t\tinitialValues.totaldeposit = response.totaldeposit;\n\t\t\t\tinitialValues.lessorContacttel = response.lessorContacttel;\n\n\t\t\t\t//时间\n\t\t\t\tinitialValues.firstpaydate = new Date(response.firstpaydate);\n\t\t\t\tinitialValues.signdate = new Date(response.signdate);\n\t\t\t\tinitialValues.leaseBegindate = new Date(response.leaseBegindate);\n\t\t\t\tinitialValues.leaseEnddate = new Date(response.leaseEnddate);\n\n\t\t\t\tconsole.log('时间', initialValues);\n\n\n\t\t\t\t//处理stationvos\n\t\t\t\tstationVos = response.stationVos;\n\n\t\t\t\t_this.setState({\n\t\t\t\t\tinitialValues,\n\t\t\t\t\toptionValues,\n\t\t\t\t\tstationVos\n\t\t\t\t});\n\n\t\t\t}).catch(function(err) {\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t});\n\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\toptionValues,\n\t\t\tstationVos\n\t\t} = this.state;\n\n\t\treturn (\n\n\t\t\t<div>\n\t\t\t<Title value=\"编辑增租协议书_财务管理\"/>\n\t\t \t<BreadCrumbs children={['系统运营','客户管理','增租协议书']}/>\n\t\t\t<div style={{marginTop:10}}>\n\t\t\t\t\t<NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos}/>\n\t\t\t</div>\n\n\t\t</div>\n\t\t);\n\t}\n}"]}