{"version":3,"sources":["src/Containers/Operation/CustomerManage/Agreement/Admit/Edit/index.js"],"names":["JoinCreate","props","context","openConfirmCreateDialog","bind","onCreateSubmit","onCancel","onConfrimSubmit","state","stationVos","initialValues","optionValues","formValues","openConfirmCreate","dispatch","setState","_this","setTimeout","console","log","params","callAPI","then","response","show","message","type","location","href","customerId","orderId","contractId","catch","err","window","mainBillId","contractstate","mainbillid","signdate","Date","getTime","communityAddress","customer","leaseAddress","customerAddress","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","customerName","communityName","communityId","communityid","mainbillCommunityId","leaseId","contractcode","lessorContactid","templockday","contractFileList","lessorContactName","leaseContact","leaseContacttel","contractVersionType","contractVersion","paytype","paymentId","boardroomnum","stationnum","wherefloor","contractmark","lessorContacttel","totaldownpayment","leaseBegindate","leaseEnddate","contextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\treduxForm,\n\tsubmitForm,\n\tchange,\n\treset\n} from 'redux-form';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tNotify,\n\tBreadCrumbs,\n\tTitle,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport ConfirmFormDetail from './ConfirmFormDetail';\n\n\nexport default class JoinCreate extends Component {\n\n\tstatic contextTypes = {\n\t\tparams: React.PropTypes.object.isRequired\n\t}\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.openConfirmCreateDialog = this.openConfirmCreateDialog.bind(this);\n\t\tthis.onCreateSubmit = this.onCreateSubmit.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\t\tthis.onConfrimSubmit = this.onConfrimSubmit.bind(this);\n\n\t\tthis.state = {\n\t\t\tstationVos: [],\n\t\t\tinitialValues: {},\n\t\t\toptionValues: {},\n\t\t\tformValues: {},\n\t\t\topenConfirmCreate: false\n\t\t}\n\n\t\tStore.dispatch(reset('admitCreateForm'));\n\n\t}\n\n\tonCreateSubmit(formValues) {\n\t\tthis.setState({\n\t\t\tformValues\n\t\t});\n\n\t\tvar _this = this;\n\n\t\tsetTimeout(function() {\n\t\t\t_this.onConfrimSubmit();\n\t\t}, 0);\n\t\t// this.openConfirmCreateDialog();\n\t}\n\n\tonConfrimSubmit() {\n\t\tconsole.log(this.props, this.props.params);\n\n\t\tlet params = this.props.params;\n\t\tlet {\n\t\t\tformValues\n\t\t} = this.state;\n\n\t\tStore.dispatch(Actions.callAPI('updateFinaContractIntentletter', {}, formValues)).then(function(response) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '更新成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\t\t\tlocation.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/admit/\" + response.contractId + \"/detail\";\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t\t//this.openConfirmCreateDialog();\n\t}\n\n\tonCancel() {\n\t\tlet {\n\t\t\tparams\n\t\t} = this.context;\n\t\twindow.location.href = `./#/operation/customerManage/${params.customerId}/order/${params.orderId}/detail`;\n\t}\n\n\topenConfirmCreateDialog() {\n\t\tthis.setState({\n\t\t\topenConfirmCreate: !this.state.openConfirmCreate\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\n\t\tvar _this = this;\n\t\tconst {\n\t\t\tparams\n\t\t} = this.props\n\t\tlet initialValues = {};\n\t\tlet optionValues = {};\n\t\tlet stationVos = [];\n\n\t\tStore.dispatch(Actions.callAPI('fina-contract-intention', {\n\t\t\tcustomerId: params.customerId,\n\t\t\tmainBillId: params.orderId,\n\t\t})).then(function(response) {\n\t\t\tinitialValues.contractstate = 'UNSTART';\n\t\t\tinitialValues.mainbillid = params.orderId;\n\n\t\t\tinitialValues.signdate = +new Date((new Date()).getTime() - 24 * 60 * 60 * 1000);\n\n\t\t\toptionValues.communityAddress = response.customer.communityAddress;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\t//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n\t\t\tinitialValues.contracttype = 'INTENTION';\n\n\t\t\toptionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.corporationName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.paymentList = response.payment.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.payTypeList = response.payType.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.floorList = response.customer.floor;\n\t\t\toptionValues.customerName = response.customer.customerName;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\toptionValues.communityName = response.customer.communityName;\n\t\t\toptionValues.communityId = response.customer.communityid;\n\t\t\toptionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n\t\t\tStore.dispatch(Actions.callAPI('showFinaContractIntentletter', {\n\t\t\t\tid: params.id\n\t\t\t})).then(function(response) {\n\n\t\t\t\tinitialValues.id = response.id;\n\t\t\t\tinitialValues.leaseId = response.leaseId;\n\t\t\t\tinitialValues.contractcode = response.contractcode;\n\t\t\t\tinitialValues.lessorContactid = response.lessorContactid;\n\t\t\t\tinitialValues.templockday = response.templockday;\n\t\t\t\toptionValues.contractFileList = response.contractFileList;\n\t\t\t\t// initialValues.lessorContactid = response.lessorContactid;\n\t\t\t\tinitialValues.leaseAddress = response.leaseAddress;\n\t\t\t\tinitialValues.lessorContactName = response.lessorContactName;\n\t\t\t\tinitialValues.leaseContact = response.leaseContact;\n\t\t\t\tinitialValues.leaseContacttel = response.leaseContacttel;\n\t\t\t\tinitialValues.contractVersionType = response.contractVersion;\n\t\t\t\tinitialValues.signdate = response.signdate;\n\t\t\t\tif (response.payType) {\n\t\t\t\t\tinitialValues.paytype = response.payType.id;\n\n\t\t\t\t}\n\t\t\t\tif (response.payment) {\n\t\t\t\t\toptionValues.payment = response.payment;\n\t\t\t\t\tinitialValues.paymentId = response.payment.id;\n\n\t\t\t\t}\n\t\t\t\tif (response.boardroomnum) {\n\t\t\t\t\tinitialValues.boardroomnum = response.boardroomnum;\n\t\t\t\t}\n\t\t\t\tinitialValues.stationnum = response.stationnum;\n\t\t\t\tinitialValues.wherefloor = response.wherefloor;\n\t\t\t\tinitialValues.contractmark = response.contractmark || '';\n\t\t\t\toptionValues.lessorContactName = response.lessorContactName;\n\t\t\t\tinitialValues.lessorContacttel = response.lessorContacttel;\n\t\t\t\tinitialValues.totaldownpayment = response.totaldownpayment;\n\n\t\t\t\t//时间\n\t\t\t\tinitialValues.leaseBegindate = new Date(response.leaseBegindate);\n\t\t\t\tinitialValues.leaseEnddate = new Date(response.leaseEnddate);\n\t\t\t\tinitialValues.stationVos = response.stationVos;\n\n\t\t\t\t//处理stationvos\n\t\t\t\tstationVos = response.stationVos;\n\n\t\t\t\t_this.setState({\n\t\t\t\t\tinitialValues,\n\t\t\t\t\toptionValues,\n\t\t\t\t\tstationVos\n\t\t\t\t});\n\n\t\t\t}).catch(function(err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\tNotify.show([{\n\t\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\t\ttype: 'danger',\n\t\t\t\t}]);\n\t\t\t});\n\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\toptionValues,\n\t\t\tstationVos\n\t\t} = this.state;\n\n\t\treturn (\n\n\t\t\t<div>\n\t\t\t<Title value=\"编辑承租意向书_财务管理\"/>\n\t\t \t<BreadCrumbs children={['系统运营','客户管理','承租协议']}/>\n\t\t\t<Section title=\"承租意向书\" description=\"\">\n\t\t\t\t\t<NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues} stationVos={stationVos}/>\n\t\t\t</Section>\n\n\t\t\t<Dialog\n\t\t\t\ttitle=\"确定新建\"\n\t\t\t\tmodal={true}\n\t\t\t\tautoScrollBodyContent={true}\n\t\t\t\tautoDetectWindowHeight={true}\n\t\t\t\topen={this.state.openConfirmCreate} >\n\t\t\t\t\t\t<ConfirmFormDetail detail={this.state.formValues} onSubmit={this.onConfrimSubmit} onCancel={this.openConfirmCreateDialog} />\n\t\t\t  </Dialog>\n\t\t</div>\n\t\t);\n\t}\n}\n"]}