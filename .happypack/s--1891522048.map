{"version":3,"sources":["src/Containers/Operation/CustomerManage/Order/Create/index.js"],"names":["OrderCreate","props","context","onSubmit","values","isOk","customerid","params","customerId","_this","dispatch","callAPI","then","response","show","message","type","window","setTimeout","top","location","reload","catch","err","onCancel","getInitValues","communityOptions","initialValues","orderTypeOptions","communityCity","map","item","value","String","communityId","label","communityName","sysDicPayments","id","dicName","setState","communityid","loading","state","switchSidebarNav","switchHeaderNav","obj","document","body","style","background","nextProps","contextTypes","PropTypes","object","isRequired"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\tconnect,\n\tStore,\n\tActions\n} from 'kr/Redux';\n\nimport {\n\tKrField,\n\tLabelText,\n\tSection,\n\tBreadCrumbs,\n\tGrid,\n\tRow,\n\tCol,\n\tNotify,\n\tLoading,\n\tButton,\n\tDialog,\n\tSnackbar,\n\tListGroup,\n\tListGroupItem\n} from 'kr-ui';\n\nimport OrderEditForm from './OrderEditForm';\n\n\nexport default class OrderCreate extends Component {\n\n\tstatic contextTypes = {\n\t\tparams: React.PropTypes.object.isRequired,\n\n\t}\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\n\t\tthis.isOk = false;\n\n\n\t\tthis.state = {\n\t\t\tloading: true,\n\t\t\tcommunityOptions: [],\n\t\t\tinitialValues: {},\n\t\t\torderTypeOptions: [{\n\t\t\t\tvalue: '',\n\t\t\t\tlabel: '请选择类型'\n\t\t\t}, {\n\t\t\t\tvalue: 'STATION',\n\t\t\t\tlabel: '工位服务订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'INCUBAZION',\n\t\t\t\tlabel: '孵化订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'REGISTER',\n\t\t\t\tlabel: '注册订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'INCUSTOM',\n\t\t\t\tlabel: '场内消费订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'ACTIVITY',\n\t\t\t\tlabel: '广告订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'ADDEDSERVICE',\n\t\t\t\tlabel: '增值服务订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'TRAINING',\n\t\t\t\tlabel: '培训订单'\n\t\t\t}, {\n\t\t\t\tvalue: 'OTHER',\n\t\t\t\tlabel: '其他服务订单'\n\t\t\t}]\n\n\t\t}\n\t\tStore.dispatch(Actions.switchSidebarNav(false));\n\t\tStore.dispatch(Actions.switchHeaderNav(false));\n\n\t}\n\n\tcomponentDidMount() {\n\t\tvar obj = document.body;\n\t\tobj.style.background = '#fff';\n\t\tthis.getInitValues();\n\n\n\t}\n\tonSubmit = (values) => {\n\n\t\tif (this.isOk) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.isOk = true;\n\t\tvalues.customerid = this.context.params.customerId;\n\n\t\tvar _this = this;\n\n\t\tStore.dispatch(Actions.callAPI('enter-order', {}, values)).then(function(response) {\n\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '保存成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\n\t\t\twindow.setTimeout(function() {\n\t\t\t\twindow.top.location.reload();\n\t\t\t\t_this.isOk = false;\n\t\t\t}, 100);\n\n\t\t}).catch(function(err) {\n\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '创建失败',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\n\t\t\twindow.setTimeout(function() {\n\t\t\t\t_this.isOk = false;\n\t\t\t}, 0);\n\n\t\t});\n\n\t}\n\tonCancel = () => {\n\t\twindow.top.location.reload();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {}\n\tgetInitValues = () => {\n\t\tvar _this = this;\n\t\tlet communityOptions = [];\n\t\tlet initialValues = {};\n\n\t\tlet orderTypeOptions = [];\n\t\tStore.dispatch(Actions.callAPI('community-city-selected')).then(function(response) {\n\t\t\tcommunityOptions = response.communityCity.map((item) => {\n\t\t\t\titem.value = String(item.communityId);\n\t\t\t\titem.label = item.communityName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\torderTypeOptions = response.sysDicPayments.map((item) => {\n\t\t\t\titem.value = String(item.id);\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\t_this.setState({\n\t\t\t\tcommunityOptions: communityOptions,\n\t\t\t\torderTypeOptions: orderTypeOptions\n\t\t\t})\n\t\t}).catch(function(err) {});\n\n\n\t\tStore.dispatch(Actions.callAPI('get-customName-orderName', {\n\t\t\tcustomerId: this.props.params.customerId\n\t\t}, {})).then(function(response) {\n\n\t\t\tlet initialValues = {};\n\t\t\tinitialValues = response;\n\t\t\tinitialValues.communityid = String(initialValues.communityid);\n\t\t\t_this.setState({\n\t\t\t\tinitialValues,\n\t\t\t\tloading: false\n\t\t\t})\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\n\n\trender() {\n\n\n\t\tif (this.state.loading) {\n\t\t\treturn (<Loading/>);\n\t\t}\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\tcommunityOptions,\n\t\t\torderTypeOptions\n\t\t} = this.state;\n\n\n\n\t\treturn (\n            \n           <div> \n\t\t\t<OrderEditForm onSubmit={this.onSubmit} communityOptions={communityOptions} initialValues={initialValues} orderTypeOptions={orderTypeOptions} onCancel={this.onCancel}/>\n\n           </div>\n\n\t\t);\n\t}\n}\n\n\n// const selector = formValueSelector('orderEditForm');\n\n// function mapStateToProps(state){\n\n// \tlet communitys = state.common['community-city-selected'];\n\n// \tif(Object.prototype.toString.call(communitys) !== '[object Array]'){\n// \t\tcommunitys = [];\n// \t}\n\n// \tconst communityid = selector(state, 'communityid');\n\n// \tlet cityName = '';\n// \tcommunitys.map(function(item){\n// \t\tif(item.communityId == communityid){\n// \t\t\tcityName = item.cityName;\n// \t\t}\n// \t});\n\n// \treturn {\n// \t\tcityName,\n// \t\tinitialValues:state.common['get-simple-order'],\n// \t\tcommunitys,\n//    \t};\n// }\n\n\n\n// export default connect(mapStateToProps)(OrderCreate);\n\n// }\n\n"]}