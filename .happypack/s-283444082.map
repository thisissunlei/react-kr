{"version":3,"sources":["src/Components/UpLoadList/index.js"],"names":["UpLoadList","props","renderHover","detail","node","findDOMNode","tooltip","parent","parentNode","getFileList","id","open","style","visibility","position","setState","width","offsetWidth","height","offsetHeight","docClick","event","window","target","innerHTML","className","indexOf","document","removeEventListener","_this","dispatch","callAPI","detailId","then","response","files","catch","err","console","log","message","saveFileList","fileId","show","type","onChange","file","isUploading","fileName","name","progress","timer","setInterval","clearInterval","form","FormData","append","xhr","XMLHttpRequest","onreadystatechange","readyState","status","data","token","docTypeCode","operater","onTokenSuccess","sourceservicetoken","xhrfile","fileResponse","code","onSuccess","onError","msg","onerror","e","error","statusText","responseType","send","onTokenError","renderLoad","state","length","isInit","offsetTop","close","nextProps","fileUrl","filename","input","push","fileIds","forEach","item","index","toString","location","href","showUl","div","map","bottom","marginBottom","download","bind","delete","top","lineHeight","defaultProps","backgroundColor","ShadowColor","PropTypes","string","children","place","boxShadow","array"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import React, {\n\tComponent\n} from 'react';\n\nimport $ from 'jquery';\nimport {\n\tFontIcon,\n} from 'kr-ui';\nimport Notify from '../Notify';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport ReactDOM from 'react-dom';\nimport './index.less';\nimport {ShallowEqual} from 'kr/Utils';\nexport default class UpLoadList extends Component {\n\n\tstatic defaultProps = {\n\t\tbackgroundColor:\"#fff\",\n\t\tShadowColor:'transparent'\n\t}\n\n\tstatic PropTypes = {\n\t\tclassName: React.PropTypes.string,\n\t\tchildren: React.PropTypes.node,\n\t\t/**\n\t\t * place有四个参数值top,bottom,left,right\n\t\t */\n\t\tplace:React.PropTypes.string,\n\t\tbackgroundColor:React.PropTypes.string,\n\t\t/**\n\t\t * tooltip内容的阴影，box-shadow的参数\n\t\t */\n\t\tboxShadow:React.PropTypes.string,\n\t\t/**\n\t\t * 与box-shadow的阴影色相同\n\t\t */\n\t\topen:React.PropTypes.array\n\n\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state={\n\t\t\twidth:0,\n\t\t\theight:0,\n\t\t\topen:this.props.open,\n\t\t\tprogress:0,\n\t\t\tisUploading: false,\n\t\t\tisInit: true,\n\t\t\tform: {},\n\t\t\tfiles:[],\n\t\t\toffsetTop:this.props.offsetTop,\n\t\t\tfileName:'',\n\t\t\tclose:false\n\t\t}\n\n\t}\n\tcomponentDidMount() {\n\t\tthis.renderHover();\n\t}\n\tcomponentWillReceiveProps(nextProps){\n\t\tif(!ShallowEqual(this.state.open,nextProps.open)){\n\t\t\tthis.setState({\n\t\t\t\topen:nextProps.open,\n\t\t\t\tclose:!this.state.close\n\t\t\t},function(){\n\t\t\t\tthis.renderHover();\n\t\t\t\t// document.addEventListener('click', this.docClick)\n\t\t\t\t\n\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t}\n\t}\n\tcomponentWillUnmount(){\n\t\tconsole.log('componentWillUnmount');\n\t\tlet node = ReactDOM.findDOMNode(this.tooltip);\n\t\tnode.style.visibility = 'hidden';\n\t}\n\trenderHover=()=>{\n\t\tlet {detail} = this.props;\n\t\tlet node = ReactDOM.findDOMNode(this.tooltip);\n\t\tlet parent = node.parentNode;\n\t\tthis.getFileList(detail.id);\n\t\tlet {open} = this.props;\n\t\tif(open[1] == detail.id && open[0]){\n\t\t\tnode.style.visibility = 'visible';\n\t\t}else{\n\t\t\tnode.style.visibility = 'hidden';\n\t\t\t// document.removeEventListener('click', this.docClick)\n\n\t\t}\n\n\t\tparent.style.position = \"relative\";\n\t\tthis.setState({\n\t\t\twidth:node.offsetWidth,\n\t\t\theight:node.offsetHeight\n\t\t})\n\t}\n\tdocClick = (event) => {\n\t\tevent = event || window.event;\n\t\tvar target = event.target;\n\t\tif(target.innerHTML == '附件'){\n\t\t\treturn;\n\t\t}\n\t\tif (target && target.className && (target.className.indexOf('upload') !== -1 || target.className.indexOf('file') !== -1)) {\n\t\t\treturn;\n\t\t}\n\t\tlet node = ReactDOM.findDOMNode(this.tooltip);\n\t\tnode.style.visibility = 'hidden';\n\t\tdocument.removeEventListener('click', this.docClick)\n\n\t\t// document.addEventListener('click', this.docClick);\n\n\t}\n\tgetFileList=(id)=>{\n\t\tlet _this = this;\n\t\tlet {open} = this.props;\n\t\tif(open[1] != id){\n\t\t\treturn ;\n\t\t}\n\t\tStore.dispatch(Actions.callAPI('getFileList', {\n\t\t\tdetailId: id\n\t\t})).then(function(response) {\n\t\t\t_this.setState({\n\t\t\t\tfiles:response\n\t\t\t})\n\n\t\t}).catch(function(err) {\n\t\t\tlet node = ReactDOM.findDOMNode(_this.tooltip);\n\t\t\tnode.style.visibility = 'hidden';\n\t\t\tconsole.log(err.message);\n\n\t\t});\n\t}\n\tsaveFileList=(id)=>{\n\t\tlet _this = this;\n\t\tStore.dispatch(Actions.callAPI('saveFileList', {\n\t\t\tdetailId: _this.props.detail.id,\n\t\t\tfileId:id\n\t\t})).then(function(response) {\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t\t\n\t\t\t// let node = ReactDOM.findDOMNode(_this.tooltip);\n\t\t\t// node.style.visibility = 'hidden';\n\t\t\t// console.log(err.message);\n\t\t});\n\t}\n\n\tdelete(id){\n\t\tlet _this = this;\n\t\tStore.dispatch(Actions.callAPI('deleteFileList', {\n\t\t\tdetailId: _this.props.detail.id,\n\t\t\tfileId:id.id\n\t\t})).then(function(response) {\n\t\t\t_this.getFileList(_this.props.detail.id);\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\tonError(message) {\n\t\tmessage = message || '上传文件失败';\n\n\t\tthis.setState({\n\t\t\tprogress: 0,\n\t\t\tisUploading: false\n\t\t});\n\t\tNotify.show([{\n\t\t\tmessage: message,\n\t\t\ttype: 'danger',\n\t\t}]);\n\t}\n\n\tonSuccess(response) {\n\t\tresponse = Object.assign({}, response);\n\n\t\tlet {\n\t\t\tform\n\t\t} = this.state;\n\n\t\tlet fileUrl = `/krspace_oa_web/doc/docFile/downFile?sourceservicetoken=${form.sourceservicetoken}&operater=${form.operater}&fileId=${response.id}`;\n\n\t\tresponse.fileUrl = fileUrl;\n\t\tresponse.fileName = response.filename;\n\n\t\tlet {\n\t\t\tinput,\n\t\t\tonChange\n\t\t} = this.props;\n\t\tlet {\n\t\t\tfiles\n\t\t} = this.state;\n\n\t\t// files.unshift(response);\n\t\tfiles.push(response);\n\t\tthis.saveFileList(response.id);\n\n\t\tthis.setState({\n\t\t\tfiles,\n\t\t\tprogress: 0,\n\t\t\tisUploading: false\n\t\t});\n\n\t\t// this.onSetInputValue();\n\t\tonChange && onChange(files);\n\t}\n\n\tonSetInputValue() {\n\t\tlet {\n\t\t\tfiles\n\t\t} = this.state;\n\t\tlet {\n\t\t\tinput\n\t\t} = this.props;\n\t\tlet fileIds = [];\n\t\tfiles.forEach(function(item, index) {\n\t\t\tfileIds.push(item.id);\n\t\t});\n\t\tinput.onChange(fileIds.toString());\n\t}\n\n\tonTokenSuccess(form) {\n\t\tthis.setState({\n\t\t\tform\n\t\t});\n\t}\n\n\tonTokenError() {\n\t\tNotify.show([{\n\t\t\tmessage: '初始化上传文件失败',\n\t\t\ttype: 'danger',\n\t\t}]);\n\t}\n\tonChange=(event)=> {\n\n\t\tvar _this = this;\n\n\n\t\tlet file = event.target.files[0];\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState({\n\t\t\tisUploading: true,\n\t\t\tfileName:file.name,\n\t\t});\n\n\n\t\tif (file) {\n\t\t\tvar progress = 0;\n\t\t\tvar timer = window.setInterval(function() {\n\t\t\t\tif (progress >= 90) {\n\t\t\t\t\twindow.clearInterval(timer);\n\t\t\t\t\t_this.setState({\n\t\t\t\t\t\tprogress: 0,\n\t\t\t\t\t\tisUploading: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tprogress += 10;\n\t\t\t\t_this.setState({\n\t\t\t\t\tprogress\n\t\t\t\t});\n\t\t\t}, 100);\n\n\n\t\t}\n\n\t\tvar form = new FormData();\n\t\tform.append('file', file);\n\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onreadystatechange = function() {\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif (xhr.status === 200) {\n\n\t\t\t\t\tvar response = xhr.response.data;\n\t\t\t\t\tform.append('sourceservicetoken', response.token);\n\t\t\t\t\tform.append('docTypeCode', response.docTypeCode);\n\t\t\t\t\tform.append('operater', response.operater);\n\n\t\t\t\t\t_this.onTokenSuccess({\n\t\t\t\t\t\tsourceservicetoken: response.token,\n\t\t\t\t\t\tdocTypeCode: response.docTypeCode,\n\t\t\t\t\t\toperater: response.operater\n\t\t\t\t\t});\n\n\t\t\t\t\tvar xhrfile = new XMLHttpRequest();\n\t\t\t\t\txhrfile.onreadystatechange = function() {\n\t\t\t\t\t\tif (xhrfile.readyState === 4) {\n\t\t\t\t\t\t\tvar fileResponse = xhrfile.response;\n\t\t\t\t\t\t\tif (xhrfile.status === 200) {\n\t\t\t\t\t\t\t\tif (fileResponse && fileResponse.code > 0) {\n\t\t\t\t\t\t\t\t\t_this.onSuccess(fileResponse.data);\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_this.onError(fileResponse.msg);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (xhrfile.status == 413) {\n\n\t\t\t\t\t\t\t\t_this.onError('您上传的文件过大！');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_this.onError('后台报错请联系管理员！');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\txhrfile.onerror = function(e) {\n\t\t\t\t\t\tconsole.error(xhr.statusText);\n\t\t\t\t\t};\n\n\t\t\t\t\txhrfile.open('POST', '/api-old/krspace_oa_web/doc/docFile/uploadSingleFile', true);\n\t\t\t\t\txhrfile.responseType = 'json';\n\t\t\t\t\txhrfile.send(form);\n\t\t\t\t} else {\n\t\t\t\t\t_this.onTokenError();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.onerror = function(e) {\n\t\t\tconsole.error(xhr.statusText);\n\t\t};\n\t\txhr.open('GET', '/api/krspace-finance-web/finacontractdetail/getSourceServiceToken', true);\n\t\txhr.responseType = 'json';\n\t\txhr.send(null);\n\t}\n\trenderLoad=()=>{\n\t\tlet {files} = this.state;\n\t\tlet className = 'ui-files';\n\t\tif(!files.length){\n\t\t\tclassName += ' only-upload';\n\t\t}\n\t\tif(files.length<6){\n\t\t\treturn (\n\t\t\t\t<li className={className}>\n\t\t\t\t\t<div className=\"file-button\">\n\t\t\t\t\t\t<span className=\"file-icon\">+</span>\n\t\t\t\t\t\t<input type=\"file\" name=\"file\" onChange={this.onChange} />\n\t\t\t\t\t\t添加文件\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t)\n\t\t}else{\n\t\t\treturn ;\n\t\t}\n\t}\n\tdownload(item){\n\t\tconsole.log('download',item);\n\t\twindow.location.href = item.fileUrl;\n\t}\n\trender() {\n\t\tlet {isUploading,progress,files,fileName} = this.state;\n\t\tlet className = 'upload-list';\n\t\tlet showUl = files.length?'visible':'hidden';\n\n\t\tlet style = {};\n\n\t\treturn(\n\t\t\t<div className={className} ref={div=>{this.tooltip = div}} style={style}>\n\t\t\t\t<ul className=\"upload-ul\">\n\t\t\t\t{ files.map((item,index)=>{\n\t\t\t\t\tlet bottom = (index==5)?'10px':'0';\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li className=\"upload-li\" key={index} style={{marginBottom:bottom}}>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span className=\"file-name\" onClick={this.download.bind(this,item)}>{item.fileName}</span>\n\t\t\t\t\t\t<span className=\"file-delete icon-delete\" onClick={this.delete.bind(this,item)}></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t\t{isUploading && <li className=\"loading-progress\" style={{position:'relative'}}><span className=\"progress\" style={{width:`${progress}%`,height:'33px',position:'absolute',top:0,lineHeight:'33px'}}>{progress}%</span><span className=\"file-name-load\">{fileName}</span></li>}\n\n\t\t\t\t{this.renderLoad()}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t);\n\t}\n}\n"]}