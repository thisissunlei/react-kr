{"version":3,"sources":["src/Containers/Operation/CustomerManage/Agreement/Renew/Create/index.js"],"names":["JoinCreate","props","context","openConfirmCreateDialog","bind","onCreateSubmit","onCancel","onConfrimSubmit","state","initialValues","optionValues","formValues","openConfirmCreate","dispatch","console","log","setState","params","callAPI","then","response","show","message","type","location","href","customerId","orderId","contractId","catch","err","window","history","back","_this","mainBillId","communityId","contractstate","mainbillid","communityAddress","customer","leaseAddress","customerAddress","leaseContact","customerMember","leaseContacttel","customerPhone","contracttype","fnaCorporationList","fnaCorporation","map","item","index","value","id","label","corporationName","paymentList","payment","dicName","payTypeList","payType","floorList","floor","customerName","communityName","communityid","mainbillCommunityId"],"mappings":";;;;;;;;;AAAA;;;;AAIA;;AAMA;;AAIA;;;;AAEA;;AASA;;;;AACA;;;;AACA;;;;;;;;;;IAEqBA,U;;;AAEpB,qBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA,uHACrBD,KADqB,EACdC,OADc;;AAG3B,SAAKC,uBAAL,GAA+B,OAAKA,uBAAL,CAA6BC,IAA7B,QAA/B;AACA,SAAKC,cAAL,GAAsB,OAAKA,cAAL,CAAoBD,IAApB,QAAtB;AACA,SAAKE,QAAL,GAAgB,OAAKA,QAAL,CAAcF,IAAd,QAAhB;AACA,SAAKG,eAAL,GAAuB,OAAKA,eAAL,CAAqBH,IAArB,QAAvB;;AAEA,SAAKI,KAAL,GAAa;AACZC,kBAAe,EADH;AAEZC,iBAAc,EAFF;AAGZC,eAAY,EAHA;AAIZC,sBAAmB;AAJP,GAAb;AAMA,eAAMC,QAAN,CAAe,sBAAM,kBAAN,CAAf;AAd2B;AAe3B;;;;iCAEcF,U,EAAY;AAC1BG,WAAQC,GAAR,CAAY,QAAZ,EAAsBJ,UAAtB;AACA,QAAKK,QAAL,CAAc;AACbL;AADa,IAAd;;AAIA;AACA,QAAKR,uBAAL;AACA;;;oCAEiB;AAAA,OAGhBQ,UAHgB,GAIb,KAAKH,KAJQ,CAGhBG,UAHgB;AAAA,OAMhBM,MANgB,GAOb,KAAKhB,KAPQ,CAMhBgB,MANgB;;;AASjB,gBAAMJ,QAAN,CAAe,eAAQK,OAAR,CAAgB,2BAAhB,EAA6C,EAA7C,EAAiDP,UAAjD,CAAf,EAA6EQ,IAA7E,CAAkF,UAASC,QAAT,EAAmB;AACpG,iBAAOC,IAAP,CAAY,CAAC;AACZC,cAAS,MADG;AAEZC,WAAM;AAFM,KAAD,CAAZ;AAIAC,aAASC,IAAT,GAAgB,kCAAkCR,OAAOS,UAAzC,GAAsD,SAAtD,GAAkET,OAAOU,OAAzE,GAAmF,mBAAnF,GAAyGP,SAASQ,UAAlH,GAA+H,SAA/I;AAEA,IAPD,EAOGC,KAPH,CAOS,UAASC,GAAT,EAAc;AACtB,iBAAOT,IAAP,CAAY,CAAC;AACZC,cAASQ,IAAIR,OADD;AAEZC,WAAM;AAFM,KAAD,CAAZ;AAIA,IAZD;;AAcA;AACA;;;6BAEU;AACVQ,UAAOC,OAAP,CAAeC,IAAf;AACA;;;4CAEyB;AACzB,QAAKjB,QAAL,CAAc;AACbJ,uBAAmB,CAAC,KAAKJ,KAAL,CAAWI;AADlB,IAAd;AAGA;;;sCAEmB;;AAEnB,OAAIsB,QAAQ,IAAZ;AAFmB,OAIlBjB,MAJkB,GAKf,KAAKhB,KALU,CAIlBgB,MAJkB;;AAMnB,OAAIR,gBAAgB,EAApB;AACA,OAAIC,eAAe,EAAnB;;AAEA,gBAAMG,QAAN,CAAe,eAAQK,OAAR,CAAgB,yBAAhB,EAA2C;AACzDQ,gBAAYT,OAAOS,UADsC;AAEzDS,gBAAYlB,OAAOU,OAFsC;AAGzDS,iBAAa;AAH4C,IAA3C,CAAf,EAIIjB,IAJJ,CAIS,UAASC,QAAT,EAAmB;;AAE3BX,kBAAc4B,aAAd,GAA8B,SAA9B;AACA5B,kBAAc6B,UAAd,GAA2BrB,OAAOU,OAAlC;;AAEAjB,iBAAa6B,gBAAb,GAAgCnB,SAASoB,QAAT,CAAkBD,gBAAlD;AACA7B,iBAAa+B,YAAb,GAA4BrB,SAASoB,QAAT,CAAkBE,eAA9C;AACAjC,kBAAckC,YAAd,GAA6BvB,SAASoB,QAAT,CAAkBI,cAA/C;AACAnC,kBAAcoC,eAAd,GAAgCzB,SAASoB,QAAT,CAAkBM,aAAlD;AACA;AACArC,kBAAcsC,YAAd,GAA6B,OAA7B;AACAtC,kBAAcgC,YAAd,GAA6BrB,SAASoB,QAAT,CAAkBE,eAA/C;;AAEAhC,iBAAasC,kBAAb,GAAkC5B,SAAS6B,cAAT,CAAwBC,GAAxB,CAA4B,UAASC,IAAT,EAAeC,KAAf,EAAsB;AACnFD,UAAKE,KAAL,GAAaF,KAAKG,EAAlB;AACAH,UAAKI,KAAL,GAAaJ,KAAKK,eAAlB;AACA,YAAOL,IAAP;AACA,KAJiC,CAAlC;AAKAzC,iBAAa+C,WAAb,GAA2BrC,SAASsC,OAAT,CAAiBR,GAAjB,CAAqB,UAASC,IAAT,EAAeC,KAAf,EAAsB;AACrED,UAAKE,KAAL,GAAaF,KAAKG,EAAlB;AACAH,UAAKI,KAAL,GAAaJ,KAAKQ,OAAlB;AACA,YAAOR,IAAP;AACA,KAJ0B,CAA3B;AAKAzC,iBAAakD,WAAb,GAA2BxC,SAASyC,OAAT,CAAiBX,GAAjB,CAAqB,UAASC,IAAT,EAAeC,KAAf,EAAsB;AACrED,UAAKE,KAAL,GAAaF,KAAKG,EAAlB;AACAH,UAAKI,KAAL,GAAaJ,KAAKQ,OAAlB;AACA,YAAOR,IAAP;AACA,KAJ0B,CAA3B;;AAMAzC,iBAAaoD,SAAb,GAAyB1C,SAASoB,QAAT,CAAkBuB,KAA3C;AACArD,iBAAasD,YAAb,GAA4B5C,SAASoB,QAAT,CAAkBwB,YAA9C;AACAtD,iBAAa+B,YAAb,GAA4BrB,SAASoB,QAAT,CAAkBE,eAA9C;AACAhC,iBAAauD,aAAb,GAA6B7C,SAASoB,QAAT,CAAkByB,aAA/C;AACAvD,iBAAa0B,WAAb,GAA2BhB,SAASoB,QAAT,CAAkB0B,WAA7C;AACAxD,iBAAayD,mBAAb,GAAmC/C,SAAS+C,mBAAT,IAAgC,CAAnE;;AAEAjC,UAAMlB,QAAN,CAAe;AACdP,iCADc;AAEdC;AAFc,KAAf;AAKA,IA7CD,EA6CGmB,KA7CH,CA6CS,UAASC,GAAT,EAAc;AACtB,iBAAOT,IAAP,CAAY,CAAC;AACZC,cAAS,YADG;AAEZC,WAAM;AAFM,KAAD,CAAZ;AAIA,IAlDD;AAmDA;;;2BAGQ;AAAA,gBAKJ,KAAKf,KALD;AAAA,OAGPC,aAHO,UAGPA,aAHO;AAAA,OAIPC,YAJO,UAIPA,YAJO;;;AAOR,UAEC;AAAA;AAAA;AACE,iDAAO,OAAM,qEAAb,GADF;AAEC,uDAAa,UAAU,CAAC,MAAD,EAAQ,MAAR,EAAe,SAAf,CAAvB,GAFD;AAGA;AAAA;AAAA,OAAS,OAAM,gCAAf,EAAuB,aAAY,EAAnC;AACE,8DAAe,UAAU,KAAKL,cAA9B,EAA8C,eAAeI,aAA7D,EAA4E,UAAU,KAAKH,QAA3F,EAAqG,cAAcI,YAAnH;AADF,KAHA;AAOA;AAAA;AAAA;AACC,aAAM,0BADP;AAEC,aAAO,IAFR;AAGC,6BAAuB,IAHxB;AAIC,8BAAwB,IAJzB;AAKC,YAAM,KAAKF,KAAL,CAAWI,iBALlB,EAKqC,SAAS,KAAKT,uBALnD;AAMG,kEAAmB,QAAQ,KAAKK,KAAL,CAAWG,UAAtC,EAAkD,UAAU,KAAKJ,eAAjE,EAAkF,UAAU,KAAKJ,uBAAjG,EAA0H,cAAcO,YAAxI;AANH;AAPA,IAFD;AAmBA;;;;;;kBA1JmBV,U;;;;;;;;+BAAAA,U","file":"index.js","sourceRoot":"/Users/tmac_zc/Code/kr-admin","sourcesContent":["import React, {\n\tComponent,\n\tPropTypes\n} from 'react';\nimport {\n\treduxForm,\n\tsubmitForm,\n\tchange,\n\treset\n} from 'redux-form';\nimport {\n\tActions,\n\tStore\n} from 'kr/Redux';\nimport http from 'kr/Redux/Utils/fetch';\n\nimport {\n\tDialog,\n\tSection,\n\tGrid,\n\tNotify,\n\tBreadCrumbs,\n\tTitle,\n} from 'kr-ui';\n\nimport NewCreateForm from './NewCreateForm';\nimport ConfirmFormDetail from './ConfirmFormDetail';\nimport './index.less';\n\nexport default class JoinCreate extends Component {\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.openConfirmCreateDialog = this.openConfirmCreateDialog.bind(this);\n\t\tthis.onCreateSubmit = this.onCreateSubmit.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\t\tthis.onConfrimSubmit = this.onConfrimSubmit.bind(this);\n\n\t\tthis.state = {\n\t\t\tinitialValues: {},\n\t\t\toptionValues: {},\n\t\t\tformValues: {},\n\t\t\topenConfirmCreate: false\n\t\t}\n\t\tStore.dispatch(reset('reduceCreateForm'));\n\t}\n\n\tonCreateSubmit(formValues) {\n\t\tconsole.log(\"-00000\", formValues);\n\t\tthis.setState({\n\t\t\tformValues\n\t\t});\n\n\t\t// this.onConfrimSubmit();\n\t\tthis.openConfirmCreateDialog();\n\t}\n\n\tonConfrimSubmit() {\n\n\t\tlet {\n\t\t\tformValues\n\t\t} = this.state;\n\t\tlet {\n\t\t\tparams\n\t\t} = this.props;\n\n\t\tStore.dispatch(Actions.callAPI('addOrEditContinueContract', {}, formValues)).then(function(response) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '创建成功',\n\t\t\t\ttype: 'success',\n\t\t\t}]);\n\t\t\tlocation.href = \"./#/operation/customerManage/\" + params.customerId + \"/order/\" + params.orderId + \"/agreement/renew/\" + response.contractId + \"/detail\";\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: err.message,\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\n\t\t//this.openConfirmCreateDialog();\n\t}\n\n\tonCancel() {\n\t\twindow.history.back();\n\t}\n\n\topenConfirmCreateDialog() {\n\t\tthis.setState({\n\t\t\topenConfirmCreate: !this.state.openConfirmCreate\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\n\t\tvar _this = this;\n\t\tconst {\n\t\t\tparams\n\t\t} = this.props;\n\t\tlet initialValues = {};\n\t\tlet optionValues = {};\n\n\t\tStore.dispatch(Actions.callAPI('fina-contract-intention', {\n\t\t\tcustomerId: params.customerId,\n\t\t\tmainBillId: params.orderId,\n\t\t\tcommunityId: 1\n\t\t})).then(function(response) {\n\n\t\t\tinitialValues.contractstate = 'UNSTART';\n\t\t\tinitialValues.mainbillid = params.orderId;\n\n\t\t\toptionValues.communityAddress = response.customer.communityAddress;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\tinitialValues.leaseContact = response.customer.customerMember;\n\t\t\tinitialValues.leaseContacttel = response.customer.customerPhone;\n\t\t\t//合同类别，枚举类型（1:意向书,2:入住协议,3:增租协议,4.续租协议,5:减租协议,6退租协议）\n\t\t\tinitialValues.contracttype = 'RENEW';\n\t\t\tinitialValues.leaseAddress = response.customer.customerAddress;\n\n\t\t\toptionValues.fnaCorporationList = response.fnaCorporation.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.corporationName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.paymentList = response.payment.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\toptionValues.payTypeList = response.payType.map(function(item, index) {\n\t\t\t\titem.value = item.id;\n\t\t\t\titem.label = item.dicName;\n\t\t\t\treturn item;\n\t\t\t});\n\n\t\t\toptionValues.floorList = response.customer.floor;\n\t\t\toptionValues.customerName = response.customer.customerName;\n\t\t\toptionValues.leaseAddress = response.customer.customerAddress;\n\t\t\toptionValues.communityName = response.customer.communityName;\n\t\t\toptionValues.communityId = response.customer.communityid;\n\t\t\toptionValues.mainbillCommunityId = response.mainbillCommunityId || 1;\n\n\t\t\t_this.setState({\n\t\t\t\tinitialValues,\n\t\t\t\toptionValues\n\t\t\t});\n\n\t\t}).catch(function(err) {\n\t\t\tNotify.show([{\n\t\t\t\tmessage: '后台出错请联系管理员',\n\t\t\t\ttype: 'danger',\n\t\t\t}]);\n\t\t});\n\t}\n\n\n\trender() {\n\n\t\tlet {\n\t\t\tinitialValues,\n\t\t\toptionValues\n\t\t} = this.state;\n\n\t\treturn (\n\n\t\t\t<div>\n\t\t\t\t\t<Title value=\"创建续租协议书_财务管理\"/>\n\t\t \t<BreadCrumbs children={['系统运营','客户管理','创建续租协议书']}/>\n\t\t\t<Section title=\"续租协议书\" description=\"\">\n\t\t\t\t\t<NewCreateForm onSubmit={this.onCreateSubmit} initialValues={initialValues} onCancel={this.onCancel} optionValues={optionValues}/>\n\t\t\t</Section>\n\n\t\t\t<Dialog\n\t\t\t\ttitle=\"确定新建\"\n\t\t\t\tmodal={true}\n\t\t\t\tautoScrollBodyContent={true}\n\t\t\t\tautoDetectWindowHeight={true}\n\t\t\t\topen={this.state.openConfirmCreate} onClose={this.openConfirmCreateDialog}>\n\t\t\t\t\t\t<ConfirmFormDetail detail={this.state.formValues} onSubmit={this.onConfrimSubmit} onCancel={this.openConfirmCreateDialog} optionValues={optionValues}/>\n\t\t\t  </Dialog>\n\t\t</div>\n\t\t);\n\t}\n}\n"]}