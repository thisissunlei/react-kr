{"version":3,"sources":["src/Redux/Modules/Navs/actions.js"],"names":["navActive","setUserNavs","setCurrentNav","Types","menuCode","dispatch","getState","console","log","state","permissionNavs","navs","items","forEach","item","index","active","hasOwnProperty","Object","prototype","toString","call","menuItems","length","child","key","children","i","type","SET_USER_NAVS","response","navcodes","codeKeys","keys","indexOf","push","itemPermissionKeys","childNavs","childrenNavs","setNavsCurrentRoute","currentRoute","SET_NAVS_CURRENT_ROUTER","router","setRouterParent","parentRouter","SET_NAVS_CURRENT_PARENT_ROUTER","setRouterChild","childRouter","SET_NAVS_CURRENT_CHILD_ROUTER","setNavsCurrentItems","fatherRouter","SET_NAVS_CURRENT_ITEMS","setNavsActivity","SET_NAVS_ACTIVITY","split","shift","substring","substr"],"mappings":"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","file":"actions.js","sourceRoot":"/Users/liuyihao/Code/kr-admin","sourcesContent":["import fetch from 'node-fetch';\nimport * as Types from './types';\n\n\n\nexport function navActive(menuCode){\n\treturn function(dispatch,getState){\n\t\tconsole.log(\"11111\");\n\t\tvar state = getState();\n\t\tvar permissionNavs = state.navs.items;\n\n\tpermissionNavs.forEach(function(item,index){\n\t\t\titem.active = false;\n\t\t\tif(item.hasOwnProperty('menuItems') && Object.prototype.toString.call(item.menuItems) === '[object Array]'  && item.menuItems.length){\n\t\t\t\t\titem.menuItems.forEach(function(child,key){\n\t\t\t\t\t\tif(child.hasOwnProperty('menuItems') && Object.prototype.toString.call(child.menuItems) === '[object Array]'  && child.menuItems.length){\n\t\t\t\t\t\t   child.menuItems.forEach(function(children,i){\n\t\t\t\t\t\t\t\tchildren.active = false;\n\t\t\t\t\t\t\t\tif(children.menuCode == menuCode){\n\t\t\t\t\t\t\t\t\tchildren.active = true;\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tchildren.active = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tdispatch({\n\t\t\ttype:Types.SET_USER_NAVS,\n\t\t\tresponse:permissionNavs\n\t\t});\n}\n}\n\n//当前用户有哪些导航权限\n\nexport function setUserNavs(navcodes){\n\treturn function(dispatch,getState){\n\t\tvar state = getState();\n\t\tvar items = state.navs.items;\n\t\tvar codeKeys = Object.keys(navcodes);\n\t\tvar permissionNavs = [];\n\n\n\t\titems.forEach(function(item,index){\n\t\t\tif(item.hasOwnProperty('menuCode') && codeKeys.indexOf(item.menuCode) !==-1 ){\n\t\t\t\tpermissionNavs.push(item);\n\t\t\t}\n\t\t});\n\n\t\tpermissionNavs.forEach(function(item,index){\n\t\t\tvar itemPermissionKeys = navcodes[item.menuCode];\n\t\t\tvar childNavs = [];\n\n\t\t\tif(item.hasOwnProperty('menuItems') && item.menuItems.length){\n\t\t\t\titem.menuItems.forEach(function(child,key){\n\t\t\t\t\tif(child.hasOwnProperty('menuCode') && itemPermissionKeys.indexOf(child.menuCode) !== -1){\n\n\t\t\t\t\t\tif(child.hasOwnProperty('menuItems') && child.menuItems.length){\n\t\t\t\t\t\t\tvar childrenNavs = [];\n\t\t\t\t\t\t\tchild.menuItems.forEach(function(children,i){\n\t\t\t\t\t\t\t\tif(children.hasOwnProperty('menuCode') && itemPermissionKeys.indexOf(children.menuCode) !== -1){\n\t\t\t\t\t\t\t\t\tchildrenNavs.push(children);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tchild.menuItems = childrenNavs;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tchildNavs.push(child);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\titem.menuItems = childNavs;\n\t\t\t}\n\t\t});\n\n\n\t\tdispatch({\n\t\t\ttype:Types.SET_USER_NAVS,\n\t\t\tresponse:permissionNavs\n\t\t});\n\t}\n}\n\nfunction setNavsCurrentRoute(currentRoute){\n\n\treturn {\n\t\ttype:Types.SET_NAVS_CURRENT_ROUTER,\n\t\trouter:currentRoute\n\t}\n\n}\n\nfunction setRouterParent(parentRouter){\n\treturn {\n\t\ttype:Types.SET_NAVS_CURRENT_PARENT_ROUTER,\n\t\trouter:parentRouter\n\t}\n}\n\n\n\n\nfunction setRouterChild(childRouter){\n\treturn {\n\t\ttype:Types.SET_NAVS_CURRENT_CHILD_ROUTER,\n\t\trouter:childRouter\n\t}\n}\n\nfunction setNavsCurrentItems(fatherRouter){\n\treturn {\n\t\ttype:Types.SET_NAVS_CURRENT_ITEMS,\n\t\trouter:fatherRouter\n\t}\n}\n\nfunction setNavsActivity(fatherRouter,childRouter){\n\treturn {\n\t\ttype:Types.SET_NAVS_ACTIVITY,\n\t\trouter:fatherRouter,\n\t\tchildRouter:childRouter\n\t}\n\n}\n\nexport function setCurrentNav(router){\n\n\trouter = router.split('?').shift();\n\tlet fatherRouter = router.substring(2).split('/').shift();\n\tlet childRouter = router.substring(2).split('/')[1];\n\n\t// if(typeof childRouter !== 'undefined' && childRouter.indexOf('?') !==-1){\n\t// \tchildRouter = childRouter.split('?').shift();\n\t// }\n\n\treturn function(dispatch){\n\n\t\t\tdispatch(setRouterParent(fatherRouter));\n\t\t\tdispatch(setRouterChild(childRouter));\n\n\t\t\tdispatch(setNavsCurrentRoute(router.substr(1)));\n\t\t\tdispatch(setNavsCurrentItems(fatherRouter));\n\t\t\tdispatch(setNavsActivity(fatherRouter,router.substr(1)));\n\t}\n\n}\n"]}